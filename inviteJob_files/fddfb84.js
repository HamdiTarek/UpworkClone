"use strict";angular.module("mgcrea.bootstrap.affix",["mgcrea.jquery"]).directive("bsAffix",function($window,dimensions){var checkPosition=function(instance,el,options){var scrollTop=window.pageYOffset;var scrollHeight=document.body.scrollHeight;var position=dimensions.offset.call(el[0]);var height=dimensions.height.call(el[0]);var offsetTop=options.offsetTop*1;var offsetBottom=options.offsetBottom*1;var reset="affix affix-top affix-bottom";var affix;if(instance.unpin!==null&&scrollTop+instance.unpin<=position.top){affix=false}else if(offsetBottom&&position.top+height>=scrollHeight-offsetBottom){affix="bottom"}else if(offsetTop&&scrollTop<=offsetTop){affix="top"}else{affix=false}if(instance.affixed===affix)return;instance.affixed=affix;instance.unpin=affix==="bottom"?position.top-scrollTop:null;el.removeClass(reset).addClass("affix"+(affix?"-"+affix:""))};var checkCallbacks=function(scope,instance,iElement,iAttrs){if(instance.affixed){if(iAttrs.onUnaffix)eval("scope."+iAttrs.onUnaffix)}else{if(iAttrs.onAffix)eval("scope."+iAttrs.onAffix)}};return{restrict:"EAC",link:function postLink(scope,iElement,iAttrs){var instance={unpin:null};angular.element($window).bind("scroll",function(){checkPosition(instance,iElement,iAttrs);checkCallbacks(scope,instance,iElement,iAttrs)});angular.element($window).bind("click",function(){setTimeout(function(){checkPosition(instance,iElement,iAttrs);checkCallbacks(scope,instance,iElement,iAttrs)},1)})}}});
"use strict";angular.module("mgcrea.jquery",[]).provider("dimensions",function(){this.$get=function(){return this};this.offset=function(){if(!this)return;var box=this.getBoundingClientRect();var docElem=this.ownerDocument.documentElement;return{top:box.top+window.pageYOffset-docElem.clientTop,left:box.left+window.pageXOffset-docElem.clientLeft}};this.height=function(outer){var computedStyle=window.getComputedStyle(this);var value=this.offsetHeight;if(outer){value+=parseFloat(computedStyle.marginTop)+parseFloat(computedStyle.marginBottom)}else{value-=parseFloat(computedStyle.paddingTop)+parseFloat(computedStyle.paddingBottom)+parseFloat(computedStyle.borderTopWidth)+parseFloat(computedStyle.borderBottomWidth)}return value};this.width=function(outer){var computedStyle=window.getComputedStyle(this);var value=this.offsetWidth;if(outer){value+=parseFloat(computedStyle.marginLeft)+parseFloat(computedStyle.marginRight)}else{value-=parseFloat(computedStyle.paddingLeft)+parseFloat(computedStyle.paddingRight)+parseFloat(computedStyle.borderLeftWidth)+parseFloat(computedStyle.borderRightWidth)}return value}}).constant("debounce",function(fn,wait){var timeout,result;return function(){var context=this,args=arguments;var later=function(){timeout=null;result=fn.apply(context,args)};clearTimeout(timeout);timeout=setTimeout(later,wait);return result}}).provider("jQuery",function(dimensionsProvider){var self=this;var jQLite=angular.element;this.fn=angular.extend({},dimensionsProvider);this.$get=function(){delete self.fn.$get;return function jQuery(query){var el=query instanceof HTMLElement?query:document.querySelectorAll(query);el=jQLite(el);angular.forEach(self.fn,function(fn,key){el[key]=fn.bind(el[0])});return el}}});
angular.module("truncate",[]).filter("characters",function(){return function(input,chars,breakOnWord){if(isNaN(chars))return input;if(chars<=0)return"";if(input&&input.length>chars){input=input.substring(0,chars);if(!breakOnWord){var lastspace=input.lastIndexOf(" ");if(lastspace!==-1){input=input.substr(0,lastspace)}}else{while(input.charAt(input.length-1)===" "){input=input.substr(0,input.length-1)}}return input+"…"}return input}}).filter("splitcharacters",function(){return function(input,chars){if(isNaN(chars))return input;if(chars<=0)return"";if(input&&input.length>chars){var prefix=input.substring(0,chars/2);var postfix=input.substring(input.length-chars/2,input.length);return prefix+"..."+postfix}return input}}).filter("words",function(){return function(input,words){if(isNaN(words))return input;if(words<=0)return"";if(input){var inputWords=input.split(/\s+/);if(inputWords.length>words){input=inputWords.slice(0,words).join(" ")+"…"}}return input}});
if(typeof module!=="undefined"&&typeof exports!=="undefined"&&module.exports===exports){module.exports="ui.router"}(function(window,angular,undefined){"use strict";var isDefined=angular.isDefined,isFunction=angular.isFunction,isString=angular.isString,isObject=angular.isObject,isArray=angular.isArray,forEach=angular.forEach,extend=angular.extend,copy=angular.copy;function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function merge(dst){forEach(arguments,function(obj){if(obj!==dst){forEach(obj,function(value,key){if(!dst.hasOwnProperty(key))dst[key]=value})}});return dst}function ancestors(first,second){var path=[];for(var n in first.path){if(first.path[n]!==second.path[n])break;path.push(first.path[n])}return path}function objectKeys(object){if(Object.keys){return Object.keys(object)}var result=[];angular.forEach(object,function(val,key){result.push(key)});return result}function indexOf(array,value){if(Array.prototype.indexOf){return array.indexOf(value,Number(arguments[2])||0)}var len=array.length>>>0,from=Number(arguments[2])||0;from=from<0?Math.ceil(from):Math.floor(from);if(from<0)from+=len;for(;from<len;from++){if(from in array&&array[from]===value)return from}return-1}function inheritParams(currentParams,newParams,$current,$to){var parents=ancestors($current,$to),parentParams,inherited={},inheritList=[];for(var i in parents){if(!parents[i].params)continue;parentParams=objectKeys(parents[i].params);if(!parentParams.length)continue;for(var j in parentParams){if(indexOf(inheritList,parentParams[j])>=0)continue;inheritList.push(parentParams[j]);inherited[parentParams[j]]=currentParams[parentParams[j]]}}return extend({},inherited,newParams)}function equalForKeys(a,b,keys){if(!keys){keys=[];for(var n in a)keys.push(n)}for(var i=0;i<keys.length;i++){var k=keys[i];if(a[k]!=b[k])return false}return true}function filterByKeys(keys,values){var filtered={};forEach(keys,function(name){filtered[name]=values[name]});return filtered}function indexBy(array,propName){var result={};forEach(array,function(item){result[item[propName]]=item});return result}function pick(obj){var copy={};var keys=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));forEach(keys,function(key){if(key in obj)copy[key]=obj[key]});return copy}function omit(obj){var copy={};var keys=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));for(var key in obj){if(indexOf(keys,key)==-1)copy[key]=obj[key]}return copy}function pluck(collection,key){var result=isArray(collection)?[]:{};forEach(collection,function(val,i){result[i]=isFunction(key)?key(val):val[key]});return result}function filter(collection,callback){var array=isArray(collection);var result=array?[]:{};forEach(collection,function(val,i){if(callback(val,i)){result[array?result.length:i]=val}});return result}function map(collection,callback){var result=isArray(collection)?[]:{};forEach(collection,function(val,i){result[i]=callback(val,i)});return result}angular.module("ui.router.util",["ng"]);angular.module("ui.router.router",["ui.router.util"]);angular.module("ui.router.state",["ui.router.router","ui.router.util"]);angular.module("ui.router",["ui.router.state"]);angular.module("ui.router.compat",["ui.router"]);$Resolve.$inject=["$q","$injector"];function $Resolve($q,$injector){var VISIT_IN_PROGRESS=1,VISIT_DONE=2,NOTHING={},NO_DEPENDENCIES=[],NO_LOCALS=NOTHING,NO_PARENT=extend($q.when(NOTHING),{$$promises:NOTHING,$$values:NOTHING});this.study=function(invocables){if(!isObject(invocables))throw new Error("'invocables' must be an object");var invocableKeys=objectKeys(invocables||{});var plan=[],cycle=[],visited={};function visit(value,key){if(visited[key]===VISIT_DONE)return;cycle.push(key);if(visited[key]===VISIT_IN_PROGRESS){cycle.splice(0,indexOf(cycle,key));throw new Error("Cyclic dependency: "+cycle.join(" -> "))}visited[key]=VISIT_IN_PROGRESS;if(isString(value)){plan.push(key,[function(){return $injector.get(value)}],NO_DEPENDENCIES)}else{var params=$injector.annotate(value);forEach(params,function(param){if(param!==key&&invocables.hasOwnProperty(param))visit(invocables[param],param)});plan.push(key,value,params)}cycle.pop();visited[key]=VISIT_DONE}forEach(invocables,visit);invocables=cycle=visited=null;function isResolve(value){return isObject(value)&&value.then&&value.$$promises}return function(locals,parent,self){if(isResolve(locals)&&self===undefined){self=parent;parent=locals;locals=null}if(!locals)locals=NO_LOCALS;else if(!isObject(locals)){throw new Error("'locals' must be an object")}if(!parent)parent=NO_PARENT;else if(!isResolve(parent)){throw new Error("'parent' must be a promise returned by $resolve.resolve()")}var resolution=$q.defer(),result=resolution.promise,promises=result.$$promises={},values=extend({},locals),wait=1+plan.length/3,merged=false;function done(){if(!--wait){if(!merged)merge(values,parent.$$values);result.$$values=values;result.$$promises=result.$$promises||true;delete result.$$inheritedValues;resolution.resolve(values)}}function fail(reason){result.$$failure=reason;resolution.reject(reason)}if(isDefined(parent.$$failure)){fail(parent.$$failure);return result}if(parent.$$inheritedValues){merge(values,omit(parent.$$inheritedValues,invocableKeys))}extend(promises,parent.$$promises);if(parent.$$values){merged=merge(values,omit(parent.$$values,invocableKeys));result.$$inheritedValues=omit(parent.$$values,invocableKeys);done()}else{if(parent.$$inheritedValues){result.$$inheritedValues=omit(parent.$$inheritedValues,invocableKeys)}parent.then(done,fail)}for(var i=0,ii=plan.length;i<ii;i+=3){if(locals.hasOwnProperty(plan[i]))done();else invoke(plan[i],plan[i+1],plan[i+2])}function invoke(key,invocable,params){var invocation=$q.defer(),waitParams=0;function onfailure(reason){invocation.reject(reason);fail(reason)}forEach(params,function(dep){if(promises.hasOwnProperty(dep)&&!locals.hasOwnProperty(dep)){waitParams++;promises[dep].then(function(result){values[dep]=result;if(!--waitParams)proceed()},onfailure)}});if(!waitParams)proceed();function proceed(){if(isDefined(result.$$failure))return;try{invocation.resolve($injector.invoke(invocable,self,values));invocation.promise.then(function(result){values[key]=result;done()},onfailure)}catch(e){onfailure(e)}}promises[key]=invocation.promise}return result}};this.resolve=function(invocables,locals,parent,self){return this.study(invocables)(locals,parent,self)}}angular.module("ui.router.util").service("$resolve",$Resolve);$TemplateFactory.$inject=["$http","$templateCache","$injector"];function $TemplateFactory($http,$templateCache,$injector){this.fromConfig=function(config,params,locals){return isDefined(config.template)?this.fromString(config.template,params):isDefined(config.templateUrl)?this.fromUrl(config.templateUrl,params):isDefined(config.templateProvider)?this.fromProvider(config.templateProvider,params,locals):null};this.fromString=function(template,params){return isFunction(template)?template(params):template};this.fromUrl=function(url,params){if(isFunction(url))url=url(params);if(url==null)return null;else return $http.get(url,{cache:$templateCache,headers:{Accept:"text/html"}}).then(function(response){return response.data})};this.fromProvider=function(provider,params,locals){return $injector.invoke(provider,null,locals||{params:params})}}angular.module("ui.router.util").service("$templateFactory",$TemplateFactory);var $$UMFP;function UrlMatcher(pattern,config,parentMatcher){config=extend({params:{}},isObject(config)?config:{});var placeholder=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,searchPlaceholder=/([:]?)([\w\[\]-]+)|\{([\w\[\]-]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,compiled="^",last=0,m,segments=this.segments=[],parentParams=parentMatcher?parentMatcher.params:{},params=this.params=parentMatcher?parentMatcher.params.$$new():new $$UMFP.ParamSet,paramNames=[];function addParameter(id,type,config,location){paramNames.push(id);if(parentParams[id])return parentParams[id];if(!/^\w+(-+\w+)*(?:\[\])?$/.test(id))throw new Error("Invalid parameter name '"+id+"' in pattern '"+pattern+"'");if(params[id])throw new Error("Duplicate parameter name '"+id+"' in pattern '"+pattern+"'");params[id]=new $$UMFP.Param(id,type,config,location);return params[id]}function quoteRegExp(string,pattern,squash){var surroundPattern=["",""],result=string.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!pattern)return result;switch(squash){case false:surroundPattern=["(",")"];break;case true:surroundPattern=["?(",")?"];break;default:surroundPattern=["("+squash+"|",")?"];break}return result+surroundPattern[0]+pattern+surroundPattern[1]}this.source=pattern;function matchDetails(m,isSearch){var id,regexp,segment,type,cfg,arrayMode;id=m[2]||m[3];cfg=config.params[id];segment=pattern.substring(last,m.index);regexp=isSearch?m[4]:m[4]||(m[1]=="*"?".*":null);type=$$UMFP.type(regexp||"string")||inherit($$UMFP.type("string"),{pattern:new RegExp(regexp)});return{id:id,regexp:regexp,segment:segment,type:type,cfg:cfg}}var p,param,segment;while(m=placeholder.exec(pattern)){p=matchDetails(m,false);if(p.segment.indexOf("?")>=0)break;param=addParameter(p.id,p.type,p.cfg,"path");compiled+=quoteRegExp(p.segment,param.type.pattern.source,param.squash);segments.push(p.segment);last=placeholder.lastIndex}segment=pattern.substring(last);var i=segment.indexOf("?");if(i>=0){var search=this.sourceSearch=segment.substring(i);segment=segment.substring(0,i);this.sourcePath=pattern.substring(0,last+i);if(search.length>0){last=0;while(m=searchPlaceholder.exec(search)){p=matchDetails(m,true);param=addParameter(p.id,p.type,p.cfg,"search");last=placeholder.lastIndex}}}else{this.sourcePath=pattern;this.sourceSearch=""}compiled+=quoteRegExp(segment)+(config.strict===false?"/?":"")+"$";segments.push(segment);this.regexp=new RegExp(compiled,config.caseInsensitive?"i":undefined);this.prefix=segments[0];this.$$paramNames=paramNames}UrlMatcher.prototype.concat=function(pattern,config){var defaultConfig={caseInsensitive:$$UMFP.caseInsensitive(),strict:$$UMFP.strictMode(),squash:$$UMFP.defaultSquashPolicy()};return new UrlMatcher(this.sourcePath+pattern+this.sourceSearch,extend(defaultConfig,config),this)};UrlMatcher.prototype.toString=function(){return this.source};UrlMatcher.prototype.exec=function(path,searchParams){var m=this.regexp.exec(path);if(!m)return null;searchParams=searchParams||{};var paramNames=this.parameters(),nTotal=paramNames.length,nPath=this.segments.length-1,values={},i,j,cfg,paramName;if(nPath!==m.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");function decodePathArray(string){function reverseString(str){return str.split("").reverse().join("")}function unquoteDashes(str){return str.replace(/\\-/,"-")}var split=reverseString(string).split(/-(?!\\)/);var allReversed=map(split,reverseString);return map(allReversed,unquoteDashes).reverse()}for(i=0;i<nPath;i++){paramName=paramNames[i];var param=this.params[paramName];var paramVal=m[i+1];for(j=0;j<param.replace;j++){if(param.replace[j].from===paramVal)paramVal=param.replace[j].to}if(paramVal&&param.array===true)paramVal=decodePathArray(paramVal);values[paramName]=param.value(paramVal)}for(;i<nTotal;i++){paramName=paramNames[i];values[paramName]=this.params[paramName].value(searchParams[paramName])}return values};UrlMatcher.prototype.parameters=function(param){if(!isDefined(param))return this.$$paramNames;return this.params[param]||null};UrlMatcher.prototype.validates=function(params){return this.params.$$validates(params)};UrlMatcher.prototype.format=function(values){values=values||{};var segments=this.segments,params=this.parameters(),paramset=this.params;if(!this.validates(values))return null;var i,search=false,nPath=segments.length-1,nTotal=params.length,result=segments[0];function encodeDashes(str){return encodeURIComponent(str).replace(/-/g,function(c){return"%5C%"+c.charCodeAt(0).toString(16).toUpperCase()})}for(i=0;i<nTotal;i++){var isPathParam=i<nPath;var name=params[i],param=paramset[name],value=param.value(values[name]);var isDefaultValue=param.isOptional&&param.type.equals(param.value(),value);var squash=isDefaultValue?param.squash:false;var encoded=param.type.encode(value);if(isPathParam){var nextSegment=segments[i+1];if(squash===false){if(encoded!=null){if(isArray(encoded)){result+=map(encoded,encodeDashes).join("-")}else{result+=encodeURIComponent(encoded)}}result+=nextSegment}else if(squash===true){var capture=result.match(/\/$/)?/\/?(.*)/:/(.*)/;result+=nextSegment.match(capture)[1]}else if(isString(squash)){result+=squash+nextSegment}}else{if(encoded==null||isDefaultValue&&squash!==false)continue;if(!isArray(encoded))encoded=[encoded];encoded=map(encoded,encodeURIComponent).join("&"+name+"=");result+=(search?"&":"?")+(name+"="+encoded);search=true}}return result};function Type(config){extend(this,config)}Type.prototype.is=function(val,key){return true};Type.prototype.encode=function(val,key){return val};Type.prototype.decode=function(val,key){return val};Type.prototype.equals=function(a,b){return a==b};Type.prototype.$subPattern=function(){var sub=this.pattern.toString();return sub.substr(1,sub.length-2)};Type.prototype.pattern=/.*/;Type.prototype.toString=function(){return"{Type:"+this.name+"}"};Type.prototype.$asArray=function(mode,isSearch){if(!mode)return this;if(mode==="auto"&&!isSearch)throw new Error("'auto' array mode is for query parameters only");return new ArrayType(this,mode);function ArrayType(type,mode){function bindTo(type,callbackName){return function(){return type[callbackName].apply(type,arguments)}}function arrayWrap(val){return isArray(val)?val:isDefined(val)?[val]:[]}function arrayUnwrap(val){switch(val.length){case 0:return undefined;case 1:return mode==="auto"?val[0]:val;default:return val}}function falsey(val){return!val}function arrayHandler(callback,allTruthyMode){return function handleArray(val){val=arrayWrap(val);var result=map(val,callback);if(allTruthyMode===true)return filter(result,falsey).length===0;return arrayUnwrap(result)}}function arrayEqualsHandler(callback){return function handleArray(val1,val2){var left=arrayWrap(val1),right=arrayWrap(val2);if(left.length!==right.length)return false;for(var i=0;i<left.length;i++){if(!callback(left[i],right[i]))return false}return true}}this.encode=arrayHandler(bindTo(type,"encode"));this.decode=arrayHandler(bindTo(type,"decode"));this.is=arrayHandler(bindTo(type,"is"),true);this.equals=arrayEqualsHandler(bindTo(type,"equals"));this.pattern=type.pattern;this.$arrayMode=mode}};function $UrlMatcherFactory(){$$UMFP=this;var isCaseInsensitive=false,isStrictMode=true,defaultSquashPolicy=false;function valToString(val){return val!=null?val.toString().replace(/\//g,"%2F"):val}function valFromString(val){return val!=null?val.toString().replace(/%2F/g,"/"):val}function regexpMatches(val){return this.pattern.test(val)}var $types={},enqueue=true,typeQueue=[],injector,defaultTypes={string:{encode:valToString,decode:valFromString,is:regexpMatches,pattern:/[^/]*/},int:{encode:valToString,decode:function(val){return parseInt(val,10)},is:function(val){return isDefined(val)&&this.decode(val.toString())===val},pattern:/\d+/},bool:{encode:function(val){return val?1:0},decode:function(val){return parseInt(val,10)!==0},is:function(val){return val===true||val===false},pattern:/0|1/},date:{encode:function(val){if(!this.is(val))return undefined;return[val.getFullYear(),("0"+(val.getMonth()+1)).slice(-2),("0"+val.getDate()).slice(-2)].join("-")},decode:function(val){if(this.is(val))return val;var match=this.capture.exec(val);return match?new Date(match[1],match[2]-1,match[3]):undefined},is:function(val){return val instanceof Date&&!isNaN(val.valueOf())},equals:function(a,b){return this.is(a)&&this.is(b)&&a.toISOString()===b.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:angular.toJson,decode:angular.fromJson,is:angular.isObject,equals:angular.equals,pattern:/[^/]*/},any:{encode:angular.identity,decode:angular.identity,is:angular.identity,equals:angular.equals,pattern:/.*/}};function getDefaultConfig(){return{strict:isStrictMode,caseInsensitive:isCaseInsensitive}}function isInjectable(value){return isFunction(value)||isArray(value)&&isFunction(value[value.length-1])}$UrlMatcherFactory.$$getDefaultValue=function(config){if(!isInjectable(config.value))return config.value;if(!injector)throw new Error("Injectable functions cannot be called at configuration time");return injector.invoke(config.value)};this.caseInsensitive=function(value){if(isDefined(value))isCaseInsensitive=value;return isCaseInsensitive};this.strictMode=function(value){if(isDefined(value))isStrictMode=value;return isStrictMode};this.defaultSquashPolicy=function(value){if(!isDefined(value))return defaultSquashPolicy;if(value!==true&&value!==false&&!isString(value))throw new Error("Invalid squash policy: "+value+". Valid policies: false, true, arbitrary-string");defaultSquashPolicy=value;return value};this.compile=function(pattern,config){return new UrlMatcher(pattern,extend(getDefaultConfig(),config))};this.isMatcher=function(o){if(!isObject(o))return false;var result=true;forEach(UrlMatcher.prototype,function(val,name){if(isFunction(val)){result=result&&(isDefined(o[name])&&isFunction(o[name]))}});return result};this.type=function(name,definition,definitionFn){if(!isDefined(definition))return $types[name];if($types.hasOwnProperty(name))throw new Error("A type named '"+name+"' has already been defined.");$types[name]=new Type(extend({name:name},definition));if(definitionFn){typeQueue.push({name:name,def:definitionFn});if(!enqueue)flushTypeQueue()}return this};function flushTypeQueue(){while(typeQueue.length){var type=typeQueue.shift();if(type.pattern)throw new Error("You cannot override a type's .pattern at runtime.");angular.extend($types[type.name],injector.invoke(type.def))}}forEach(defaultTypes,function(type,name){$types[name]=new Type(extend({name:name},type))});$types=inherit($types,{});this.$get=["$injector",function($injector){injector=$injector;enqueue=false;flushTypeQueue();forEach(defaultTypes,function(type,name){if(!$types[name])$types[name]=new Type(type)});return this}];this.Param=function Param(id,type,config,location){var self=this;config=unwrapShorthand(config);type=getType(config,type,location);var arrayMode=getArrayMode();type=arrayMode?type.$asArray(arrayMode,location==="search"):type;if(type.name==="string"&&!arrayMode&&location==="path"&&config.value===undefined)config.value="";var isOptional=config.value!==undefined;var squash=getSquashPolicy(config,isOptional);var replace=getReplace(config,arrayMode,isOptional,squash);function unwrapShorthand(config){var keys=isObject(config)?objectKeys(config):[];var isShorthand=indexOf(keys,"value")===-1&&indexOf(keys,"type")===-1&&indexOf(keys,"squash")===-1&&indexOf(keys,"array")===-1;if(isShorthand)config={value:config};config.$$fn=isInjectable(config.value)?config.value:function(){return config.value};return config}function getType(config,urlType,location){if(config.type&&urlType)throw new Error("Param '"+id+"' has two type configurations.");if(urlType)return urlType;if(!config.type)return location==="config"?$types.any:$types.string;return config.type instanceof Type?config.type:new Type(config.type)}function getArrayMode(){var arrayDefaults={array:location==="search"?"auto":false};var arrayParamNomenclature=id.match(/\[\]$/)?{array:true}:{};return extend(arrayDefaults,arrayParamNomenclature,config).array}function getSquashPolicy(config,isOptional){var squash=config.squash;if(!isOptional||squash===false)return false;if(!isDefined(squash)||squash==null)return defaultSquashPolicy;if(squash===true||isString(squash))return squash;throw new Error("Invalid squash policy: '"+squash+"'. Valid policies: false, true, or arbitrary string")}function getReplace(config,arrayMode,isOptional,squash){var replace,configuredKeys,defaultPolicy=[{from:"",to:isOptional||arrayMode?undefined:""},{from:null,to:isOptional||arrayMode?undefined:""}];replace=isArray(config.replace)?config.replace:[];if(isString(squash))replace.push({from:squash,to:undefined});configuredKeys=map(replace,function(item){return item.from});return filter(defaultPolicy,function(item){return indexOf(configuredKeys,item.from)===-1}).concat(replace)}function $$getDefaultValue(){if(!injector)throw new Error("Injectable functions cannot be called at configuration time");return injector.invoke(config.$$fn)}function $value(value){function hasReplaceVal(val){return function(obj){return obj.from===val}}function $replace(value){var replacement=map(filter(self.replace,hasReplaceVal(value)),function(obj){return obj.to});return replacement.length?replacement[0]:value}value=$replace(value);return isDefined(value)?self.type.decode(value):$$getDefaultValue()}function toString(){return"{Param:"+id+" "+type+" squash: '"+squash+"' optional: "+isOptional+"}"}extend(this,{id:id,type:type,location:location,array:arrayMode,squash:squash,replace:replace,isOptional:isOptional,value:$value,dynamic:undefined,config:config,toString:toString})};function ParamSet(params){extend(this,params||{})}ParamSet.prototype={$$new:function(){return inherit(this,extend(new ParamSet,{$$parent:this}))},$$keys:function(){var keys=[],chain=[],parent=this,ignore=objectKeys(ParamSet.prototype);while(parent){chain.push(parent);parent=parent.$$parent}chain.reverse();forEach(chain,function(paramset){forEach(objectKeys(paramset),function(key){if(indexOf(keys,key)===-1&&indexOf(ignore,key)===-1)keys.push(key)})});return keys},$$values:function(paramValues){var values={},self=this;forEach(self.$$keys(),function(key){values[key]=self[key].value(paramValues&&paramValues[key])});return values},$$equals:function(paramValues1,paramValues2){var equal=true,self=this;forEach(self.$$keys(),function(key){var left=paramValues1&&paramValues1[key],right=paramValues2&&paramValues2[key];if(!self[key].type.equals(left,right))equal=false});return equal},$$validates:function $$validate(paramValues){var result=true,isOptional,val,param,self=this;forEach(this.$$keys(),function(key){param=self[key];val=paramValues[key];isOptional=!val&&param.isOptional;result=result&&(isOptional||!!param.type.is(val))});return result},$$parent:undefined};this.ParamSet=ParamSet}angular.module("ui.router.util").provider("$urlMatcherFactory",$UrlMatcherFactory);angular.module("ui.router.util").run(["$urlMatcherFactory",function($urlMatcherFactory){}]);$UrlRouterProvider.$inject=["$locationProvider","$urlMatcherFactoryProvider"];function $UrlRouterProvider($locationProvider,$urlMatcherFactory){var rules=[],otherwise=null,interceptDeferred=false,listener;function regExpPrefix(re){var prefix=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(re.source);return prefix!=null?prefix[1].replace(/\\(.)/g,"$1"):""}function interpolate(pattern,match){return pattern.replace(/\$(\$|\d{1,2})/,function(m,what){return match[what==="$"?0:Number(what)]})}this.rule=function(rule){if(!isFunction(rule))throw new Error("'rule' must be a function");rules.push(rule);return this};this.otherwise=function(rule){if(isString(rule)){var redirect=rule;rule=function(){return redirect}}else if(!isFunction(rule))throw new Error("'rule' must be a function");otherwise=rule;return this};function handleIfMatch($injector,handler,match){if(!match)return false;var result=$injector.invoke(handler,handler,{$match:match});return isDefined(result)?result:true}this.when=function(what,handler){var redirect,handlerIsString=isString(handler);if(isString(what))what=$urlMatcherFactory.compile(what);if(!handlerIsString&&!isFunction(handler)&&!isArray(handler))throw new Error("invalid 'handler' in when()");var strategies={matcher:function(what,handler){if(handlerIsString){redirect=$urlMatcherFactory.compile(handler);handler=["$match",function($match){return redirect.format($match)}]}return extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path(),$location.search()))},{prefix:isString(what.prefix)?what.prefix:""})},regex:function(what,handler){if(what.global||what.sticky)throw new Error("when() RegExp must not be global or sticky");if(handlerIsString){redirect=handler;handler=["$match",function($match){return interpolate(redirect,$match)}]}return extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path()))},{prefix:regExpPrefix(what)})}};var check={matcher:$urlMatcherFactory.isMatcher(what),regex:what instanceof RegExp};for(var n in check){if(check[n])return this.rule(strategies[n](what,handler))}throw new Error("invalid 'what' in when()")};this.deferIntercept=function(defer){if(defer===undefined)defer=true;interceptDeferred=defer};this.$get=$get;$get.$inject=["$location","$rootScope","$injector","$browser"];function $get($location,$rootScope,$injector,$browser){var baseHref=$browser.baseHref(),location=$location.url(),lastPushedUrl;function appendBasePath(url,isHtml5,absolute){if(baseHref==="/")return url;if(isHtml5)return baseHref.slice(0,-1)+url;if(absolute)return baseHref.slice(1)+url;return url}function update(evt){if(evt&&evt.defaultPrevented)return;var ignoreUpdate=lastPushedUrl&&$location.url()===lastPushedUrl;lastPushedUrl=undefined;if(ignoreUpdate)return true;function check(rule){var handled=rule($injector,$location);if(!handled)return false;if(isString(handled))$location.replace().url(handled);return true}var n=rules.length,i;for(i=0;i<n;i++){if(check(rules[i]))return}if(otherwise)check(otherwise)}function listen(){listener=listener||$rootScope.$on("$locationChangeSuccess",update);return listener}if(!interceptDeferred)listen();return{sync:function(){update()},listen:function(){return listen()},update:function(read){if(read){location=$location.url();return}if($location.url()===location)return;$location.url(location);$location.replace()},push:function(urlMatcher,params,options){$location.url(urlMatcher.format(params||{}));lastPushedUrl=options&&options.$$avoidResync?$location.url():undefined;if(options&&options.replace)$location.replace()},href:function(urlMatcher,params,options){if(!urlMatcher.validates(params))return null;var isHtml5=$locationProvider.html5Mode();if(angular.isObject(isHtml5)){isHtml5=isHtml5.enabled}var url=urlMatcher.format(params);options=options||{};if(!isHtml5&&url!==null){url="#"+$locationProvider.hashPrefix()+url}url=appendBasePath(url,isHtml5,options.absolute);if(!options.absolute||!url){return url}var slash=!isHtml5&&url?"/":"",port=$location.port();port=port===80||port===443?"":":"+port;return[$location.protocol(),"://",$location.host(),port,slash,url].join("")}}}}angular.module("ui.router.router").provider("$urlRouter",$UrlRouterProvider);$StateProvider.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"];function $StateProvider($urlRouterProvider,$urlMatcherFactory){var root,states={},$state,queue={},abstractKey="abstract";var stateBuilder={parent:function(state){if(isDefined(state.parent)&&state.parent)return findState(state.parent);var compositeName=/^(.+)\.[^.]+$/.exec(state.name);return compositeName?findState(compositeName[1]):root},data:function(state){if(state.parent&&state.parent.data){state.data=state.self.data=extend({},state.parent.data,state.data)}return state.data},url:function(state){var url=state.url,config={params:state.params||{}};if(isString(url)){if(url.charAt(0)=="^")return $urlMatcherFactory.compile(url.substring(1),config);return(state.parent.navigable||root).url.concat(url,config)}if(!url||$urlMatcherFactory.isMatcher(url))return url;throw new Error("Invalid url '"+url+"' in state '"+state+"'")},navigable:function(state){return state.url?state:state.parent?state.parent.navigable:null},ownParams:function(state){var params=state.url&&state.url.params||new $$UMFP.ParamSet;forEach(state.params||{},function(config,id){if(!params[id])params[id]=new $$UMFP.Param(id,null,config,"config")});return params},params:function(state){return state.parent&&state.parent.params?extend(state.parent.params.$$new(),state.ownParams):new $$UMFP.ParamSet},views:function(state){var views={};forEach(isDefined(state.views)?state.views:{"":state},function(view,name){if(name.indexOf("@")<0)name+="@"+state.parent.name;views[name]=view});return views},path:function(state){return state.parent?state.parent.path.concat(state):[]},includes:function(state){var includes=state.parent?extend({},state.parent.includes):{};includes[state.name]=true;return includes},$delegates:{}};function isRelative(stateName){return stateName.indexOf(".")===0||stateName.indexOf("^")===0}function findState(stateOrName,base){if(!stateOrName)return undefined;var isStr=isString(stateOrName),name=isStr?stateOrName:stateOrName.name,path=isRelative(name);if(path){if(!base)throw new Error("No reference point given for path '"+name+"'");base=findState(base);var rel=name.split("."),i=0,pathLength=rel.length,current=base;for(;i<pathLength;i++){if(rel[i]===""&&i===0){current=base;continue}if(rel[i]==="^"){if(!current.parent)throw new Error("Path '"+name+"' not valid for state '"+base.name+"'");current=current.parent;continue}break}rel=rel.slice(i).join(".");name=current.name+(current.name&&rel?".":"")+rel}var state=states[name];if(state&&(isStr||!isStr&&(state===stateOrName||state.self===stateOrName))){return state}return undefined}function queueState(parentName,state){if(!queue[parentName]){queue[parentName]=[]}queue[parentName].push(state)}function flushQueuedChildren(parentName){var queued=queue[parentName]||[];while(queued.length){registerState(queued.shift())}}function registerState(state){state=inherit(state,{self:state,resolve:state.resolve||{},toString:function(){return this.name}});var name=state.name;if(!isString(name)||name.indexOf("@")>=0)throw new Error("State must have a valid name");if(states.hasOwnProperty(name))throw new Error("State '"+name+"'' is already defined");var parentName=name.indexOf(".")!==-1?name.substring(0,name.lastIndexOf(".")):isString(state.parent)?state.parent:isObject(state.parent)&&isString(state.parent.name)?state.parent.name:"";if(parentName&&!states[parentName]){return queueState(parentName,state.self)}for(var key in stateBuilder){if(isFunction(stateBuilder[key]))state[key]=stateBuilder[key](state,stateBuilder.$delegates[key])}states[name]=state;if(!state[abstractKey]&&state.url){$urlRouterProvider.when(state.url,["$match","$stateParams",function($match,$stateParams){if($state.$current.navigable!=state||!equalForKeys($match,$stateParams)){$state.transitionTo(state,$match,{inherit:true,location:false})}}])}flushQueuedChildren(name);return state}function isGlob(text){return text.indexOf("*")>-1}function doesStateMatchGlob(glob){var globSegments=glob.split("."),segments=$state.$current.name.split(".");if(globSegments[0]==="**"){segments=segments.slice(indexOf(segments,globSegments[1]));segments.unshift("**")}if(globSegments[globSegments.length-1]==="**"){segments.splice(indexOf(segments,globSegments[globSegments.length-2])+1,Number.MAX_VALUE);segments.push("**")}if(globSegments.length!=segments.length){return false}for(var i=0,l=globSegments.length;i<l;i++){if(globSegments[i]==="*"){segments[i]="*"}}return segments.join("")===globSegments.join("")}root=registerState({name:"",url:"^",views:null,abstract:true});root.navigable=null;this.decorator=decorator;function decorator(name,func){if(isString(name)&&!isDefined(func)){return stateBuilder[name]}if(!isFunction(func)||!isString(name)){return this}if(stateBuilder[name]&&!stateBuilder.$delegates[name]){stateBuilder.$delegates[name]=stateBuilder[name]}stateBuilder[name]=func;return this}this.state=state;function state(name,definition){if(isObject(name))definition=name;else definition.name=name;registerState(definition);return this}this.$get=$get;$get.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$urlRouter","$location","$urlMatcherFactory"];function $get($rootScope,$q,$view,$injector,$resolve,$stateParams,$urlRouter,$location,$urlMatcherFactory){var TransitionSuperseded=$q.reject(new Error("transition superseded"));var TransitionPrevented=$q.reject(new Error("transition prevented"));var TransitionAborted=$q.reject(new Error("transition aborted"));var TransitionFailed=$q.reject(new Error("transition failed"));function handleRedirect(redirect,state,params,options){var evt=$rootScope.$broadcast("$stateNotFound",redirect,state,params);if(evt.defaultPrevented){$urlRouter.update();return TransitionAborted}if(!evt.retry){return null}if(options.$retry){$urlRouter.update();return TransitionFailed}var retryTransition=$state.transition=$q.when(evt.retry);retryTransition.then(function(){if(retryTransition!==$state.transition)return TransitionSuperseded;redirect.options.$retry=true;return $state.transitionTo(redirect.to,redirect.toParams,redirect.options)},function(){return TransitionAborted});$urlRouter.update();return retryTransition}root.locals={resolve:null,globals:{$stateParams:{}}};$state={params:{},current:root.self,$current:root,transition:null};$state.reload=function reload(){return $state.transitionTo($state.current,$stateParams,{reload:true,inherit:false,notify:true})};$state.go=function go(to,params,options){return $state.transitionTo(to,params,extend({inherit:true,relative:$state.$current},options))};$state.transitionTo=function transitionTo(to,toParams,options){toParams=toParams||{};options=extend({location:true,inherit:false,relative:null,notify:true,reload:false,$retry:false},options||{});var from=$state.$current,fromParams=$state.params,fromPath=from.path;var evt,toState=findState(to,options.relative);if(!isDefined(toState)){var redirect={to:to,toParams:toParams,options:options};var redirectResult=handleRedirect(redirect,from.self,fromParams,options);if(redirectResult){return redirectResult}to=redirect.to;toParams=redirect.toParams;options=redirect.options;toState=findState(to,options.relative);if(!isDefined(toState)){if(!options.relative)throw new Error("No such state '"+to+"'");throw new Error("Could not resolve '"+to+"' from state '"+options.relative+"'")}}if(toState[abstractKey])throw new Error("Cannot transition to abstract state '"+to+"'");if(options.inherit)toParams=inheritParams($stateParams,toParams||{},$state.$current,toState);if(!toState.params.$$validates(toParams))return TransitionFailed;toParams=toState.params.$$values(toParams);to=toState;var toPath=to.path;var keep=0,state=toPath[keep],locals=root.locals,toLocals=[];if(!options.reload){while(state&&state===fromPath[keep]&&state.ownParams.$$equals(toParams,fromParams)){locals=toLocals[keep]=state.locals;keep++;state=toPath[keep]}}if(shouldTriggerReload(to,from,locals,options)){if(to.self.reloadOnSearch!==false)$urlRouter.update();$state.transition=null;return $q.when($state.current)}toParams=filterByKeys(to.params.$$keys(),toParams||{});if(options.notify){if($rootScope.$broadcast("$stateChangeStart",to.self,toParams,from.self,fromParams).defaultPrevented){$urlRouter.update();return TransitionPrevented}}var resolved=$q.when(locals);for(var l=keep;l<toPath.length;l++,state=toPath[l]){locals=toLocals[l]=inherit(locals);resolved=resolveState(state,toParams,state===to,resolved,locals,options)}var transition=$state.transition=resolved.then(function(){var l,entering,exiting;if($state.transition!==transition)return TransitionSuperseded;for(l=fromPath.length-1;l>=keep;l--){exiting=fromPath[l];if(exiting.self.onExit){$injector.invoke(exiting.self.onExit,exiting.self,exiting.locals.globals)}exiting.locals=null}for(l=keep;l<toPath.length;l++){entering=toPath[l];entering.locals=toLocals[l];if(entering.self.onEnter){$injector.invoke(entering.self.onEnter,entering.self,entering.locals.globals)}}if($state.transition!==transition)return TransitionSuperseded;$state.$current=to;$state.current=to.self;$state.params=toParams;copy($state.params,$stateParams);$state.transition=null;if(options.location&&to.navigable){$urlRouter.push(to.navigable.url,to.navigable.locals.globals.$stateParams,{$$avoidResync:true,replace:options.location==="replace"})}if(options.notify){$rootScope.$broadcast("$stateChangeSuccess",to.self,toParams,from.self,fromParams)}$urlRouter.update(true);return $state.current},function(error){if($state.transition!==transition)return TransitionSuperseded;$state.transition=null;evt=$rootScope.$broadcast("$stateChangeError",to.self,toParams,from.self,fromParams,error);if(!evt.defaultPrevented){$urlRouter.update()}return $q.reject(error)});return transition};$state.is=function is(stateOrName,params,options){options=extend({relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);if(!isDefined(state)){return undefined}if($state.$current!==state){return false}return params?equalForKeys(state.params.$$values(params),$stateParams):true};$state.includes=function includes(stateOrName,params,options){options=extend({relative:$state.$current},options||{});if(isString(stateOrName)&&isGlob(stateOrName)){if(!doesStateMatchGlob(stateOrName)){return false}stateOrName=$state.$current.name}var state=findState(stateOrName,options.relative);if(!isDefined(state)){return undefined}if(!isDefined($state.$current.includes[state.name])){return false}return params?equalForKeys(state.params.$$values(params),$stateParams,objectKeys(params)):true};$state.href=function href(stateOrName,params,options){options=extend({lossy:true,inherit:true,absolute:false,relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);if(!isDefined(state))return null;if(options.inherit)params=inheritParams($stateParams,params||{},$state.$current,state);var nav=state&&options.lossy?state.navigable:state;if(!nav||nav.url===undefined||nav.url===null){return null}return $urlRouter.href(nav.url,filterByKeys(state.params.$$keys(),params||{}),{absolute:options.absolute})};$state.get=function(stateOrName,context){if(arguments.length===0)return map(objectKeys(states),function(name){return states[name].self});var state=findState(stateOrName,context||$state.$current);return state&&state.self?state.self:null};function resolveState(state,params,paramsAreFiltered,inherited,dst,options){var $stateParams=paramsAreFiltered?params:filterByKeys(state.params.$$keys(),params);var locals={$stateParams:$stateParams};dst.resolve=$resolve.resolve(state.resolve,locals,dst.resolve,state);var promises=[dst.resolve.then(function(globals){dst.globals=globals})];if(inherited)promises.push(inherited);forEach(state.views,function(view,name){var injectables=view.resolve&&view.resolve!==state.resolve?view.resolve:{};injectables.$template=[function(){return $view.load(name,{view:view,locals:locals,params:$stateParams,notify:options.notify})||""}];promises.push($resolve.resolve(injectables,locals,dst.resolve,state).then(function(result){if(isFunction(view.controllerProvider)||isArray(view.controllerProvider)){var injectLocals=angular.extend({},injectables,locals);result.$$controller=$injector.invoke(view.controllerProvider,null,injectLocals)}else{result.$$controller=view.controller}result.$$state=state;result.$$controllerAs=view.controllerAs;dst[name]=result}))});return $q.all(promises).then(function(values){return dst})}return $state}function shouldTriggerReload(to,from,locals,options){if(to===from&&(locals===from.locals&&!options.reload||to.self.reloadOnSearch===false)){return true}}}angular.module("ui.router.state").value("$stateParams",{}).provider("$state",$StateProvider);$ViewProvider.$inject=[];function $ViewProvider(){this.$get=$get;$get.$inject=["$rootScope","$templateFactory"];function $get($rootScope,$templateFactory){return{load:function load(name,options){var result,defaults={template:null,controller:null,view:null,locals:null,notify:true,async:true,params:{}};options=extend(defaults,options);if(options.view){result=$templateFactory.fromConfig(options.view,options.params,options.locals)}if(result&&options.notify){$rootScope.$broadcast("$viewContentLoading",options)}return result}}}}angular.module("ui.router.state").provider("$view",$ViewProvider);function $ViewScrollProvider(){var useAnchorScroll=false;this.useAnchorScroll=function(){useAnchorScroll=true};this.$get=["$anchorScroll","$timeout",function($anchorScroll,$timeout){if(useAnchorScroll){return $anchorScroll}return function($element){$timeout(function(){$element[0].scrollIntoView()},0,false)}}]}angular.module("ui.router.state").provider("$uiViewScroll",$ViewScrollProvider);$ViewDirective.$inject=["$state","$injector","$uiViewScroll","$interpolate"];function $ViewDirective($state,$injector,$uiViewScroll,$interpolate){function getService(){return $injector.has?function(service){return $injector.has(service)?$injector.get(service):null}:function(service){try{return $injector.get(service)}catch(e){return null}}}var service=getService(),$animator=service("$animator"),$animate=service("$animate");function getRenderer(attrs,scope){var statics=function(){return{enter:function(element,target,cb){target.after(element);cb()},leave:function(element,cb){element.remove();cb()}}};if($animate){return{enter:function(element,target,cb){var promise=$animate.enter(element,null,target,cb);if(promise&&promise.then)promise.then(cb)},leave:function(element,cb){var promise=$animate.leave(element,cb);if(promise&&promise.then)promise.then(cb)}}}if($animator){var animate=$animator&&$animator(scope,attrs);return{enter:function(element,target,cb){animate.enter(element,null,target);cb()},leave:function(element,cb){animate.leave(element);cb()}}}return statics()}var directive={restrict:"ECA",terminal:true,priority:400,transclude:"element",compile:function(tElement,tAttrs,$transclude){return function(scope,$element,attrs){var previousEl,currentEl,currentScope,latestLocals,onloadExp=attrs.onload||"",autoScrollExp=attrs.autoscroll,renderer=getRenderer(attrs,scope);scope.$on("$stateChangeSuccess",function(){updateView(false)});scope.$on("$viewContentLoading",function(){updateView(false)});updateView(true);function cleanupLastView(){if(previousEl){previousEl.remove();previousEl=null}if(currentScope){currentScope.$destroy();currentScope=null}if(currentEl){renderer.leave(currentEl,function(){previousEl=null});previousEl=currentEl;currentEl=null}}function updateView(firstTime){var newScope,name=getUiViewName(scope,attrs,$element,$interpolate),previousLocals=name&&$state.$current&&$state.$current.locals[name];if(!firstTime&&previousLocals===latestLocals)return;newScope=scope.$new();latestLocals=$state.$current.locals[name];var clone=$transclude(newScope,function(clone){renderer.enter(clone,$element,function onUiViewEnter(){if(currentScope){currentScope.$emit("$viewContentAnimationEnded")}if(angular.isDefined(autoScrollExp)&&!autoScrollExp||scope.$eval(autoScrollExp)){$uiViewScroll(clone)}});cleanupLastView()});currentEl=clone;currentScope=newScope;currentScope.$emit("$viewContentLoaded");currentScope.$eval(onloadExp)}}}};return directive}$ViewDirectiveFill.$inject=["$compile","$controller","$state","$interpolate"];function $ViewDirectiveFill($compile,$controller,$state,$interpolate){return{restrict:"ECA",priority:-400,compile:function(tElement){var initial=tElement.html();return function(scope,$element,attrs){var current=$state.$current,name=getUiViewName(scope,attrs,$element,$interpolate),locals=current&&current.locals[name];if(!locals){return}$element.data("$uiView",{name:name,state:locals.$$state});$element.html(locals.$template?locals.$template:initial);var link=$compile($element.contents());if(locals.$$controller){locals.$scope=scope;var controller=$controller(locals.$$controller,locals);if(locals.$$controllerAs){scope[locals.$$controllerAs]=controller}$element.data("$ngControllerController",controller);$element.children().data("$ngControllerController",controller)}link(scope)}}}}function getUiViewName(scope,attrs,element,$interpolate){var name=$interpolate(attrs.uiView||attrs.name||"")(scope);var inherited=element.inheritedData("$uiView");return name.indexOf("@")>=0?name:name+"@"+(inherited?inherited.state.name:"")}angular.module("ui.router.state").directive("uiView",$ViewDirective);angular.module("ui.router.state").directive("uiView",$ViewDirectiveFill);function parseStateRef(ref,current){var preparsed=ref.match(/^\s*({[^}]*})\s*$/),parsed;if(preparsed)ref=current+"("+preparsed[1]+")";parsed=ref.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/);if(!parsed||parsed.length!==4)throw new Error("Invalid state ref '"+ref+"'");return{state:parsed[1],paramExpr:parsed[3]||null}}function stateContext(el){var stateData=el.parent().inheritedData("$uiView");if(stateData&&stateData.state&&stateData.state.name){return stateData.state}}$StateRefDirective.$inject=["$state","$timeout"];function $StateRefDirective($state,$timeout){var allowedOptions=["location","inherit","reload"];return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(scope,element,attrs,uiSrefActive){var ref=parseStateRef(attrs.uiSref,$state.current.name);var params=null,url=null,base=stateContext(element)||$state.$current;var newHref=null,isAnchor=element.prop("tagName")==="A";var isForm=element[0].nodeName==="FORM";var attr=isForm?"action":"href",nav=true;var options={relative:base,inherit:true};var optionsOverride=scope.$eval(attrs.uiSrefOpts)||{};angular.forEach(allowedOptions,function(option){if(option in optionsOverride){options[option]=optionsOverride[option]}});var update=function(newVal){if(newVal)params=angular.copy(newVal);if(!nav)return;newHref=$state.href(ref.state,params,options);var activeDirective=uiSrefActive[1]||uiSrefActive[0];if(activeDirective){activeDirective.$$setStateInfo(ref.state,params)}if(newHref===null){nav=false;return false}attrs.$set(attr,newHref)};if(ref.paramExpr){scope.$watch(ref.paramExpr,function(newVal,oldVal){if(newVal!==params)update(newVal)},true);params=angular.copy(scope.$eval(ref.paramExpr))}update();if(isForm)return;element.bind("click",function(e){var button=e.which||e.button;if(!(button>1||e.ctrlKey||e.metaKey||e.shiftKey||element.attr("target"))){var transition=$timeout(function(){$state.go(ref.state,params,options)});e.preventDefault();var ignorePreventDefaultCount=isAnchor&&!newHref?1:0;e.preventDefault=function(){if(ignorePreventDefaultCount--<=0)$timeout.cancel(transition)}}})}}}$StateRefActiveDirective.$inject=["$state","$stateParams","$interpolate"];function $StateRefActiveDirective($state,$stateParams,$interpolate){return{restrict:"A",controller:["$scope","$element","$attrs",function($scope,$element,$attrs){var state,params,activeClass;activeClass=$interpolate($attrs.uiSrefActiveEq||$attrs.uiSrefActive||"",false)($scope);this.$$setStateInfo=function(newState,newParams){state=$state.get(newState,stateContext($element));params=newParams;update()};$scope.$on("$stateChangeSuccess",update);function update(){if(isMatch()){$element.addClass(activeClass)}else{$element.removeClass(activeClass)}}function isMatch(){if(typeof $attrs.uiSrefActiveEq!=="undefined"){return state&&$state.is(state.name,params)}else{return state&&$state.includes(state.name,params)}}}]}}angular.module("ui.router.state").directive("uiSref",$StateRefDirective).directive("uiSrefActive",$StateRefActiveDirective).directive("uiSrefActiveEq",$StateRefActiveDirective);$IsStateFilter.$inject=["$state"];function $IsStateFilter($state){var isFilter=function(state){return $state.is(state)};isFilter.$stateful=true;return isFilter}$IncludedByStateFilter.$inject=["$state"];function $IncludedByStateFilter($state){var includesFilter=function(state){return $state.includes(state)};includesFilter.$stateful=true;return includesFilter}angular.module("ui.router.state").filter("isState",$IsStateFilter).filter("includedByState",$IncludedByStateFilter)})(window,window.angular);
(function(window){"use strict";window.timing=window.timing||{getTimes:function(opts){var performance=window.performance||window.webkitPerformance||window.msPerformance||window.mozPerformance;if(performance===undefined){return false}var timing=performance.timing;var api={};opts=opts||{};if(timing){if(opts&&!opts.simple){for(var k in timing){if(isNumeric(timing[k])){api[k]=parseFloat(timing[k])}}}if(api.firstPaint===undefined){var firstPaint=0;if(window.chrome&&window.chrome.loadTimes){firstPaint=window.chrome.loadTimes().firstPaintTime*1e3;api.firstPaintTime=firstPaint-window.chrome.loadTimes().startLoadTime*1e3}else if(typeof window.performance.timing.msFirstPaint==="number"){firstPaint=window.performance.timing.msFirstPaint;api.firstPaintTime=firstPaint-window.performance.timing.navigationStart}if(opts&&!opts.simple){api.firstPaint=firstPaint}}api.loadTime=timing.loadEventEnd-timing.fetchStart;api.domReadyTime=timing.domComplete-timing.domInteractive;api.readyStart=timing.fetchStart-timing.navigationStart;api.redirectTime=timing.redirectEnd-timing.redirectStart;api.appcacheTime=timing.domainLookupStart-timing.fetchStart;api.unloadEventTime=timing.unloadEventEnd-timing.unloadEventStart;api.lookupDomainTime=timing.domainLookupEnd-timing.domainLookupStart;api.connectTime=timing.connectEnd-timing.connectStart;api.requestTime=timing.responseEnd-timing.requestStart;api.initDomTreeTime=timing.domInteractive-timing.responseEnd;api.loadEventTime=timing.loadEventEnd-timing.loadEventStart}return api},printTable:function(opts){var table={};var data=this.getTimes(opts)||{};Object.keys(data).sort().forEach(function(k){table[k]={ms:data[k],s:+(data[k]/1e3).toFixed(2)}});console.table(table)},printSimpleTable:function(){this.printTable({simple:true})}};function isNumeric(n){return!isNaN(parseFloat(n))&&isFinite(n)}})(this);
(function(ng){"use strict";var module=ng.module("ats.common",["ats.services","components.core.alert","components.core.interval","components.core.modal","components.core.truncation","components.core.storage","upwork.transport"]);module.constant("TL_BASE_PATH",null).constant("ATS_OPENING_CLOSED_STATUS_SET",["cancelled","delete_draft","draft","filled"])})(angular);
(function(ng){"use strict";var module=ng.module("ats.common");module.directive("agencyFreelancerBottomSlot",agencyFreelancerBottomSlot);agencyFreelancerBottomSlot.$inject=["applet"];function agencyFreelancerBottomSlot(applet){return{scope:{freelancer:"<",tileSharedData:"<"},link:link,templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/agency-freelancer-bottom-slot/agency-freelancer-bottom-slot.html")};function link($scope){$scope.recommendReasonsLinkClicked=$scope.tileSharedData.recommendReasonsLinkClicked;$scope.isRecommendReasonsOnSearchEnabled=applet.getVar("isRecommendReasonsOnSearchEnabled")}}})(angular);
(function(ng){"use strict";var module=ng.module("ats.common");module.directive("atsInterviewInvitation",atsInterviewInvitation);atsInterviewInvitation.$inject=["applet","$httpParamSerializer","$window","ATS_OPENING_CLOSED_STATUS_SET"];function atsInterviewInvitation(applet,$httpParamSerializer,$window,ATS_OPENING_CLOSED_STATUS_SET){return{controller:controller,link:link,templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/ats-interview-invitation/ats-interview-invitation.html"),scope:{openingUid:"<?",userUid:"<",userCiphertext:"<",userAvatarUrl:"<",userName:"<",userTitle:"<",userProfileUrl:"@",eventLogLocation:"@",eventLogSublocation:"<?",userAgency:"<?",clientOpenJobs:"<?",isShowCreateJobLink:"<?",appendToBody:"@?",jobPostKvl:"@?",btnClass:"@?",openingStatus:"<?"},restrict:"A"};function controller($scope){$scope.btnClass=$scope.btnClass||"btn btn-block btn-primary btn-sm m-0-top m-0-left-right m-sm-bottom"}function link($scope){$scope.hasOpeningUid=false;if(ng.isDefined($scope.openingUid)){$scope.hasOpeningUid=Boolean($scope.openingUid);var unwatchOpeningUid=$scope.$watch("openingUid",function(newValue){$scope.hasOpeningUid=Boolean(newValue);if(ng.isDefined(newValue)){unwatchOpeningUid()}})}if(ng.isDefined($scope.openingStatus)){var unwatchOpeningStatus=$scope.$watch("openingStatus",function(newValue){$scope.isOpeningClosed=$scope.hasOpeningUid&&newValue&&ATS_OPENING_CLOSED_STATUS_SET.indexOf(newValue)!==-1;if(ng.isDefined(newValue)){unwatchOpeningStatus()}})}$scope.goToCreateNewJobPage=function(){var orgRid=applet.getOrganization()?applet.getOrganization().getRid():null;var companyRef=orgRid?"/"+orgRid:"";var link="/e"+companyRef+"/jobs/invite/"+$scope.userCiphertext;var queryParams={new_job:1};if($scope.jobPostKvl){queryParams["dataFrom"]=$scope.jobPostKvl}if(Object.keys(queryParams).length){link+="?"+$httpParamSerializer(queryParams)}$window.open(link)}}}})(angular);
(function(ng){"use strict";ng.module("ats.common").directive("atsProfileSliderActions",atsProfileSliderActions);atsProfileSliderActions.$inject=["applet","externalRouting","LOG_LOCATION"];function atsProfileSliderActions(applet,externalRouting,LOG_LOCATION){return{restrict:"A",scope:{sliderSettings:"<",vpd:"<",profileSettings:"<",isEnabled:"@?"},templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/ats-profile-slider-actions/ats-profile-slider-actions.html"),link:link};function link(scope){var vpd=scope.vpd;var settings=scope.sliderSettings;var options={};scope.isDisabledState=scope.isEnabled==="false";options.openingUid=settings.openingUid;options.openingStatus=settings.openingStatus;options.isButtonHireNow=settings.isButtonHireNow;options.isButtonSave=settings.isButtonSave;options.isButtonInvitation=settings.isButtonInvitation;options.profileRid=vpd.identity.recno;options.profileUid=vpd.identity.uid;options.cipherText=vpd.identity.ciphertext;options.photoUrl=vpd.profile.portrait.portrait;options.profileTitle=vpd.profile.title;options.profileUrl=externalRouting.getFreelancerProfileUrl(options.cipherText);options.shortName=vpd.profile.shortName;options.isShowCreateJobLink=settings.isShowCreateJobLink;options.agency=findDefaultAgency(vpd);if(options.agency&&!options.agency.profileUrl){options.agency.profileUrl=externalRouting.getAgencyProfileUrl(options.agency.chipertext)}if(settings.clientActiveJobsPromise){options.clientOpenJobs=null;settings.clientActiveJobsPromise.then(function(response){options.clientOpenJobs=response})}if(options.isButtonHireNow){options.offerUrl=externalRouting.getFreelancerNewOfferUrl(settings.teamRid,options.profileRid,settings.previousContractId)}scope.options=options;scope.logLocation=LOG_LOCATION}function findDefaultAgency(vpd){if(vpd.profile.agencyRef&&ng.isArray(vpd.agencies)){var agencyRef=parseInt(vpd.profile.agencyRef,10);for(var i=0;i<vpd.agencies.length;i++){if(agencyRef===vpd.agencies[i].recno){return vpd.agencies[i]}}}}}})(angular);
(function(ng){"use strict";ng.module("ats.common").controller("atsProfileSliderController",atsProfileSliderController);atsProfileSliderController.$inject=["ProfileOverlayService","$modalInstance","_cipher","_settings","_freelancerVps","fe.components.profile.overlay.models.VPD","fe.components.profile.overlay.models.settings","$scope","$rootScope","$timeout","logEventService","LOG_LOCATION"];function atsProfileSliderController(ProfileOverlayService,$modalInstance,_cipher,_settings,_freelancerVps,VPDModel,SettingsModel,$scope,$rootScope,$timeout,logEventService,LOG_LOCATION){var unlisten=$rootScope.$on("$locationChangeStart",function($event,newUrl,oldUrl){if(newUrl===oldUrl+"#oProfileAssignments"||newUrl+"#oProfileAssignments"===oldUrl){$event.preventDefault()}});$scope.$on("$destroy",function(){unlisten()});var $ctrl=this;var openingRids=ng.isArray(_settings.openingRids)?_settings.openingRids:undefined;$ctrl.isError=false;$ctrl.errorText="";$ctrl.preVpd=null;$ctrl.preSettings=null;$ctrl.vpd=null;$ctrl.settings=null;$ctrl.$modalInstance=$modalInstance;$ctrl.backButtonTitle=_settings.backButtonTitle;$ctrl.sliderSettings=_settings;$ctrl.isScrollToWorkHistory=false;$ctrl.logLocation="freelancer_overlay";$ctrl.getLogData=function(){return $ctrl.sliderSettings.logData};logEventService.setLogGuid($ctrl.logLocation,logEventService.getLogGuid(LOG_LOCATION));if(!$ctrl.sliderSettings.logData){$ctrl.sliderSettings.logData={type:"contractor",id:_cipher}}logEventService.logEvent("impression",$ctrl.logLocation,"",[$ctrl.sliderSettings.logData]);if(_freelancerVps){$ctrl.preVpd=new VPDModel;$ctrl.preSettings=new SettingsModel;extendVpdWithVpsProfile($ctrl.preVpd,_freelancerVps);ProfileOverlayService.initVPD($ctrl.preVpd);ProfileOverlayService.initSettings($ctrl.preSettings)}ProfileOverlayService.getProfile(_cipher,openingRids).then(function(data){$ctrl.vpd=data.vpd;$ctrl.settings=data.settings;if($ctrl.settings.isHireButtonDisabled){$ctrl.sliderSettings.isButtonHireNow=false}$ctrl.settings.isHireButtonDisabled=true;var isWorkHistory=ng.isArray(openingRids);if(isWorkHistory){$timeout(function(){$ctrl.isScrollToWorkHistory=isWorkHistory})}},function(response){$ctrl.errorText=getErrorTextByResponseCode(response.status);$ctrl.isError=true});function extendVpdWithVpsProfile(vpd,freelancer){ng.extend(vpd,{ready:true,identity:{ciphertext:freelancer.ciphertext,recno:freelancer.recno},profile:{name:freelancer.shortName,shortName:freelancer.shortName,title:freelancer.title,location:freelancer.location,description:freelancer.description,portrait:{portrait:freelancer.miniPortrait,bigPortrait:freelancer.portrait,smallPortrait:freelancer.smallPortrait,originalPortrait:freelancer.largePortrait},skills:vpsToVpdSkills(freelancer.skills)},stats:{hourlyRate:freelancer.hourlyRate}})}function vpsToVpdSkills(skills){if(!ng.isArray(skills)){return null}var vpdSkills=[];skills.map(function(skill){var skillTests=null;if(skill.tests&&Object.keys(skill.tests)>0){skillTests=[];ng.forEach(skill.tests,function(test){skillTests.push(test)})}vpdSkills.push({uid:skill.uid,prettyName:skill.skill.prettyName,name:skill.skill.name,tests:skillTests})});return vpdSkills}function getErrorTextByResponseCode(responseCode){switch(responseCode){case 403:return"Sorry, profile is forbidden.";default:return"Sorry, something went wrong. Please <a "+'href="https://support.upwork.com/anonymous_requests/new" target="_blank">contact support</a>.'}}}})(angular);
(function(ng){"use strict";ng.module("ats.common").service("atsProfileSliderService",atsProfileSliderService);atsProfileSliderService.$inject=["eoModal","applet"];function atsProfileSliderService(eoModal,applet){return{open:open};function open(cipher,settings,freelancerVPS){return eoModal.overlay({templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/ats-profile-slider/ats-profile-slider.html"),controller:"atsProfileSliderController",controllerAs:"$ctrl",locals:{_cipher:cipher,_settings:settings,_freelancerVps:freelancerVPS}})}}})(angular);
(function(ng){"use strict";var module=ng.module("ats.common");module.directive("blueDotHelp",blueDotHelp);blueDotHelp.$inject=["applet","customSmf","$timeout","eoStorage"];function blueDotHelp(applet,customSmf,$timeout,eoStorage){return{link:link,templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/blue-dot-help/blue-dot-help.html"),scope:{smfSelector:"@",smfReadyCallback:"&?",nestedClassAttr:"@",contentClassAttr:"@",isOpenOnLoad:"@",popoverSize:"@?",popoverPosition:"@?",buttonClass:"@?",buttonText:"@?"},restrict:"A"};function link($scope){var isOpenOnLoad=$scope.isOpenOnLoad==="true";$scope.isPopupOpen=false;$scope.popoverSize=$scope.popoverSize||"lg";$scope.popoverPosition=$scope.popoverPosition||"top";$scope.buttonClass=$scope.buttonClass||"btn btn-primary m-md-top m-0-bottom m-0-left";$scope.buttonText=$scope.buttonText||"Got it";customSmf.getMessagesPromise().then(function(messages){if(messages&&ng.isDefined(messages[$scope.smfSelector])){if($scope.smfSelector==="tooltipSearchInUsLocation"&&messages[$scope.smfSelector]&&eoStorage.getItem("search.usUsToggleTooltipDone")){customSmf.dismiss(messages[$scope.smfSelector].customSelector);return}$scope.smf=messages[$scope.smfSelector];if($scope.smf!==null){var beforeDisplayCount=customSmf.updateShowCount($scope.smfSelector);if(beforeDisplayCount===0){if(isOpenOnLoad){$timeout(function(){$scope.isPopupOpen=true})}if(ng.isFunction($scope.smfReadyCallback)){$scope.smfReadyCallback()}}}}});$scope.dismiss=function(){customSmf.dismiss($scope.smf.customSelector);$scope.smf=null;if($scope.smfSelector==="tooltipSearchInUsLocation"){eoStorage.setItem("search.usUsToggleTooltipDone",true)}};$scope.getPopoverUri=function(){return applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/blue-dot-help/blue-dot-popover.html")}}}})(angular);
(function(ng){"use strict";var module=ng.module("ats.common");module.directive("closeOverlayButton",CloseOverlayButton);CloseOverlayButton.$inject=["applet","$document"];function CloseOverlayButton(applet,$document){return{link:link,templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/close-overlay-button/close-overlay-button.html")};function link($scope,$element){var overlay=getOverlay($element);$element.detach();if(overlay){ng.element(overlay).append($element)}}function getOverlay($element){var overlays=$document[0].querySelectorAll(".modal-overlay");if(overlays.length===1){return overlays[0]}else{var parent=$element[0].parentNode;while(parent){for(var i=0;i<overlays.length;i++){if(parent===overlays[i]){return overlays[i]}}parent=parent.parentNode}}return null}}})(angular);
(function(ng){"use strict";var module=ng.module("ats.common");module.directive("currentTime",currentTime);currentTime.$inject=["$interval","$filter"];function currentTime($interval,$filter){return{link:link,template:"<span>{{ time }}</span>",scope:{format:"@",offset:"<"}};function link($scope){var updateTimeInterval;function updateTime(){var otherOffset=$scope.offset?$scope.offset*1e3:0;var currentOffset=(new Date).getTimezoneOffset()*60*1e3;var now=new Date((new Date).getTime()+otherOffset+currentOffset);$scope.time=$filter("date")(now,$scope.format)}updateTime();updateTimeInterval=$interval(updateTime,30*1e3);$scope.$on("$destroy",function(){$interval.cancel(updateTimeInterval)})}}})(angular);
(function(ng,applet){"use strict";var module=ng.module("ats.common");module.factory("freelancersBlockService",freelancersBlockService);module.constant("FREELANCER_BLOCK_POLLER_INTERVAL",12e4);freelancersBlockService.$inject=["freelancerList","ATS_FREELANCER_BLOCK_ITEMS_PER_PAGE","eoInterval","$q","FREELANCER_BLOCK_POLLER_INTERVAL"];function freelancersBlockService(freelancerList,ATS_FREELANCER_BLOCK_ITEMS_PER_PAGE,eoInterval,$q,FREELANCER_BLOCK_POLLER_INTERVAL){var initialParams={title:"",freelancers:[],isCollapsed:true,searchInput:"",emptyState:{icon:"",text:""},pagination:{currentPage:1,pagesTotal:null,totalItems:null,itemsPerPage:ATS_FREELANCER_BLOCK_ITEMS_PER_PAGE,maxSize:5},totalCount:null,isEmptyBannerAvailable:true};var serviceSettings={saved:{title:"Saved Freelancers",hasPermissions:true,emptyState:{image:applet.buildInternalAssetPath("@OdeskAtsBundle/images/no-results/no-saved.svg"),title:"You have no saved freelancers",noResult:"No matching saved freelancers",text:"After you save a freelancer you like, they'll show up here so you can easily invite "+"them to this job."},isCountPollerEnabled:true},"past-hires":{title:"Past Hires",hasPermissions:true,emptyState:{image:applet.buildInternalAssetPath("@OdeskAtsBundle/images/no-results/no-hires.svg"),title:"You have no past hires",noResult:"No matching past hires",text:"After you've hired a freelancer, they'll show up here so you can easily invite them"+" to this job."},noPermissionsState:{image:applet.buildInternalAssetPath("@OdeskAtsBundle/images/no-results/no-hires.svg"),title:"Past hires not shown",text:"You don't have access to view past hires in this company."},isCountPollerEnabled:false}};var services={};return{getService:getService};function getService(serviceName){if(ng.isUndefined(services[serviceName])){services[serviceName]=new Service(serviceName)}return services[serviceName]}function Service(serviceName){var intervalPollerPromise;var isPageOutOfBounds=false;this.serviceState=getInitialState();var serviceState=this.serviceState;function getInitialState(){var params=ng.copy(initialParams);if(ng.isUndefined(serviceSettings[serviceName])){throw"Undefined settings for "+serviceName}var settings=serviceSettings[serviceName];params.title=settings.title;params.emptyState=settings.emptyState;params.hasPermissions=settings.hasPermissions;params.noPermissionsState=settings.noPermissionsState;params.isCountPollerEnabled=settings.isCountPollerEnabled;return params}this.getOffset=function(){return(serviceState.pagination.currentPage-1)*serviceState.pagination.itemsPerPage};this.getState=function(){return serviceState};this.hasPermissions=function(){return serviceState.hasPermissions};this.fetchFreelancers=function(){var self=this;return freelancerList.getFreelancerList(getApiEndpointName(),{page:serviceState.pagination.currentPage,filter:serviceState.searchInput}).then(function(response){isPageOutOfBounds=false;serviceState.freelancers=response.results.profiles;var paging=response.results.paging;serviceState.pagination.totalItems=paging.total;serviceState.pagination.pagesTotal=paging.pagesTotal;setEmptyBannerAvailability(paging.total);return response},function(err){var error=err.data;if(serviceName==="past-hires"&&error.errorCode===40300){serviceState.hasPermissions=false}else if(!isPageOutOfBounds&&error.errorCode==="pageOutOfBounds"&&error.maxPageIndex>0){isPageOutOfBounds=true;serviceState.pagination.currentPage=error.maxPageIndex;return self.fetchFreelancers()}})};this.getTotalCount=function(){if(serviceState.totalCount!==null){return $q.when(serviceState.totalCount)}return this.fetchTotalCount().then(function(){return serviceState.totalCount})};this.fetchTotalCount=function(){return freelancerList.getFreelancerListCounts(getApiEndpointName()).then(function(result){serviceState.totalCount=result.count;setEmptyBannerAvailability(result.count);return result.count},function(err){if(serviceName==="past-hires"&&err.data.errorCode===40300){serviceState.hasPermissions=false}return $q.reject(err)})};this.resetPagination=function(){serviceState.pagination.currentPage=1;serviceState.pagination.totalItems=0};this.isCountPollerEnabled=function(){return serviceState.hasPermissions&&serviceState.isCountPollerEnabled};this.incTotalCount=function(){this.serviceState.totalCount++};this.decTotalCount=function(){this.serviceState.totalCount--;if(this.serviceState.totalCount<0){this.serviceState.totalCount=0}};this.startPoller=function(){if(!intervalPollerPromise){intervalPollerPromise=eoInterval.create({delay:FREELANCER_BLOCK_POLLER_INTERVAL,callback:this.fetchTotalCount,throttleLevel:1,throttleOnBlur:true,throttleOnFail:true})}};this.stopPoller=function(){if(intervalPollerPromise){eoInterval.cancel(intervalPollerPromise);intervalPollerPromise=null}};this.fetchInitTotalCount=function(){serviceState.isEmptyBannerAvailable=true;return this.fetchTotalCount()};function getApiEndpointName(){return serviceName==="saved"?"favorites":serviceName}function setEmptyBannerAvailability(counts){if(serviceState.isEmptyBannerAvailable){serviceState.isEmptyBannerAvailable=!counts}}}}})(angular,Applet);
(function(ng,applet){"use strict";var module=ng.module("ats.common");module.directive("freelancersBlock",freelancersBlock);freelancersBlock.$inject=["applet","freelancersBlockService","atsUrlLinkRouter","eoBlockWatcher","atsContext","LOG_LOCATION","atsEventLogger","$window","externalRouting","$timeout"];function freelancersBlock(applet,freelancersBlockService,atsUrlLinkRouter,eoBlockWatcher,atsContext,LOG_LOCATION,atsEventLogger,$window,externalRouting,$timeout){return{link:link,templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/freelancers-block/freelancers-block.html"),scope:{type:"<",openDetails:"&",isUsPreferenceOn:"<?"}};function link($scope){var preventingDoubleEvent=false;$scope.logLocation=LOG_LOCATION;$scope.loadingWatcher=new eoBlockWatcher;var service=freelancersBlockService.getService($scope.type);service.fetchInitTotalCount();$scope.blockState=service.getState();fetchFreelancers();$scope.hasPermissions=service.hasPermissions;$scope.mode="compact";$scope.handlePageChanged=function(data){fetchFreelancers();var subLocation=[atsContext.isAppApplicants()?"ats":"search","navigation_bottom",data.actionType].join("_");var logData={type:"query",page:$scope.blockState.pagination.currentPage,label:data.actionType==="page_number"?"page_number":data.actionType+"_page",selected_tab:$scope.type};atsEventLogger.logPaginationEvent(subLocation,logData)};$scope.onSearch=function(){service.resetPagination();fetchFreelancers()};function fetchFreelancers(){atsEventLogger.logQueryImpression($scope.type,{search:$scope.blockState.searchInput},$scope.blockState.pagination.currentPage);$scope.loadingWatcher.wait(service.fetchFreelancers().then(function(){atsEventLogger.logFreelancerListImpression(atsContext.getOpeningUid(),$scope.type,$scope.blockState.freelancers,$scope.blockState.pagination.currentPage,"compact")}))}$scope.tileClicked=function(freelancer,$event,source,isTileCallback){if(preventingDoubleEvent){return}preventingDoubleEvent=true;$timeout(function(){preventingDoubleEvent=false},300);if(!isTileCallback&&!isTileClickedDirectly($event)){return false}if(freelancer.isAgencyContractor&&["name","avatar","skills-more","tile_agency_member"].indexOf(source)===-1){$window.open(externalRouting.getAgencyProfileUrl(freelancer.agency.ciphertext))}else{$scope.openDetails({freelancer:freelancer,isMetaKeyPressed:$event.ctrlKey||$event.metaKey||$event.which===2,options:{logData:$scope.getLogData(freelancer,$scope.blockState.freelancers.indexOf(freelancer))}})}};$scope.getDetailsUrl=function(freelancer){if(freelancer.isAgencyContractor){return externalRouting.getAgencyProfileUrl(freelancer.agency.ciphertext)}return atsUrlLinkRouter.getConnectedFreelancerDetailsUrl(freelancer)};$scope.getRecordIndex=function(index){return service.getOffset()+index+1};$scope.getLogData=function(freelancer,index){return{type:"contractor",id:freelancer.profileRid,position:$scope.getRecordIndex(index),opening:atsContext.getOpeningUid(),folder:$scope.type,mode:$scope.mode}}}function isTileClickedDirectly($event){var $target=$($event.target);var ignoreSelector=".btn, button, a, .pulse-dot";return!($target.is(ignoreSelector)||$target.closest(ignoreSelector).length>0)}}})(angular,Applet);
(function(ng,applet){"use strict";var module=ng.module("ats.common");module.component("freelancersSearch",{templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/freelancers-search/freelancers-search.html"),controller:freelancersSearch,transclude:{topTileSlot:"?topTileSlot"},bindings:{formSmfHelpSelector:"@?",searchProfilesCallback:"&",openDetails:"&",itemsPerPage:"@",startPage:"@",suggestionTypes:"@?",isUsMarketAvailable:"<?",isUsMarketEnabledOnTiles:"<?"}});freelancersSearch.$inject=["$scope","eoBlockWatcher","freelancerTileSwitcherService","flSearchService","atsUrlLinkRouter","$timeout","LOG_LOCATION","atsContext","atsEventLogger","externalRouting","$window","atsUsMarket"];function freelancersSearch($scope,eoBlockWatcher,freelancerTileSwitcherService,flSearchService,atsUrlLinkRouter,$timeout,LOG_LOCATION,atsContext,atsEventLogger,externalRouting,$window,atsUsMarket){var ctrl=this;var searchService=flSearchService.getService("freelancerSearch");var preventingDoubleEvent=false;ctrl.loadingWatcher=new eoBlockWatcher;ctrl.keywords="";ctrl.pageOffset=0;ctrl.totalItems=null;ctrl.highlighting=false;ctrl.profiles=[];ctrl.logLocation=LOG_LOCATION;ctrl.subLocation=atsContext.isAppApplicants()?"suggested":"search_results";ctrl.originTotal=null;ctrl.isUsToUsEnabled=atsUsMarket.isEnabled();ctrl.isRecommendReasonsOnSearchEnabled=applet.getVar("isRecommendReasonsOnSearchEnabled");ctrl.noResultsImageSrc=applet.buildInternalAssetPath("@OdeskAtsBundle/images/no-results/no-results.svg");var buildSharedData=function(profiles){var sharedData={};ng.forEach(profiles,function(freelancer,index){sharedData[freelancer.ciphertext]={recommendReasonsLinkClicked:function($event){ctrl.openDetails({freelancer:freelancer,isMetaKeyPressed:isEventMetaKey($event),options:{isRecommendedReasons:true,logData:ctrl.getLogData(freelancer,index)}});$event.stopPropagation()},bucket:"suggested"}});return sharedData};ctrl.facetSearchSmfLoaded=function(){searchService.getEventBus().publish("ui:filters:open")};$scope.$on("profile-search:run-search-by-query-params",function(event,searchParams){searchProfiles(true,1,searchParams)});var filtersChangedUnwatch=searchService.getEventBus().listen("filters:changed",facetValuesChangedCallback);freelancerTileSwitcherService.registerObserverCallback(modeChanged);ctrl.searchFacetCallback=function(){return searchProfiles(true,1)};ctrl.$onInit=function(){ctrl.mode=freelancerTileSwitcherService.getMode();ctrl.isCompact=getIsCompact(ctrl.mode);ctrl.facetsValues=searchService.getFacetValues()||{};ctrl.currentPage=parseInt(ctrl.startPage,10);searchProfiles(true,ctrl.currentPage)};ctrl.$onDestroy=function(){freelancerTileSwitcherService.deleteObserverCallback(modeChanged);filtersChangedUnwatch()};ctrl.tileClicked=function(freelancer,$event,source,params,isTileCallback){if(preventingDoubleEvent){return}if(!preventingDoubleEvent){preventingDoubleEvent=true;$timeout(function(){preventingDoubleEvent=false},300)}var isMetaKey=isEventMetaKey($event);if(source==="skill"){if(isMetaKey&&ng.isDefined(params)){if(params.skillUrl){$window.open(params.skillUrl)}}else{if(params.skillName){searchProfiles(true,1,{q:"skills:"+params.skillName})}}return false}if(!isTileCallback&&!isTileClickedDirectly($event)){return false}if(freelancer.isAgencyContractor&&["name","avatar","skills-more","tile_agency_member"].indexOf(source)===-1){$window.open(externalRouting.getAgencyProfileUrl(freelancer.agency.ciphertext))}else{ctrl.openDetails({freelancer:freelancer,isMetaKeyPressed:isMetaKey,options:{logData:ctrl.getLogData(freelancer,ctrl.profiles.indexOf(freelancer))}})}};ctrl.getRecordIndex=function(index){return ctrl.pageOffset+index+1};ctrl.getDetailsUrl=function(freelancer){if(freelancer.isAgencyContractor){return externalRouting.getAgencyProfileUrl(freelancer.agency.ciphertext)}return atsUrlLinkRouter.getSearchFreelancerDetailsUrl(freelancer)};ctrl.handlePageChanged=function(data){searchProfiles(true,ctrl.currentPage);var subLocation=[atsContext.isAppApplicants()?"ats":"search","navigation_bottom",data.actionType].join("_");var logData={type:"query",query:ctrl.keywords,page:ctrl.currentPage,opening:ctrl.facetsValues["opening_uid"],facets:ctrl.facetsValues,selected_tab:"search_results",label:data.actionType==="page_number"?"page_number":data.actionType+"_page"};atsEventLogger.logPaginationEvent(subLocation,logData)};ctrl.getLogData=function(freelancer,index){var logData={type:"contractor",id:freelancer.ciphertext,position:ctrl.getRecordIndex(index),facets:ctrl.facetsValues,page:ctrl.currentPage};if(ctrl.isRecommendReasonsOnSearchEnabled&&freelancer.jobSummariesRids){logData.recommended_jobs_rids=freelancer.jobSummariesRids}if(atsContext.isAppApplicants()){ng.extend(logData,{opening:ctrl.openingUid,folder:"suggested",mode:ctrl.mode})}else{ng.extend(logData,{tile_type:"search",opening:ctrl.facetsValues["opening_uid"],nss100:freelancer.jobSuccessScore,encrypted_data_iv:freelancer.rankInfo.iv,encrypted_data:freelancer.rankInfo.d,contractor_type:freelancer.isAgencyContractor?"agency_member":"freelancer"})}return logData};ctrl.getFacetsLogData=function(){var logData={type:"query",query:ctrl.keywords,opening:ctrl.openingUid,facets:ctrl.facetsValues,page:ctrl.currentPage};if(atsContext.isAppApplicants()){logData.bucket="suggested"}return logData};ctrl.trackId=function(freelancer){return[freelancer.ciphertext].concat(freelancer.jobSummariesRids).join(":")};function searchProfiles(isProcess,pageNumber,queryParams){pageNumber=ng.isDefined(pageNumber)?pageNumber:ctrl.currentPage+1;var profilesLoadingPromise=ctrl.searchProfilesCallback({isProcess:isProcess,page:pageNumber,queryParams:queryParams});if(isProcess){ctrl.loadingWatcher.wait(profilesLoadingPromise)}return profilesLoadingPromise.then(function(response){var results=response&&response.results?response.results:{};var paging=results.paging?results.paging:{};if(isProcess&&results){if(paging){ctrl.currentPage=paging.page;ctrl.totalItems=paging.total;ctrl.pageOffset=paging.offset;ctrl.originTotal=paging.originTotal}ctrl.profiles=results.profiles;ctrl.highlighting=response.highlighting;ctrl.tileSharedData=buildSharedData(ctrl.profiles);atsEventLogger.logQueryImpression(ctrl.subLocation,results.facets);atsEventLogger.logProfileSearchFreelancerListImpression(ctrl.subLocation,results.profiles,results.facets,ctrl.mode);if(paging&&paging.page<paging.pagesTotal){$timeout(function(){searchProfiles(false)},300)}}return response})}function modeChanged(newMode){ctrl.mode=newMode;ctrl.isCompact=getIsCompact(newMode);atsEventLogger.logProfileSearchFreelancerListImpression(ctrl.subLocation,ctrl.profiles,ctrl.facetsValues,ctrl.mode)}function facetValuesChangedCallback(){ctrl.facetsValues=searchService.getFacetValues();ctrl.keywords=ctrl.facetsValues["q"]}function getIsCompact(mode){return mode==="compact"}function isTileClickedDirectly($event){var $target=$($event.target);var ignoreSelector=".btn, button, a, .pulse-dot";return!($target.is(ignoreSelector)||$target.closest(ignoreSelector).length>0)}function isEventMetaKey($event){return $event&&($event.ctrlKey||$event.metaKey||$event.which===2)}}})(angular,Applet);
(function(){"use strict";angular.module("ats.common").directive("itemsLimiter",ItemsLimiter);ItemsLimiter.$inject=["applet"];function ItemsLimiter(applet){return{restrict:"AE",scope:{items:"=",limit:"=",onClickMore:"&"},templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/items-limiter/items-limiter.html"),link:link};function link(scope,element,attrs){scope.step=attrs.step?parseInt(attrs.step):parseInt(scope.limit);scope.showMoreItems=function(){scope.limit=scope.limit+scope.step;scope.onClickMore({items:scope.items.length})};scope.countMoreItemsToShow=function(){return scope.items.length-parseInt(scope.limit)};scope.hasMoreItemsToShow=function(){return scope.countMoreItemsToShow()>0}}}})();
(function(ng){"use strict";var module=ng.module("ats.common");module.service("atsPoller",atsPoller);atsPoller.$inject=["$interval","$q","$window"];function atsPoller($interval,$q,$window){var intervalConfig={};var callbackPromises={};var $windowElement=ng.element($window);var isWindowFocused=true;$windowElement.on("blur",handleBlur);$windowElement.on("focus",handleFocus);return{newSmartInterval:newSmartInterval,cancel:cancel};function newSmartInterval(){if(!ng.isFunction(arguments[0])){throw new Error("1st argument (callback) must be a function")}if(!(arguments[1]>0)){throw new Error("2nd argument (delay) is required and must be a positive number")}var config={callback:arguments[0],delay:arguments[1]};if(arguments[2]){config.count=arguments[2]}if(arguments[3]){config.invokeApply=arguments[3]}return create(config)}function create(config){var defaultConfig={throttleOnBlur:true,throttleOnFail:true,throttleLevel:0,throttleLeft:0,invokeApply:true,count:0};if(!(config.delay>0)){throw new Error("config.delay is required and must be a positive number")}if(!ng.isFunction(config.callback)){throw new Error("config.callback must be a function")}config=ng.extend({},defaultConfig,config);config.originalCallback=config.callback;config.callback=getSmartCallback(config.originalCallback,config);config.promise=$interval(config.callback,config.delay,config.count,config.invokeApply);addIntervalConfig(config);return config.promise}function cancel(promise){delete intervalConfig[promise.$$intervalId];delete callbackPromises[promise.$$intervalId];$interval.cancel(promise)}function getSmartCallback(callback,config){return function(){var promise=getCallbackPromise(config);var isPending=promise&&promise.$$state.status<=0;var isResolved=promise&&promise.$$state.status===1;var isRejected=promise&&promise.$$state.status===2;if(config.throttleLeft>0){config.throttleLeft--;return false}if(isRejected&&config.throttleOnFail){throttle(config);return false}if(isPending){return false}if(!isWindowFocused&&config.throttleOnBlur){throttle(config)}if(isResolved&&isWindowFocused){resetThrottle(config)}var callbackResult=callback.apply(this,arguments);addCallbackPromise(callbackResult,config)}}function addIntervalConfig(config){intervalConfig[config.promise.$$intervalId]=config}function addCallbackPromise(promise,config){callbackPromises[config.promise.$$intervalId]=$q.when(promise)}function getCallbackPromise(config){return callbackPromises[config.promise.$$intervalId]}function throttle(config){config.throttleLeft=Math.pow(2,config.throttleLevel)-1;config.throttleLevel++;callbackPromises[config.promise.$$intervalId]=false}function resetThrottle(config){config.throttleLevel=0;config.throttleLeft=0}function resetAllThrottles(){ng.forEach(intervalConfig,function(config){resetThrottle(config)})}function handleBlur(){isWindowFocused=false}function handleFocus(){resetAllThrottles();isWindowFocused=true}}})(angular);
(function(ng){"use strict";var module=ng.module("ats.common");module.directive("preloadImages",preloadImages);preloadImages.$inject=["$log"];function preloadImages($log){return{link:function($scope,$element,$attrs){var originalDisplay=$element.css("display");function done(isApply){if($attrs.imagesLoaded){try{if(isApply){$scope.$apply($attrs.imagesLoaded)}else{$scope.$eval($attrs.imagesLoaded)}}catch(e){$log.error(e)}}$element.css("display",originalDisplay)}var srcs=$scope.$eval($attrs.preloadImages);if(!srcs){return done()}if(!Array.isArray(srcs)){srcs=[srcs]}$element.css("display","none");var fulfilled=0;srcs.forEach(function(src){var image=new Image;image.onload=image.onerror=function(){fulfilled+=1;if(fulfilled===srcs.length){return done(true)}};image.src=src})}}}})(angular);
(function(ng,applet){"use strict";var module=ng.module("ats.common");module.component("recommendReasonsLink",{templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/recommend-reasons-link/recommend-reasons-link.html"),controller:recommendReasonsLink,bindings:{count:"@",onClickCallback:"&"}});recommendReasonsLink.$inject=[];function recommendReasonsLink(){var ctrl=this;ctrl.onLinkClick=function($event){if(ng.isFunction(ctrl.onClickCallback)){ctrl.onClickCallback({$event:$event})}}}})(angular,Applet);
(function(ng){"use strict";var module=ng.module("ats.common");module.directive("savedFreelancerNotes",savedFreelancerNotes);savedFreelancerNotes.$inject=["applet","favoritesService"];function savedFreelancerNotes(applet,favorites){return{link:link,templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/saved-freelancer-notes/saved-freelancer-notes.html"),scope:{freelancerUid:"<",userTitle:"<",userName:"<",userProfileUrl:"<",userAvatarUrl:"<"}};function link($scope){$scope.popoverTemplateUrl=applet.buildInternalAssetPath("@OdeskSaveFreelancerBundle/js/save-freelancer/popover.html");favorites.list.then(function(favoritesList){$scope.favorite=favoritesList.data[$scope.freelancerUid]});$scope.noteClick=function($event){$event.preventDefault();$event.stopPropagation()}}}})(angular);
(function(ng){"use strict";var module=ng.module("ats.common");module.directive("scrollToIf",ScrollToIf);ScrollToIf.$inject=["$timeout"];function ScrollToIf($timeout){return{restrict:"A",link:link};function link($scope,$element,$attrs){$scope.$watch($attrs.scrollToIf,function(shouldScroll){if(shouldScroll){$timeout(function(){var $elementToScroll=ng.isDefined($attrs.selectorToScroll)?ng.element($attrs.selectorToScroll):ng.element("body");$elementToScroll.animate({scrollTop:ng.element($element).position().top})},700)}})}}})(angular);
(function(ng){"use strict";ng.module("ats.common").directive("scrollToTop",scrollToTopDirective);scrollToTopDirective.$inject=["$window","scrollToTopService"];function scrollToTopDirective($window,scrollToTopService){return{restrict:"A",scope:{scrollToTop:"<"},link:function(scope,element){scope.$watch("scrollToTop",function(newValue,oldValue){if(newValue!==oldValue){if(ng.element($window).scrollTop()>ng.element("body").height()){scrollToTopService.scroll(500,element.offset().top)}}})}}}})(angular);
(function(ng){"use strict";ng.module("ats.common").service("scrollToTopService",ScrollToTopService);ScrollToTopService.$inject=["$window"];function ScrollToTopService($window){var scrollToTopService={scroll:scroll};return scrollToTopService;function scroll(scrollDuration,topLimit){topLimit=topLimit||0;var scrollLeft=$window.pageXOffset;if(!$window.requestAnimationFrame){$window.scrollTo(scrollLeft,0);return}scrollDuration=scrollDuration||500;scrollAnimated(scrollDuration,scrollLeft,topLimit)}function animationStep(scrollLeft,scrollDuration,topLimit){var scrollTop=$window.pageYOffset;if(scrollTop<=topLimit){return}var newStepScrollTop=getNewStepScrollTop(scrollTop,scrollDuration);$window.scrollTo(scrollLeft,newStepScrollTop);$window.requestAnimationFrame(animationStep.bind(null,scrollLeft,scrollDuration,topLimit))}function getNewStepScrollTop(scrollTop,scrollDuration){var easingCoefficient=60;var scrollStep=scrollTop*easingCoefficient/scrollDuration;return scrollTop-scrollStep}function scrollAnimated(scrollDuration,scrollLeft,topLimit){$window.requestAnimationFrame(animationStep.bind(null,scrollLeft,scrollDuration,topLimit))}}})(angular);
(function(ng,timing){"use strict";var module=ng.module("ats.stats.clientMetrics",["ats.stats.clientSegmentation","components.core.metrics"]);module.service("clientMetricsService",ClientMetricsService);ClientMetricsService.$inject=["applet","eoMetricsService","clientSegmentationService"];function ClientMetricsService(applet,eoMetricsService,clientSegmentationService){var samplingRate=1;var metricsPrefix=applet.getVar("clientMetricsPrefix");var userBrowser=clientSegmentationService.getUserBrowser();var userOs=clientSegmentationService.getUserOs();return{pushMetric:pushMetric};function pushMetric(name,value,noSegmenation){var metricParts=[metricsPrefix,name];if(!noSegmenation){metricParts.push(userOs,userBrowser)}if(value>0){eoMetricsService.addMetric(metricParts.join(".")+":"+value+"|ms",samplingRate)}}}})(angular,timing);
(function(ng){"use strict";var module=ng.module("ats.stats.clientSegmentation",[]);module.service("clientSegmentationService",ClientSegmentationService);ClientSegmentationService.$inject=["$window"];function ClientSegmentationService($window){return{getUserBrowser:getUserBrowser,getUserOs:getUserOs};function getUserBrowser(){var rules={firefox:typeof InstallTrigger!=="undefined",safari:Object.prototype.toString.call($window.HTMLElement).indexOf("Constructor")>0,ie:false||!!$window.document.documentMode,chrome:!!$window.chrome&&!!$window.chrome.webstore};return detect(rules)}function getUserOs(){var rules={andoid:$window.navigator.userAgent.toLowerCase().indexOf("android")>-1,ios:$window.navigator.userAgent.match(/(iPad|iPhone|iPod)/gi),windows:$window.navigator.platform.toLowerCase().indexOf("win")>-1,osx:$window.navigator.platform.toLowerCase().indexOf("mac")>-1};return detect(rules)}function detect(rules){var detected="other";ng.forEach(rules,function(rule,name){if(rule){detected=name}});return detected}}})(angular);
(function(ng,timing){"use strict";var module=ng.module("ats.stats.clientTiming",["ats.stats.clientMetrics"]);module.run(ModuleRun);module.service("clientTimingService",ClientTimingService);ModuleRun.$inject=["clientMetricsService","clientTimingService","$window","$timeout"];function ModuleRun(clientMetricsService,clientTimingService,$window,$timeout){var prefix="pageLoad.";ng.element($window).bind("load",onLoad);clientMetricsService.pushMetric(prefix+"angularRun",clientTimingService.getTimeFromStart());function onLoad(){$timeout(function(){var timingJsTimes=timing.getTimes({simple:false});var timingJsMetricNames=["loadTime","firstPaintTime","requestTime","initDomTreeTime","domReadyTime"];ng.forEach(timingJsMetricNames,function(metricName){var value=parseInt(timingJsTimes[metricName],10);clientMetricsService.pushMetric(prefix+metricName,value)})})}}ClientTimingService.$inject=[];function ClientTimingService(){return{getTimeFromStart:getTimeFromStart};function getTimeFromStart(){return Date.now()-timing.getTimes().fetchStart}}})(angular,timing);
(function(ng){"use strict";var module=ng.module("ats.stats.firstLoad",["components.core.metrics"]);module.directive("statFirstLoad",FirstLoad);var logged={};FirstLoad.$inject=["clientMetricsService","clientTimingService"];function FirstLoad(clientMetricsService,clientTimingService){return{link:link,scope:false};function link($scope,$element,$attrs){var prefix="firstLoad.";var name=$attrs.statFirstLoad;if(!logged[name]){logged[name]=true;clientMetricsService.pushMetric(prefix+name,clientTimingService.getTimeFromStart())}}}})(angular);
(function(ng){"use strict";var module=ng.module("ats.stats",["ats.stats.clientMetrics"]);module.directive("atsStatNgRepeat",atsStatNgRepeat);atsStatNgRepeat.$inject=["clientMetricsService","$timeout"];function atsStatNgRepeat(clientMetricsService,$timeout){var timers={};return{link:link};function link($scope,$element,$attrs){var ngRepeatId=$attrs.atsStatNgRepeat;var metricName="tilesRender."+ngRepeatId;if($scope.$first){timers[ngRepeatId]=Date.now()}if($scope.$last){$timeout(function(){var renderTime=Date.now()-timers[ngRepeatId];clientMetricsService.pushMetric(metricName,renderTime)})}}}})(angular);
(function(ng){"use strict";var module=ng.module("ats.common");module.directive("tileBottomSlot",tileMiddleSlot);tileMiddleSlot.$inject=["applet"];function tileMiddleSlot(applet){return{scope:{freelancer:"<",tileSharedData:"<"},link:link,templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/tile-bottom-slot/tile-bottom-slot.html")};function link($scope){$scope.recommendReasonsLinkClicked=$scope.tileSharedData.recommendReasonsLinkClicked;$scope.isRecommendReasonsOnSearchEnabled=applet.getVar("isRecommendReasonsOnSearchEnabled")}}})(angular);
(function(ng){"use strict";var module=ng.module("ats.common");module.directive("tileDescription",TileDescription);TileDescription.$inject=["eoTruncateHelper","applet"];function TileDescription(eoTruncateHelper,applet){var QA_SEPARATOR_LENGTH=3;return{link:link,scope:{questions:"=",coverLetter:"=",truncateToChars:"=",milestonesCount:"<?"},templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/tile-description/tile-description.html")};function link($scope){var maxLength=parseInt($scope.truncateToChars,10);var coverLetterLength=$scope.coverLetter?$scope.coverLetter.length:0;var questionsLength=getQuestionsLength($scope.questions);var truncateQuestionsTo=maxLength-Math.min(coverLetterLength,maxLength/2);var truncateCoverLetterTo=maxLength-Math.min(truncateQuestionsTo,questionsLength);$scope.milestoneEllipsis=!coverLetterLength&&!questionsLength||!coverLetterLength&&questionsLength>truncateQuestionsTo||coverLetterLength>truncateCoverLetterTo?"":"... ";$scope.truncatedQuestions=getTruncatedQuestions($scope.questions,truncateQuestionsTo);$scope.truncatedCoverLetter=eoTruncateHelper.truncateByChars($scope.coverLetter?$scope.coverLetter:"",truncateCoverLetterTo)}function getQuestionsLength(questions){var length=0;ng.forEach(questions,function(screeningQuestion){length+=screeningQuestion.question.length+QA_SEPARATOR_LENGTH;length+=screeningQuestion.answer.length});return length}function getTruncatedQuestions(questions,truncateTo){var truncated={};var charsLeft=truncateTo;ng.forEach(questions,function(screeningQuestion){if(charsLeft<=0){return}var question=screeningQuestion.question;var answer=screeningQuestion.answer;if(question.length>charsLeft){question=eoTruncateHelper.truncateByChars(question,charsLeft);charsLeft=0;truncated[question]="";return}else{charsLeft-=question.length}if(answer.length>charsLeft){answer=eoTruncateHelper.truncateByChars(answer,charsLeft);charsLeft=0}else{charsLeft-=answer.length}truncated[question]=answer});return truncated}}})(angular);
(function(ng){"use strict";var module=ng.module("ats.common");module.directive("atsTilePlaceholders",TilePlaceholders);TilePlaceholders.$inject=["applet"];function TilePlaceholders(applet){return{templateUrl:applet.buildInternalAssetPath("@OdeskAtsBundle/js/common/tile-placeholders/tile-placeholders.html"),link:link,scope:{atsTilePlaceholders:"=",forceViewMode:"@?"}};function link($scope){$scope.placeholders=generatePlaceholders($scope.atsTilePlaceholders);$scope.$watch("atsTilePlaceholders",function(newValue,oldValue){if(newValue!==oldValue){$scope.placeholders=generatePlaceholders(newValue)}});function generatePlaceholders(count){if(count>0){return new Array(Math.min(10,count))}else{return[]}}}}})(angular);
(function(ng){"use strict";ng.module("ats.services",["components.core.log","components.core.storage","components.core.utils","freelancer.search.facet"]).constant("ATS_APPLICANTS_BASE_URL","").constant("ATS_APP_KEY","").constant("LOG_LOCATION","")})(angular);
(function(ng){"use strict";ng.module("ats.services").service("atsApiPreloader",atsApiPreloader);atsApiPreloader.$inject=["$httpParamSerializer","$window","$q"];function atsApiPreloader($httpParamSerializer,$window,$q){var apiPreloader=$window.atsApiPreLoader;var isPreloader=ng.isDefined(apiPreloader)&&ng.isFunction(apiPreloader.getPromise);var requestStats={};this.getPromise=function(url,fallbackFn,isRestService){if(ng.isUndefined(requestStats[url])){requestStats[url]=0}requestStats[url]++;if(isPreloader){return apiPreloader.getPromise(url,$q).then(function(xhrResponse){var response={data:{},code:xhrResponse.status};try{response.data=ng.fromJson(xhrResponse.responseAsString);if(ng.isUndefined(response.data)){return fallbackFn()}}catch(e){return fallbackFn()}return isRestService?response.data:response},function(){return fallbackFn()})}return fallbackFn()};this.getPromiseFirstValidOnly=function(url,fallbackFn,isRestService){if(!this.isFirstRequest(url)){return fallbackFn()}return this.getPromise(url,fallbackFn,isRestService)};this.isFirstRequest=function(url){return this.hasConfig(url)&&(ng.isUndefined(requestStats[url])||requestStats[url]===0)};this.hasConfig=function(url){return isPreloader&&apiPreloader.hasConfig(url)};this.buildUrl=function(url,params){var queryString=$httpParamSerializer(params);if(queryString){queryString=(url.indexOf("?")===-1?"?":"&")+queryString}return url+queryString}}})(angular);
(function(ng){"use strict";ng.module("ats.services").service("atsContext",atsContext);atsContext.$inject=["ATS_APP_KEY"];function atsContext(ATS_APP_KEY){var context={openingUid:null,isMultipleImpressionLogged:false};this.appKeys={applicants:"applicants",profileSearch:"profile_search"};this.isAppApplicants=function(){return this.appKeys.applicants===ATS_APP_KEY};this.isAppProfileSearch=function(){return this.appKeys.profileSearch===ATS_APP_KEY};this.getAppId=function(){return ATS_APP_KEY};this.setOpeningUid=function(openingUid){context.openingUid=openingUid};this.getOpeningUid=function(){return context.openingUid};this.getContext=function(){return context};this.isMultipleImpressionLogged=function(){return context.isMultipleImpressionLogged};this.setMultipleImpressionLoggedStatus=function(status){context.isMultipleImpressionLogged=status}}})(angular);
(function(ng,applet){"use strict";ng.module("ats.services").service("atsEventLogger",atsEventLogger);atsEventLogger.$inject=["$location","LOG_LOCATION","$q","atsContext","logEventService"];function atsEventLogger($location,LOG_LOCATION,$q,atsContext,logEventService){this.logPaginationEvent=function(sublocation,logData){return logEventService.logEvent("click",LOG_LOCATION,sublocation,[logData])};this.logFreelancerListImpression=function(openingUid,folder,freelancers,page,mode){if(freelancers&&freelancers.length>0){return logEventService.logEvent("impression",LOG_LOCATION,folder,prepareFreelancersLoggingData(openingUid,folder,freelancers,page,mode))}return $q.reject({})};function prepareFreelancersLoggingData(openingUid,folder,freelancers,page,mode){var eventData=[];ng.forEach(freelancers,function(freelancer){eventData.push({label:"tile",type:"contractor",id:freelancer.profileRid,opening:openingUid,position:freelancers.indexOf(freelancer)+1,folder:folder,mode:mode,page:page})});return eventData}this.logProfileSearchFreelancerListImpression=function(subLocation,freelancers,facets,mode){if(!atsContext.isMultipleImpressionLogged()){atsContext.setMultipleImpressionLoggedStatus(true);if(facets["opening_uid"]||atsContext.getOpeningUid()){return this.logProfileSearchFreelancerListMultipleImpressions(subLocation,freelancers,facets,mode)}}if(freelancers&&freelancers.length>0){return logEventService.logEvent("impression",LOG_LOCATION,subLocation,prepareProfileSearchLoggingData(freelancers,facets,mode))}return $q.reject({})};this.logProfileSearchFreelancerListMultipleImpressions=function(sublocation,freelancers,facets,mode){var eventData=[{sublocation:sublocation,data:[{type:"opening",id:facets["opening_uid"]||atsContext.getOpeningUid(),after_jp:!!(applet.getVar("trackingOpeningRef")||applet.getVar("isRedirectAfterJobPost"))}]}];if(freelancers&&freelancers.length>0){eventData.push({sublocation:sublocation,data:prepareProfileSearchLoggingData(freelancers,facets,mode)})}return logEventService.logEvent("impression",LOG_LOCATION,"__multiple__",eventData)};function prepareProfileSearchLoggingData(freelancers,facets,mode){var eventData=[];ng.forEach(freelancers,function(freelancer){var logInfo={label:"tile",type:"contractor",id:freelancer.ciphertext,query:facets["q"],opening:facets["opening_uid"]||atsContext.getOpeningUid(),facets:facets,after_jp:!!(applet.getVar("trackingOpeningRef")||applet.getVar("isRedirectAfterJobPost")),nss_score:freelancer.jobSuccessScore,position:freelancers.indexOf(freelancer)+1,tile_type:"search_results",contractor_type:freelancer.isAgencyContractor?"agency_member":"freelancer",encrypted_data_iv:freelancer.rankInfo.iv,encrypted_data:freelancer.rankInfo.d,mode:mode};if(applet.getVar("isRecommendReasonsOnSearchEnabled")&&freelancer.jobSummariesRids){logInfo.recommended_jobs_rids=freelancer.jobSummariesRids}eventData.push(logInfo)});return eventData}this.logQueryImpression=function(sublocation,facets){var logData=[{type:"query",previous_params:$location.url(),facets:facets,after_jp:!!(applet.getVar("trackingOpeningRef")||applet.getVar("isRedirectAfterJobPost"))}];return logEventService.logMasterEvent("impression",LOG_LOCATION,sublocation,logData)};this.logApplicantsQueryImpression=function(sublocation,facets,sort){var logData=[{type:"query",previous_params:$location.url(),facets:facets,sort:sort}];return logEventService.logMasterEvent("impression",LOG_LOCATION,sublocation,logData)}}})(angular,Applet);
(function(ng){"use strict";ng.module("ats.services").service("atsSearchParamsStorage",atsSearchParamsStorage);atsSearchParamsStorage.$inject=["eoStorage"];function atsSearchParamsStorage(eoStorage){var storageObject=null;this.setParams=function(paramName,queryParams){getStorageObject().put(paramName,queryParams)};this.getParams=function(paramName){return getStorageObject().get(paramName)};this.hasParams=function(paramName){var params=this.getParams(paramName);return ng.isDefined(params)&&(!ng.isObject(params)||ng.isObject(params)&&Object.keys(params).length>0)};function getStorageObject(){if(storageObject===null){storageObject=new Storage}return storageObject}function Storage(){var storage=eoStorage.getItemForSession("profileSearch");if(storage===null||ng.isUndefined(storage)){storage={}}return{put:function(name,values){storage[name]=values;eoStorage.setItemForSession("profileSearch",storage)},get:function(name){return storage[name]}}}}})(angular);
(function(ng){"use strict";var module=ng.module("ats.services");module.service("atsUrl",atsUrl);module.value("ATS_URL_SERVICE_NAMES",{proposal:"proposal",search:"search"});atsUrl.$inject=["$location","ATS_URL_SERVICE_NAMES"];function atsUrl($location,ATS_URL_SERVICE_NAMES){var services={};return{registerSearchService:function(routerNames){return registerService(ATS_URL_SERVICE_NAMES.search,routerNames)},registerProposalService:function(routerNames){return registerService(ATS_URL_SERVICE_NAMES.proposal,routerNames)},getSearchService:function(){return getService(ATS_URL_SERVICE_NAMES.search)},getProposalService:function(){return getService(ATS_URL_SERVICE_NAMES.proposal)}};function registerService(serviceName,routerNames){services[serviceName]=new QueryService(routerNames);return services[serviceName]}function getService(serviceName){if(ng.isUndefined(services[serviceName])){throw"Service name ["+serviceName+"] not registered."}return services[serviceName]}function QueryService(matchedRoutes){var initQueryParams={};var queryParams={};var queryParamsService=this;this.setInitParams=function(params){initQueryParams=params};this.getInitParams=function(){return initQueryParams};this.setParams=function(params){queryParams=params};this.getParams=function(){return queryParams};this.restoreQueryParams=function(isReplace){if(!ng.equals($location.search(),queryParams)){$location.search(queryParams);if(isReplace){$location.replace()}}};this.getPageNumber=function(){return ng.isDefined(queryParams["page"])?queryParams["page"]:1};this.onStateChangeStartHandler=function(event,toState,toParams,fromState){if(fromState&&toState&&fromState.name===""&&isRouteMatched(toState.name)){if(Object.keys(initQueryParams).length===0){initQueryParams=$location.search()}queryParams=initQueryParams}};this.onStateChangeSuccessHandler=function(event,toState,toParams,fromState){if(fromState&&toState&&fromState.name!==""&&isRouteMatched(toState.name)){queryParamsService.restoreQueryParams(true)}};function isRouteMatched(routeName){return matchedRoutes.indexOf(routeName)!==-1}}}})(angular);
(function(ng){"use strict";ng.module("ats.services").service("atsUsMarket",atsUsMarket);atsUsMarket.$inject=["applet","ATS_US_MARKET_PREFERENCE_TYPES","usPreferenceService"];function atsUsMarket(applet,ATS_US_MARKET_PREFERENCE_TYPES,usPreferenceService){var service=this;var usMarket=applet.getVar("usMarket")||{};var userPreferenceType=ng.isDefined(usMarket.preferenceType)?getValidatedPreferenceType(usMarket.preferenceType):null;var lastSavedPreferenceType=userPreferenceType;service.isEnabled=function(){return Boolean(usMarket.isEnabled)};service.isModalEnabled=function(){return Boolean(usMarket.isModalEnabled)};service.userHasPreferenceType=function(){return userPreferenceType!==null};service.getUserPreferenceType=function(){return userPreferenceType};service.getUserPreferenceTypeAsString=function(){var result="";if(service.getUserPreferenceType()){result+=service.getUserPreferenceType()}return result};service.setUserPreferenceType=function(preferenceType){userPreferenceType=getValidatedPreferenceType(preferenceType)};service.storeUserPreferenceType=function(preferenceType){var validatedValue=getValidatedPreferenceType(preferenceType);if(lastSavedPreferenceType!==validatedValue){lastSavedPreferenceType=validatedValue;usPreferenceService.updateUserPreference(validatedValue)}};service.userPreferenceIsUsOnly=function(){return userPreferenceType===ATS_US_MARKET_PREFERENCE_TYPES.usOnly};service.userPreferenceIsWorld=function(){return userPreferenceType===ATS_US_MARKET_PREFERENCE_TYPES.world};service.isUsOnlyValue=function(value){return getValidatedPreferenceType(value)===ATS_US_MARKET_PREFERENCE_TYPES.usOnly};function getValidatedPreferenceType(value){if(ng.isString(value)&&value.length>0){return parseInt(value,10)}return value}}})(angular);
(function(ng){"use strict";ng.module("ats.services").service("customSmf",customSmf);customSmf.$inject=["oSmfServices","eoModelFactory","$q","SMF_CONFIG"];function customSmf(oSmfServices,eoModelFactory,$q,SMF_CONFIG){var smf=this;var deferMessages=$q.defer();smf.messages={};smf.countDisplayed={};smf.dismiss=function(customSelector){oSmfServices.dismiss({id:smf.messages[customSelector].id});smf.messages[customSelector]=null};smf.updateShowCount=function(customSelector){if(ng.isUndefined(smf.countDisplayed[customSelector])){smf.countDisplayed[customSelector]=0}return smf.countDisplayed[customSelector]++};smf.getMessageAsPromise=function(customSmfSelector){return smf.getMessagesPromise().then(function(messages){if(ng.isObject(messages[customSmfSelector])){return messages[customSmfSelector]}})};smf.getMessagesPromise=function(){return deferMessages.promise};loadSmfMessages();function loadSmfMessages(){oSmfServices.retrieve({group:SMF_CONFIG.group,page:SMF_CONFIG.page,module:"*",location:"custom"}).$promise.then(function(data){ng.forEach(data,function(value){var message=eoModelFactory.get("Message",value);message.customSelector=value.custom_selector;if(ng.isDefined(message.customSelector)&&message.customSelector!==""){smf.messages[message.customSelector]=message}});deferMessages.resolve(smf.messages)},function(response){deferMessages.reject(response)})}}})(angular);
(function(angular){"use strict";angular.module("ats.services").service("errorHandler",errorHandler);errorHandler.$inject=["$window","$state"];function errorHandler($window,$state){this.crash=function(reason){$state.go("error",{reason:reason})};this.handleUnauthorized=function(){var location=$window.location;if(location.search.indexOf("attempt=1")>-1){this.crash("access-denied")}else{var endUrl=location.pathname+location.search+(location.search.indexOf("?")===-1?"?":location.search.length>1?"&":"")+"attempt=1";$window.location.href="/login?redir="+encodeURIComponent(endUrl)}}}})(angular);
(function(ng){"use strict";ng.module("ats.services").service("externalRouting",externalRouting);externalRouting.$inject=["applet","ATS_APPLICANTS_BASE_URL"];function externalRouting(applet,ATS_APPLICANTS_BASE_URL){return{getApplicantNewOfferUrl:getApplicantNewOfferUrl,getFreelancerNewOfferUrl:getFreelancerNewOfferUrl,getViewOfferUrl:getViewOfferUrl,getViewContractUrl:getViewContractUrl,getFreelancerProfileUrl:getFreelancerProfileUrl,getAgencyProfileUrl:getAgencyProfileUrl,getEditJobUrl:getEditJobUrl};function getApplicantNewOfferUrl(openingUid,applicationUid){return getBaseOffersUrl()+"?application_uid="+applicationUid+"&job_uid="+openingUid}function getFreelancerNewOfferUrl(teamRid,profileRid,previousAssignmentRid,jobUid){var teamParam=!teamRid?"show-team-selection=yes":"team="+teamRid;return getBaseOffersUrl()+"?"+teamParam+"&contractor="+profileRid+(previousAssignmentRid?"&assigment="+previousAssignmentRid:"")+(jobUid?"&job_uid="+jobUid:"")}function getBaseOffersUrl(){return"/e/"+applet.getOrganization().getRid()+"/offers/v2/new/"}function getViewOfferUrl(openingUid,applicationUid,offerRid){if(offerRid){return"/offer/"+offerRid}return[ATS_APPLICANTS_BASE_URL,"route",openingUid,applicationUid,"offer/view"].join("/")}function getViewContractUrl(openingUid,applicationUid,offerRid){if(offerRid){return[ATS_APPLICANTS_BASE_URL,"route",offerRid,"contract/view"].join("/")}else if(openingUid&&applicationUid){return[ATS_APPLICANTS_BASE_URL,"route",openingUid,applicationUid,"contract/view"].join("/")}}function getFreelancerProfileUrl(ciphertext){return"/freelancers/"+ciphertext}function getAgencyProfileUrl(ciphertext){return"/companies/"+ciphertext}function getEditJobUrl(openingUid){return[ATS_APPLICANTS_BASE_URL,"route",openingUid,"jobs/edit"].join("/")}}})(angular);
(function(ng){"use strict";ng.module("ats.services").service("freelancerList",freelancerListService);freelancerListService.$inject=["$http","eoModelFactory","atsFreelancerTileProfile","ATS_API_BASE_URL","atsApiPreloader"];function freelancerListService($http,eoModelFactory,atsFreelancerTileProfile,ATS_API_BASE_URL,atsApiPreloader){this.getFreelancerList=function(endpointName,params){var endpointUrl=ATS_API_BASE_URL+"/api/freelancer-list/"+endpointName;var endpointGetUrl=atsApiPreloader.buildUrl(endpointUrl,params);var isPastHires=endpointName==="past-hires";return atsApiPreloader.getPromiseFirstValidOnly(endpointGetUrl,function(){return $http.get(endpointUrl,{params:params,cache:isPastHires})},false).then(function(response){var transformers=[atsFreelancerTileProfile.getFreelancerTileProfile];if(isPastHires){transformers.push(extendFreelancerWithContract)}return atsFreelancerTileProfile.getTransformedProfilesResponse(response.data,transformers)})};this.getFreelancerListCounts=function(endpointName){var endpointUrl=ATS_API_BASE_URL+"/api/freelancer-list/"+endpointName+"/count";var isPastHires=endpointName==="past-hires";return $http.get(endpointUrl,{cache:isPastHires}).then(function(response){return response.data})};function extendFreelancerWithContract(freelancer,initialProfile){if(ng.isDefined(initialProfile.latestContract)){freelancer.latestContract=eoModelFactory.get("FreelancerTileContract",initialProfile.latestContract)}return freelancer}}})(angular);
(function(ng){ng.module("ats.services").service("atsFreelancerTileProfile",atsFreelancerTileProfile);atsFreelancerTileProfile.$inject=["eoModelFactory","externalRouting"];function atsFreelancerTileProfile(eoModelFactory,externalRouting){return{getFreelancerTileProfile:getFreelancerTileProfile,getTransformedProfilesResponse:getTransformedProfilesResponse};function getTransformedProfilesResponse(response,resultTransformers){var freelancerTileProfiles=[];if(response&&response.results&&response.results.profiles){ng.forEach(response.results.profiles,function(profile){var initialProfile=profile;ng.forEach(resultTransformers,function(transformer){profile=transformer(profile,initialProfile)});freelancerTileProfiles.push(profile)});response.results.profiles=freelancerTileProfiles}return response}function getFreelancerTileProfile(profile){var freelancerTileProfile=eoModelFactory.get("FreelancerTileProfile",{profileUid:profile.uid,profileRid:profile.recno,profileUrl:externalRouting.getFreelancerProfileUrl(profile.ciphertext),ciphertext:profile.ciphertext,shortName:profile.shortName,title:profile.title,description:profile.description,shortNameSanitized:profile.shortNameSanitized,titleSanitized:profile.titleSanitized,descriptionSanitized:profile.descriptionSanitized,portrait:profile.portrait,isInvited:ng.isDefined(profile.isInvited)?profile.isInvited:false,isAgencyContractor:ng.isArray(profile.extendedAgencies)&&profile.extendedAgencies.length>0,location:profile.location,totalPassedTests:profile.totalPassedTests,totalPortfolioItems:profile.totalPortfolioItems,topRatedStatus:profile.topRatedStatus,jobSuccessScore:profile.nss100,hideJss:profile.hideJss,totalHours:profile.totalHoursBilled,combinedRevenue:profile.combinedTotalRevenue,combinedEarnings:profile.combinedTotalEarnings,hideEarnings:profile.hideEarnings,hourlyJobs:profile.totalHourlyJobs,fpJobs:profile.totalFpJobs,hourlyRate:profile.hourlyRate,rankInfo:profile.rankInfo,skills:profile.skills,agency:null,groups:profile.groups,clouds:profile.clouds,jobSummariesRids:profile.jobSummariesRids,combinedAverageRecentEarnings:profile.combinedAverageRecentEarnings,combinedRecentEarnings:profile.combinedRecentEarnings});if(freelancerTileProfile.isAgencyContractor){var agency=profile.extendedAgencies[0];var freelancerTileAgency=eoModelFactory.get("FreelancerTileAgency",{ciphertext:agency.ciphertext,name:agency.name,summary:agency.summary,profileUrl:externalRouting.getAgencyProfileUrl(agency.ciphertext),description:agency.description,nameSanitized:agency.nameSanitized,summarySanitized:agency.summarySanitized,descriptionSanitized:agency.descriptionSanitized,portrait:agency.logo,location:null,totalHours:agency.totalHours,hourlyJobs:null,fpJobs:null,topRatedStatus:agency.agencyTopRatedStatus,jobSuccessScore:agency.nss100bw,minRate:agency.minRate,maxRate:agency.maxRate});freelancerTileProfile.agency=freelancerTileAgency}return freelancerTileProfile}}})(angular);
(function(ng){"use strict";ng.module("ats.services").service("permissions",permissions);permissions.$inject=["applet"];function permissions(applet){var userPermissions=applet.getVar("permissions")||[];this.canHire=function(){return userPermissions.indexOf("IsBuyerManager")>-1};this.canInvite=function(){return userPermissions.indexOf("IsRecruiter")>-1};this.canSave=function(){return userPermissions.indexOf("IsRecruiter")>-1}}})(angular);
(function(ng){"use strict";ng.module("ats.services").service("rest",Rest);Rest.$inject=["$http","$q","$httpParamSerializerJQLike","$httpParamSerializer","ATS_API_BASE_URL"];function Rest($http,$q,$httpParamSerializerJQLike,$httpParamSerializer,ATS_API_BASE_URL){this.getApiEndpointUrl=function(relativeUrl){return ATS_API_BASE_URL+(relativeUrl[0]!=="/"?"/":"")+relativeUrl};this.request=function(config){var deferred=$q.defer();if(config.method!=="GET"&&config.doNotRetry!==false){config.doNotRetry=true}$http(config).then(function(response){deferred.resolve(response.data)},function(response){deferred.reject(response)});return deferred.promise};this.get=function(url,config){var config=ng.extend({method:"GET",url:url},config);return this.request(config)};this.post=function(url,config){return this.dataRequest("POST",url,config)};this.put=function(url,config){return this.dataRequest("PUT",url,config)};this.delete=function(url,config){return this.dataRequest("DELETE",url,config)};this.dataRequest=function(method,url,config){if(ng.isUndefined(config)){config={}}var httpConfig=ng.extend({method:method,url:url,transformRequest:function(data){return $httpParamSerializerJQLike(data)}},config,{headers:ng.extend({"Content-Type":"application/x-www-form-urlencoded"},ng.isDefined(config.headers)?config.headers:{})});return this.request(httpConfig)};this.buildUrl=function(url,params){var queryString=$httpParamSerializer(params);if(queryString){url+=(url.indexOf("?")===-1?"?":"&")+queryString}return url}}})(angular);
(function(ng){"use strict";ng.module("ats.services").service("string",StringService);StringService.$inject=[];function StringService(){this.startsWith=function(haystack,needle){if(ng.isString(haystack)&&ng.isString(needle)){return haystack.lastIndexOf(needle,0)===0}else{throw new TypeError("Both parameters must be strings")}};this.getMessagePlainText=function(message){if(!message){return""}var TAG_REGEX=/<([^|>]+)(?:\|([^>]+))?>/g,text="",last=0,m;while((m=TAG_REGEX.exec(message))!==null){text+=message.slice(last,m.index);last=TAG_REGEX.lastIndex;text+=m[2]||m[1]}text+=message.slice(last);text=text.trim().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/([\uE000-\uF8FF]|\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDDFF])/g,"");return text}}})(angular);
(function(ng){ng.module("ats.services").service("tosAgreement",tosAgreement);tosAgreement.$inject=["$http","eoAlert","oLog","eoModelFactory","$location","eoConfig"];function tosAgreement($http,eoAlert,oLog,eoModelFactory,$location,eoConfig){return{accept:accept};function accept(tosType,showMessageOnError){return $http.post("/oca/tos/v1/terms/100901 - OMUA.2.json",{type:tosType}).then(function(response){return true},function(response){var event=eoModelFactory.get("Event",{event:"mua_error",location:$location.absUrl(),sublocation:"",data:[{type:"impression",user_id:eoConfig.get("User").getNid()}]});oLog.event(event);if(showMessageOnError&&response.data&&response.data.error){eoAlert.inline({type:"danger",template:response.data.error.message})}return false})}}})(angular);
(function(ng){"use strict";ng.module("ats.services").service("atsUrlLinkRouter",atsUrlLinkRouter);atsUrlLinkRouter.$inject=["$state","ATS_ROUTE_STATE_NAMES"];function atsUrlLinkRouter($state,ATS_ROUTE_STATE_NAMES){this.getConnectedFreelancerDetailsUrl=function(freelancer){var routerName=ATS_ROUTE_STATE_NAMES.routeTabFreelancerDetails;return routerName?$state.href(routerName,getFreelancerDetailsParams(freelancer)):""};this.getSearchFreelancerDetailsUrl=function(freelancer){var routerName=ATS_ROUTE_STATE_NAMES.routeSearchFreelancerDetails;return routerName?$state.href(routerName,getFreelancerDetailsParams(freelancer)):""};this.isOnRouteProfileSearch=function(){return $state.current.name===ATS_ROUTE_STATE_NAMES.routeProfileSearch};this.isOnRouteProposalList=function(){return $state.current.name===ATS_ROUTE_STATE_NAMES.routeProposalList};function getFreelancerDetailsParams(freelancer){return{profileCipherText:freelancer.ciphertext,freelancer:freelancer}}}})(angular);
(function(ng){"use strict";ng.module("ats.services").factory("utils",Utils);Utils.$inject=[];function Utils(){return{getPropertyByString:getPropertyByString,normalizeParams:normalizeParams,isUndefinedOrNull:isUndefinedOrNull};function getPropertyByString(object,propertyPath){if(!propertyPath){return object}return getByPath(object,propertyPath.split("."))}function getByPath(object,path){if(!object||path.length===0){return null}var propertyName=path.shift();if(ng.isUndefined(object[propertyName])){return null}else{if(path.length===0){return object[propertyName]}else{return getByPath(object[propertyName],path)}}}function normalizeParams(params){return Object.keys(params).sort().reduce(function(accItem,next){accItem[next]=params[next];return accItem},{})}function isUndefinedOrNull(value){return ng.isUndefined(value)||value===null}}})(angular);
(function(angular){"use strict";angular.module("ats.interceptors",[])})(angular);
(function(){"use strict";angular.module("ats.interceptors").factory("HttpRetryInterceptor",HttpRetryInterceptor).config(HttpRetryConfig);HttpRetryInterceptor.$inject=["$q","eoRequest","eoModelFactory","MAX_500_ATTEMPTS"];function HttpRetryInterceptor($q,eoRequest,eoModelFactory,MAX_500_ATTEMPTS){return{responseError:responseError};function responseError(response){if(!response.config||!response.config.headers){return $q.reject("Invalid Response.")}if(response.config.doNotRetry){return $q.reject(response)}if(response.status!==500&&response.status!==502&&response.status!==503&&response.status!==504){return $q.reject(response)}var header=eoModelFactory.get("IncrementalHeader",{name:"X-RETRIES",value:angular.isDefined(response.config.headers["X-RETRIES"])?response.config.headers["X-RETRIES"]:0});header.increment(response);if(header.value<=MAX_500_ATTEMPTS){return eoRequest.resend(response,header.getBackoff())}else{return $q.reject(response)}}}HttpRetryConfig.$inject=["$httpProvider"];function HttpRetryConfig($httpProvider){$httpProvider.interceptors.push("HttpRetryInterceptor")}})();
(function(){"use strict";angular.module("ats.filters",[])})();
(function(){"use strict";angular.module("ats.filters").filter("inArray",InArray).filter("notInArray",NotInArray).filter("offset",Offset);InArray.$inject=[];function InArray(){return function(value,array){return array.indexOf(value)>-1}}NotInArray.$inject=[];function NotInArray(){return function(value,array){return array.indexOf(value)===-1}}Offset.$inject=[];function Offset(){return function(array,offset){if(angular.isArray(array)){return array.slice(offset)}else{return array}}}})();
(function(ng){"use strict";angular.module("ats.filters").filter("stringDateToIso8601",stringDateToIso8601);stringDateToIso8601.$inject=[];function stringDateToIso8601(){return function(stringDate){var iso8601=stringDate;var matches=stringDate.match(/^(\d{2,4})\-(\d{2})\-(\d{2})( (\d{2}):(\d{2}):(\d{2}))?$/);if(matches&&matches.length>3){iso8601=matches.slice(1,4).join("-")+"T";if(ng.isUndefined(matches[4])){iso8601+="00:00:00Z"}else{iso8601+=matches.slice(5,8).join(":")+"Z"}}return iso8601}}})(angular);
(function(){"use strict";angular.module("ats.filters").filter("markExpectedInFutureYear",MarkExpectedInFutureYear);MarkExpectedInFutureYear.$inject=[];function MarkExpectedInFutureYear(){return function(year){var d=new Date;if(parseInt(year)>d.getFullYear()){year+=" (expected)"}return year}}})();
(function(){"use strict";angular.module("ats.filters").filter("stripBrTags",StripBrTags).filter("stripTags",StripTags).filter("htmlToPlaintext",HtmlToPlaintext).filter("nl2br",Nl2br).filter("formattedUserInput",FormattedUserInput);StripBrTags.$inject=[];function StripBrTags(){return function(text){return String(text).replace(/<\s*br\s*\/?\s*>/gm,"")}}StripTags.$inject=[];function StripTags(){return function(text){return String(text).replace(/<[^>]+>/gm,"")}}HtmlToPlaintext.$inject=[];function HtmlToPlaintext(){return function(text){return String(text).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")}}Nl2br.$inject=[];function Nl2br(){return function(text){return String(text).replace(/\n/g," <br> ")}}FormattedUserInput.$inject=["nl2brFilter","htmlToPlaintextFilter","linkRewriteFilter"];function FormattedUserInput(nl2brFilter,htmlToPlaintextFilter,linkRewriteFilter){return function(text){return linkRewriteFilter(nl2brFilter(htmlToPlaintextFilter(text)),"/leaving?ref=")}}})();
(function(){"use strict";angular.module("ats.filters").filter("humanSize",HumanSize);HumanSize.$inject=[];function HumanSize(){return function(text){var sizes=["Bytes","KB","MB","GB","TB"],i=parseInt(Math.floor(Math.log(text)/Math.log(1024)));if(isNaN(i)){i=0}return Math.round(text/Math.pow(1024,i))+" "+sizes[i]}}})();
(function(){"use strict";angular.module("ats.filters").filter("percentile",Percentile);Percentile.$inject=["$filter"];function Percentile($filter){return function(string,decimals){var float=parseFloat(string);if(!decimals){decimals=0}return $filter("number")(float*100,decimals)}}})();
(function(ng){"use strict";ng.module("ats.filters").filter("objectsOrderBy",ObjectsOrderBy);ObjectsOrderBy.$inject=[];function ObjectsOrderBy(){return function(items,field,reverse){var filtered=[];ng.forEach(items,function(item){filtered.push(item)});filtered.sort(function(a,b){return a[field]>b[field]?1:-1});if(reverse){filtered.reverse()}return filtered}}})(angular);
(function(ng){["components.uploading.uploaders","components.uploading.uploaders.profileImage","components.uploading.helpers","components.uploading.helpers.models","components.files.images.crop"].map(function(moduleName){ng.module(moduleName,[])})})(angular);
(function(ng){"use strict";ng.module("ats",["ats.interceptors","ats.filters","ats.services"])})(angular);
(function(ng,applet){"use strict";var isAppApplicants=applet.getVar("atsAppKey")==="applicants";var appDependencies=[isAppApplicants?"ats.applicants":"ats.search"];var routeStateNames=isAppApplicants?{routeProposalList:"ats.applicants",routeProfileSearch:"ats.search",routeSearchFreelancerDetails:"ats.search.detail",routeTabFreelancerDetails:"ats.search.detail"}:{routeProfileSearch:"profile_search",routeSearchFreelancerDetails:"profile_search.search_profile_details",routeTabFreelancerDetails:"profile_search.tab_profile_details"};var module=ng.module("AtsFlSearch",["ats","ngRoute","ui.router","ngSanitize","components.core","components.core.utils","components.core.pagination","freelancer.search.facet","up.disintermediation","mgcrea.bootstrap.affix","mgcrea.jquery","truncate","ngCookies","ngAnimate","user.presence","event.logging","saveFreelancer","interviewInvitation","freelancer.tile","fe.components.profile.overlay","atsUsMarket"].concat(appDependencies)).constant("USER_PRESENCE_REFRESH_TIME_SECONDS",180).constant("TL_BASE_PATH",applet.getVar("tlBaseUrl")).constant("applet",applet).constant("MAX_500_ATTEMPTS",applet.getVar("max500Attempts")||3).constant("ATS_FREELANCER_BLOCK_ITEMS_PER_PAGE",applet.getVar("atsPastHiresAndFavoritesItemsPerPage")).constant("ATS_SEARCH_ITEMS_PER_PAGE",applet.getVar("atsSearchItemsPerPage")).value("INTERVIEW_INVITATION_CLIENT_NAME",applet.getVar("clientName")).constant("INTERVIEW_INVITATION_LOG_SUBLOCATION",isAppApplicants?"ats":"invite_modal").constant("ATS_APPLICANTS_BASE_URL",applet.getVar("atsApplicantsBaseUrl")).constant("ATS_PROFILE_SEARCH_BASE_URL",applet.getVar("atsProfileSearchBaseUrl")).constant("ATS_APP_KEY",applet.getVar("atsAppKey")).constant("ATS_API_BASE_URL",applet.getBasePath()).constant("FREELANCER_SEARCH_FACET_API_URL_PREFIX",applet.getBasePath()+"/api/").constant("SAVE_FREELANCER_API_BASE_PATH",applet.getBasePath()+"/api/").constant("ATS_ROUTE_STATE_NAMES",routeStateNames).constant("LOG_LOCATION",isAppApplicants?"ats":"contractor_search").constant("PROFILE_SETTINGS_BASE_PATH",applet.getBasePath()+"/api/").constant("ATS_US_MARKET_EVENT_LOG_LOCATION","contractor_search").constant("INTERVIEW_INVITATION_BUTTON_TITLE","Invite To Job").value("FREELANCER_TILE_RECENT_EARNINGS_ENABLED",applet.getVar("isRecentEarningsEnabled")).value("FREELANCER_TILE_IS_US_AGENCIES_ENABLED",applet.getVar("isAgenciesOnDomestic")).config(AtsAppConfig).config(disintermediationListenerConfig).value("REPLACE_REVENUE_BY_EARNINGS_ENABLED",applet.getVar("isReplaceRevenueByEarnings")).value("FREELANCER_SEARCH_RECENT_EARNINGS_ENABLED",applet.getVar("isRecentEarningsEnabled"));atsHighlightFix.$inject=["eoUtils"];function atsHighlightFix(eoUtils){return function(text,search,caseSensitive){if(!angular.isDefined(text)||text===null){return text}text=eoUtils.escapeText(text.toString());if(search||angular.isNumber(search)){search=eoUtils.escapeText(search.toString()).replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var searchPattern="("+search+")((?![(&quot|&amp|&lt|&gt|&apos|&#39|&#x2F)]*;))";return text.replace(new RegExp(searchPattern,"g"+(!caseSensitive?"i":"")),"<mark>$&</mark>")}else{return text}}}module.filter("highlight",atsHighlightFix);ng.module("components.core.config").config(setMaxXhrAttempts);AtsAppConfig.$inject=["$httpProvider"];function AtsAppConfig($httpProvider){$httpProvider.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}setMaxXhrAttempts.$inject=["$provide"];function setMaxXhrAttempts($provide){$provide.constant("MAX_XHR_ATTEMPTS",0)}disintermediationListenerConfig.$inject=["upDisintermediationMessageServiceProvider"];function disintermediationListenerConfig(upDisintermediationMessageServiceProvider){upDisintermediationMessageServiceProvider.configure({appContext:"Invite",userContext:applet.getOrganization().isClient()?"Client":"Freelancer"})}})(angular,Applet);
(function(ng,applet){"use strict";var module=ng.module("user.presence",["upwork.transport"]);module.constant("USER_PRESENCE_REFRESH_TIME_SECONDS",10);module.constant("TL_BASE_PATH",null);module.service("user.presence.service",PresenceService);PresenceService.$inject=["$http","$q"];function PresenceService($http,$q){var presence={};return{apiUrlPrefix:applet.getBasePath(),setApiUrlPrefix:function(apiUrlPrefix){this.apiUrlPrefix=apiUrlPrefix},fetchPresence:fetchPresence,updatePresence:updatePresence,getState:getState};function fetchPresence(profileIds,useRids){var deferred=$q.defer();profileIds=profileIds.filter(function(id){return!!id});if(profileIds.length){$http.get(this.apiUrlPrefix+"/api/presence",{params:{"profileIds[]":profileIds,useRids:useRids?1:0}}).then(function(response){ng.extend(presence,response.data);deferred.resolve(response)},function(response){for(var i=0;i<profileIds.length;i++){presence[profileIds[i]]=0}deferred.reject(response)})}else{deferred.resolve({})}return deferred.promise}function updatePresence(tlResponse){ng.extend(presence,tlResponse)}function getState(profileId){return presence[profileId]}}module.directive("userPresenceIndicator",PresenceIndicator);PresenceIndicator.$inject=["user.presence.service"];function PresenceIndicator(presenceService){var stateNames={0:"offline",1:"online",2:"away"};return{require:"?^userPresence",replace:true,link:link,scope:{unreadCount:"=?",isEnabled:"=?"},templateUrl:applet.buildInternalAssetPath("@OdeskUserPresenceBundle/indicator.html")};function link($scope,$element,$attrs,$controller){$scope.getStateName=function(){var state=presenceService.getState($attrs.userPresenceIndicator);var stateName="offline";if(state){if(ng.isNumber(state)){if(ng.isDefined(stateNames[state])){stateName=stateNames[state]}}else{stateName=state.toLowerCase()}}return stateName};$scope.isEnabled=ng.isDefined($scope.isEnabled)?$scope.isEnabled:true;if($controller){$controller.pushId($attrs.userPresenceIndicator)}}}module.service("userPresenceSocket",presenceSocket);presenceSocket.$inject=["tlSocket","user.presence.service","$log","TL_BASE_PATH"];function presenceSocket(tlSocket,PresenceService,$log,TL_BASE_PATH){var configured=false;var allIds=[];var maxIdsCount=1e3;return{initPresence:initPresence};function configure(ids){if(applet.getVar("sessionId")){tlSocket.query.token=applet.getVar("sessionId")}if(!TL_BASE_PATH){throw new Error("TL_BASE_PATH must be defined with appropriate env url")}tlSocket.setBaseUrl(TL_BASE_PATH);configured=true;tlSocket.on("presence",function(update){if(allIds.indexOf(update.userId)!==-1){var presenceNode=[];presenceNode[update.userId]=update.show;PresenceService.updatePresence(presenceNode)}});tlSocket.on("reconnect",function(){getPresence(allIds)})}function initPresence(ids){if(!configured){configure(ids)}getPresence(ids);addProcessedIds(ids)}function addProcessedIds(ids){var concatIds=allIds.concat(ids);allIds=concatIds.filter(function(item,pos){return concatIds.indexOf(item)==pos});allIds=allIds.slice(0,maxIdsCount)}function getPresence(ids){tlSocket.send("getPresence",{ids:ids}).then(function(resp){PresenceService.updatePresence(resp.list)},function(err){$log.error("Precense error",err,"ids="+ids)})}}module.directive("userPresence",UserPresence);function UserPresence(){Controller.$inject=["$scope","$interval","$timeout","$attrs","user.presence.service","userPresencePoller","userPresenceSocket","USER_PRESENCE_REFRESH_TIME_SECONDS"];return{scope:{apiUrlPrefix:"@"},controller:Controller};function Controller($scope,$interval,$timeout,$attrs,presenceService,userPresencePoller,userPresenceSocket,USER_PRESENCE_REFRESH_TIME_SECONDS){var ids=[];var wsSentIds=[];var pollerLastSentIds=[];var pollerStarted=false;var refreshInterval=false;var useRids=false;var refreshTime=USER_PRESENCE_REFRESH_TIME_SECONDS*1e3;ids.diff=function(a){return this.filter(function(i){return a.indexOf(i)<0})};this.pushId=function(userId){ids.push(userId);ng.isDefined($attrs.userPresenceUseWebsocket)?initWebsocket():startInterval()};if(!ng.isDefined($attrs.userPresenceUseWebsocket)){activate()}function activate(){refreshInterval=false;$scope.$on("$destroy",function(){$interval.cancel(refreshInterval);refreshInterval=false});if(ng.isDefined($attrs.userPresenceUseRids)){useRids=true}if(ng.isDefined($attrs.userPresenceRefreshTime)&&!isNaN($attrs.userPresenceRefreshTime)){refreshTime=parseInt($attrs.userPresenceRefreshTime,10)*1e3}if($scope.apiUrlPrefix){presenceService.setApiUrlPrefix($scope.apiUrlPrefix)}}function startInterval(){if(refreshInterval){return false}refreshInterval=true;$timeout(function(){refreshInterval=false},100);$timeout(function(){var skipCounter=0;var skipMaxCount=0;if(ng.isDefined($attrs.userPresenceIsPaginationMode)){var newPollerIds=ids.diff(pollerLastSentIds);if(newPollerIds.length){ids.splice(0,ids.length);ids.push.apply(ids,newPollerIds)}pollerLastSentIds=ids.slice(0)}if(!pollerStarted){pollerStarted=true;userPresencePoller.newSmartInterval(function(){if(skipCounter>0){skipCounter--}else{presenceService.fetchPresence(ids,useRids).then(function(response){skipMaxCount=0},function(response){if(response.status===401){skipMaxCount=skipMaxCount>0?skipMaxCount*2:5;skipCounter=skipMaxCount}})}},refreshTime)}presenceService.fetchPresence(ids,useRids)},50)}function initWebsocket(){if(ng.isDefined($attrs.userPresenceUseRids)){throw new Error("UserPresence directive doesn't support profile rids as parameters in 'Websocket' mode")}$timeout(function(){var newIds=ids.diff(wsSentIds);if(newIds.length){userPresenceSocket.initPresence(newIds);ng.extend(wsSentIds,ids)}},10)}}}module.service("userPresencePoller",atsPoller);atsPoller.$inject=["$interval","$q","$window"];function atsPoller($interval,$q,$window){var intervalConfig={};var callbackPromises={};var $windowElement=ng.element($window);var isWindowFocused=true;$windowElement.on("blur",handleBlur);$windowElement.on("focus",handleFocus);return{newSmartInterval:newSmartInterval,cancel:cancel};function newSmartInterval(){if(!ng.isFunction(arguments[0])){throw new Error("1st argument (callback) must be a function")}if(!(arguments[1]>0)){throw new Error("2nd argument (delay) is required and must be a positive number")}var config={callback:arguments[0],delay:arguments[1]};if(arguments[2]){config.count=arguments[2]}if(arguments[3]){config.invokeApply=arguments[3]}return create(config)}function create(config){var defaultConfig={throttleOnBlur:true,throttleOnFail:true,throttleLevel:0,throttleLeft:0,invokeApply:true,count:0};if(!(config.delay>0)){throw new Error("config.delay is required and must be a positive number")}if(!ng.isFunction(config.callback)){throw new Error("config.callback must be a function")}config=ng.extend({},defaultConfig,config);config.originalCallback=config.callback;config.callback=getSmartCallback(config.originalCallback,config);config.promise=$interval(config.callback,config.delay,config.count,config.invokeApply);addIntervalConfig(config);return config.promise}function cancel(promise){delete intervalConfig[promise.$$intervalId];delete callbackPromises[promise.$$intervalId];$interval.cancel(promise)}function getSmartCallback(callback,config){return function(){var promise=getCallbackPromise(config);var isPending=promise&&promise.$$state.status<=0;var isResolved=promise&&promise.$$state.status===1;var isRejected=promise&&promise.$$state.status===2;if(config.throttleLeft>0){config.throttleLeft--;return false}if(isRejected&&config.throttleOnFail){throttle(config);return false}if(isPending){return false}if(!isWindowFocused&&config.throttleOnBlur){throttle(config)}if(isResolved&&isWindowFocused){resetThrottle(config)}var callbackResult=callback.apply(this,arguments);addCallbackPromise(callbackResult,config)}}function addIntervalConfig(config){intervalConfig[config.promise.$$intervalId]=config}function addCallbackPromise(promise,config){callbackPromises[config.promise.$$intervalId]=$q.when(promise)}function getCallbackPromise(config){return callbackPromises[config.promise.$$intervalId]}function throttle(config){config.throttleLeft=Math.pow(2,config.throttleLevel)-1;config.throttleLevel++;callbackPromises[config.promise.$$intervalId]=false}function resetThrottle(config){config.throttleLevel=0;config.throttleLeft=0}function resetAllThrottles(){ng.forEach(intervalConfig,function(config){resetThrottle(config)})}function handleBlur(){isWindowFocused=false}function handleFocus(){resetAllThrottles();isWindowFocused=true}}})(angular,Applet);
(function(ng,applet){"use strict";var module=ng.module("event.logging",["components.core.log"]);module.constant("EVENT_LOGGING_REDIRECT_TIMEOUT",5e3);module.service("logEventService",logEventService);logEventService.$inject=["oLog","eoModelFactory","$log"];function logEventService(oLog,eoModelFactory,$log){var linkElement=null,guids={};return{getAbsoluteUrl:getAbsoluteUrl,logMasterEvent:logMasterEvent,logEvent:logEvent,generateGuid:generateGuid,getLogGuid:getLogGuid,setLogGuid:setLogGuid,isTrustedUrl:function(url){try{var domain=getAbsoluteUrl(url).split("/")[2];return domain&&/\.(odesk|upwork)\.com(:\d+)?$/i.test(domain)}catch(error){$log.error(error)}return false}};function getAbsoluteUrl(url){if(!linkElement){linkElement=ng.element("<a/>")[0]}linkElement.href=url;return linkElement.href}function logMasterEvent(event,location,sublocation,logData){var guid=this.generateGuid();if(logData.length===0){logData.push({})}guids[location]=guid;this.logEvent(event,location,sublocation,logData);return guid}function logEvent(event,location,sublocation,logData){if(guids[location]){var guid=guids[location];if(sublocation==="__multiple__"&&logData.length>0){ng.forEach(logData,function(data){addGuid(data.data,guid)})}else{addGuid(logData,guid)}}return oLog.event(eoModelFactory.get("Event",{event:event,location:location,sublocation:sublocation,data:logData}))}function generateGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c==="x"?r:r&3|8;return v.toString(16)})}function getLogGuid(location){return guids[location]}function setLogGuid(location,guid){if(ng.isString(guid)){guids[location]=guid}}function addGuid(logData,guid){if(logData.length>1){logData.push({type:"guid",log_guid:guid})}else{if(logData.length===0){logData.push({})}logData[0].log_guid=guid}}}module.directive("logEvent",logEvent);logEvent.$inject=["$window","$log","$timeout","EVENT_LOGGING_REDIRECT_TIMEOUT","logEventService"];function logEvent($window,$log,$timeout,EVENT_LOGGING_REDIRECT_TIMEOUT,logEventService){return{require:"?^^logLocation",link:link};function link(scope,element,attr,logLocationController){if(!ng.isDefined(logLocationController)||!ng.isDefined(attr.logEvent)||attr.logEvent===""){return}var logData=[];var logTrigger=attr.logTrigger||"click";var preventNavigation=attr.preventNavigation||false;element.on(logTrigger,function(event){var target=event.target;while(target!==null&&element[0]!==target){if(target.hasAttribute("data-log-event")||target.hasAttribute("log-event")){return}target=target.parentElement}logData=[];if(ng.isDefined(attr.logData)){try{logData.push(logLocationController.parseLogObject(ng.fromJson(attr.logData),scope))}catch(error){$log.error(error)}}var redirectUrl=attr.ngHref||element.attr("href")||false;var isSref=attr.uiSref||false;if(isSref||preventNavigation||!redirectUrl||event&&(event.ctrlKey||event.metaKey)){logLocationController.log(attr.logEvent,logData,attr.logLabel,attr.logSublocation);if(preventNavigation){event.preventDefault()}}else{event.preventDefault();var isNewTab=attr.target==="_blank";var isTrustedUrl=logEventService.isTrustedUrl(redirectUrl);var endpointUrl=applet.getVar("eventLoggingExt");var openedWindow=null;var isNewTabRedirected=false;var newTabRedirect=function(){if(!isNewTabRedirected){openedWindow.location=redirectUrl;isNewTabRedirected=true}};if(isNewTab&&isTrustedUrl&&endpointUrl){openedWindow=$window.open(endpointUrl,"_blank");$timeout(newTabRedirect,EVENT_LOGGING_REDIRECT_TIMEOUT)}logLocationController.log(attr.logEvent,logData,attr.logLabel,attr.logSublocation).finally(function(){if(isNewTab){try{if(openedWindow){newTabRedirect()}else{$window.open(redirectUrl,"_blank")}}catch(error){$log.error(error)}}else{$window.location=redirectUrl}})}});scope.$on("$destroy",function(){element.off(logTrigger)})}}module.directive("logLocation",logLocation);logLocation.$inject=["logEventService","$log","$parse"];function logLocation(logEventService,$log,$parse){return{controller:function($scope,$attrs){this.log=function(logEvent,logData,logLabel,logSublocation){if(!logData){logData=[]}if($attrs.logData||$attrs.composeLogData){try{var parentLogData;if($attrs.composeLogData){var composeMethod=$parse($attrs.composeLogData);parentLogData=composeMethod($scope)}else if($attrs.logData){parentLogData=this.parseLogObject(ng.fromJson($attrs.logData),$scope)}if($attrs.joinLogData&&$attrs.joinLogData==="true"&&logData.length===1){logData[0]=ng.extend(parentLogData,logData[0])}else{logData.push(parentLogData)}}catch(error){$log.error(error)}}var label=logLabel||$attrs.logLabel;if(label){if(logData.length===0){logData.push({})}ng.forEach(logData,function(data){data.label=label})}return logEventService.logEvent(logEvent,$attrs.logLocation,logSublocation||$attrs.logSublocation,logData)};this.parseLogObject=function(logTemplate,scope){var recordLog={};ng.forEach(logTemplate,function(value,key){if(ng.isObject(value)){if(ng.isDefined(value.scope)){this[key]=$parse(value.scope)(scope)}else{this[key]=value}}else{this[key]=value}},recordLog);return recordLog}}}}})(angular,Applet);
(function(ng,applet){"use strict";var module=ng.module("saveFreelancer",["components.core.alert","components.core.popover","components.core.buttons.save"]);module.constant("SAVE_FREELANCER_API_BASE_PATH",applet.getBasePath()+"/api/")})(angular,Applet);
(function(ng){"use strict";ng.module("saveFreelancer").service("favoritesService",favoritesService);favoritesService.$inject=["$http","SAVE_FREELANCER_API_BASE_PATH"];function favoritesService($http,SAVE_FREELANCER_API_BASE_PATH){this.getList=function(){return $http.get(buildEndpointPath("favorites"),{headers:{"Cache-Control":"no-cache"}})};this.add=function(targetUid,note){return $http({method:"POST",url:buildEndpointPath("favorites"),data:"targetUid="+targetUid+"&note="+encodeURIComponent(note),headers:{"Content-Type":"application/x-www-form-urlencoded"}})};this.remove=function(targetUid){return $http({method:"DELETE",url:buildEndpointPath("favorites/remove"),data:"targetUid="+targetUid,headers:{"Content-Type":"application/x-www-form-urlencoded"}})};this.updateNote=function(rid,note){return $http({method:"PUT",url:buildEndpointPath("favorites/"+rid),data:"note="+encodeURIComponent(note),headers:{"Content-Type":"application/x-www-form-urlencoded"}})};this.list=this.getList();function buildEndpointPath(path){return SAVE_FREELANCER_API_BASE_PATH+path}}})(angular);
(function(ng,applet){"use strict";ng.module("saveFreelancer").controller("$saveButtonController",$saveButtonController);$saveButtonController.$inject=["$scope","favoritesService"];function $saveButtonController($scope,favorites){var size=ng.isDefined($scope.size)?$scope.size:"md";$scope.btnClass=$scope.btnClass||"btn btn-default btn-block eo-button-save m-0 p-0-left-right btn-"+size;$scope.popoverPlacement=ng.isDefined($scope.popoverPlacement)?$scope.popoverPlacement:"left";$scope.popoverTemplateUrl=applet.buildInternalAssetPath("@OdeskSaveFreelancerBundle/js/save-freelancer/popover.html");favorites.list.success(function(favoritesList){if(ng.isUndefined(favoritesList[$scope.freelancerUid])){favoritesList[$scope.freelancerUid]={personUid:null,note:null}}$scope.favorite=favoritesList[$scope.freelancerUid]});$scope.$watch("favorite.personUid",function(newFavoriteUid){$scope.newFavoriteUidCallback(newFavoriteUid)});this.handleLogEventClick=function(logLocationController,logLabel){if(logLocationController&&ng.isFunction(logLocationController.log)){logLocationController.log("click",[],logLabel,$scope.logSublocation||"save_modal")}}}})(angular,Applet);
(function(ng,applet){"use strict";ng.module("saveFreelancer").directive("saveFreelancerButton",saveFreelancerButton);saveFreelancerButton.$inject=[];function saveFreelancerButton(){return{restrict:"AE",require:["saveFreelancerButton","?^^logLocation"],scope:{freelancerUid:"@saveFreelancerUid",size:"@?",popoverPlacement:"@?",btnClass:"@?",iconOnly:"<?",userAvatarUrl:"@",userProfileUrl:"@",userName:"@",userTitle:"@",logSublocation:"@?"},templateUrl:applet.buildInternalAssetPath("@OdeskSaveFreelancerBundle/js/save-freelancer/button.html"),link:link,controller:"$saveButtonController"};function link($scope,$element,$attr,controllers){var $saveButtonController=controllers[0];var logLocationController=controllers[1];$scope.popoverOpen=function($event){$event.preventDefault()};$scope.newFavoriteUidCallback=function(newFavoriteUid){$scope.btnModel=newFavoriteUid?"Saved":"Save"};$scope.handleLogEventClick=function(logLabel){$saveButtonController.handleLogEventClick(logLocationController,logLabel)}}}})(angular,Applet);
(function(ng){"use strict";ng.module("saveFreelancer").controller("saveFreelancerController",saveFreelancerController);saveFreelancerController.$inject=["$scope","favoritesService","eoAlert","$timeout","saveFreelancerEventBus"];var eventTypes={add:"add",remove:"remove",update:"update"};function saveFreelancerController($scope,favorites,eoAlert,$timeout,saveFreelancerEventBus){$scope.note=null;$scope.rid=null;$scope.isClosedByController=false;$scope.init=function(){$scope.$watch("isPopoverOpen",function(newVal){if(newVal===false&&!$scope.isClosedByController){$scope.handleLogEventClick("cancel")}});if($scope.favorite&&$scope.favorite.personUid){$scope.note=$scope.favorite.note;$scope.rid=$scope.favorite.rid}else{$scope.status="Saving...";$scope.handleLogEventClick("save");favorites.add($scope.freelancerUid,"").success(function(response){$scope.favorite.rid=$scope.rid=response;$scope.favorite.personUid=$scope.freelancerUid;$scope.status="Saved";publishAfterEvent(eventTypes.add);$timeout(function(){$scope.status=""},1e3)}).error(function(){eoAlert.inline({type:"danger",template:"There was an error saving freelancer, please try again later."});$scope.isClosedByController=true;$scope.close()})}};$scope.update=function(){var note=$scope.note||"";$scope.handleLogEventClick(note==""?"add_note":"edit_note");favorites.updateNote($scope.rid,note).success(function(){$scope.favorite.note=note;eoAlert.inline({type:"success",template:"Your note has been updated successfully."});publishAfterEvent(eventTypes.update)}).error(function(){eoAlert.inline({type:"danger",template:"There was an error updating your note, please try again later."})});$scope.isClosedByController=true;$scope.close()};$scope.remove=function(){$scope.favorite.personUid=null;$scope.favorite.note=null;$scope.handleLogEventClick("unsave");favorites.remove($scope.freelancerUid).success(function(){eoAlert.inline({type:"success",template:"Freelancer has been removed from your saved list."});publishAfterEvent(eventTypes.remove)}).error(function(){$scope.favorite.rid=$scope.rid;$scope.favorite.personUid=$scope.freelancerUid;$scope.favorite.note=$scope.note;eoAlert.inline({type:"danger",template:"There was an error removing freelancer from saved list, please try again later."})});$scope.isClosedByController=true;$scope.close()};$scope.handleLogEventClick=function(logLabel){if($scope.$parent&&ng.isFunction($scope.$parent.handleLogEventClick)){$scope.$parent.handleLogEventClick(logLabel)}};function publishAfterEvent(eventType){saveFreelancerEventBus.publish("save-freelancer:after:change-in-list",{type:eventType})}$scope.init()}})(angular);
(function(ng){"use strict";ng.module("saveFreelancer").service("saveFreelancerEventBus",saveFreelancerEventBus);saveFreelancerEventBus.$inject=[];function saveFreelancerEventBus(){var service=this;var commonBus=new EventBus;service.listen=commonBus.listen;service.publish=commonBus.publish;function EventBus(){var self=this;var listeners={};this.listen=function(eventName,callback){if(!listeners[eventName]){listeners[eventName]=[]}var listener={fn:callback};listeners[eventName].push(listener);return function(){return removeListener(listeners[eventName],listener)}};this.publish=function(eventName,parameters){if(listeners[eventName]){for(var i=0;i<listeners[eventName].length;i++){listeners[eventName][i].fn.apply(self,ng.isArray(parameters)?parameters:[parameters])}}}}function removeListener(array,value){var index=array.indexOf(value);if(index>=0){array.splice(index,1)}return index>=0}}})(angular);
(function(ng,applet){"use strict";ng.module("saveFreelancer").directive("saveFreelancerLinkControl",saveFreelancerLinkControl);saveFreelancerLinkControl.$inject=[];function saveFreelancerLinkControl(){return{restrict:"AE",scope:{size:"@?",linkClass:"@?",isSaved:"=",trueValue:"@",falseValue:"@"},templateUrl:applet.buildInternalAssetPath("@OdeskSaveFreelancerBundle/js/save-freelancer/save-freelancer-link-control.html"),link:link};function link($scope){$scope.iconSize=ng.isDefined($scope.size)&&$scope.size?$scope.size:null;$scope.getTitle=function(){return $scope.isSaved?$scope.trueValue:$scope.falseValue}}}})(angular,Applet);
(function(ng,applet){"use strict";ng.module("saveFreelancer").directive("saveFreelancerLink",saveFreelancerLink);saveFreelancerLink.$inject=[];function saveFreelancerLink(){return{restrict:"A",require:["saveFreelancerLink","?^^logLocation"],scope:{freelancerUid:"@saveFreelancerUid",size:"@?",linkClass:"@?",linkControlClass:"@?",saveTitle:"@",savedTitle:"@",userAvatarUrl:"@",userProfileUrl:"@",userName:"@",userTitle:"@",userAgency:"=?",logSublocation:"@?"},templateUrl:applet.buildInternalAssetPath("@OdeskSaveFreelancerBundle/js/save-freelancer/link.html"),link:link,controller:"$saveButtonController"};function link($scope,$element,$attr,controllers){var $saveButtonController=controllers[0];var logLocationController=controllers[1];$scope.isSaved=false;$scope.newFavoriteUidCallback=function(newFavoriteUid){$scope.isSaved=ng.isDefined(newFavoriteUid)&&newFavoriteUid!==null};$scope.handleLogEventClick=function(logLabel){$saveButtonController.handleLogEventClick(logLocationController,logLabel)}}}})(angular,Applet);
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require(void 0)):"function"==typeof define&&define.amd?define(["angular"],t):"object"==typeof exports?exports.upDisintermediation=t(require("angular")):e.upDisintermediation=t(e.angular)}(this,function(e){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=71)}([function(t,n){t.exports=e},function(e,t,n){e.exports=!n(2)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){if(!e.name)throw new Error('A category must have a valid "name"');if(!e.disallow||e.disallow.constructor!==Array||!e.disallow.length)throw new Error("A category must have a list of disallowed patterns");if(e.allow&&e.allow.constructor!==Array)throw new Error("A category's allowed patterns must be an Array");if(e.allowTests&&e.allowTests.constructor!==Array)throw new Error('Parameter "allowTests" should be an array of test functions');if(e.disallowTests&&e.disallowTests.constructor!==Array)throw new Error('Parameter "allowTests" should be an array of test functions')}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=function(){function e(t){r(this,e),i(t),this.name=t.name,this._disallowTests=t.disallowTests||[],this._allowTests=t.allowTests||[];var n=new RegExp(t.disallow.join("|"),"ig");if(this._disallowTests.unshift(function(t,o){return e.matchPattern(n,t,o)}),t.allow&&t.allow.length){var o=new RegExp(t.allow.join("|"),"ig");this._allowTests.unshift(function(t){return e.matchPattern(o,t)})}}return a(e,[{key:"_isAllowed",value:function(e){if(!this._allowTests.length)return!1;if(!e||"string"!=typeof e[0])return console.warn("Unrecognized format of match provided for allowance check. Should be formatted like results of Regex#exec"),!1;for(var t=e[0],n=0;n<this._allowTests.length;n++)if(this._allowTests[n](t))return!0;return!1}},{key:"detect",value:function(e,t,n){var r=this;if("string"!=typeof e)return console.warn("The text parameter passed to Category#match must be a string"),null;for(var i=[],a=0;a<this._disallowTests.length;a++){var u=this._disallowTests[a](e,t);if(u&&(u=u.map(function(e){return e.category=r,e.allowed=r._isAllowed(e),e}).filter(function(e){return n||!e.allowed}),i.push.apply(i,o(u)),!t))return i}return i.length?i:null}}],[{key:"matchPattern",value:function(e,t,n){for(var o=void 0,r=[];o=e.exec(t);)if(r.push(o),!n)return e.lastIndex=0,r;return r.length?r:null}}]),e}();t.default=u},function(e,t){e.exports={payment:{title:"Have your heard about Payment Protection?",note:'Keep your money safe. Only make payments through Upwork. Don’t risk losing sleep or Upwork <a href="https://www.upwork.com/hiring/for-clients/payments-and-productivity-on-upwork/#protection" target="_blank">Payment Protection</a>'},messaging:{title:"Have you tried Upwork Messages?",note:"Simplify conversations. Use Upwork Messages to hold voice or video interviews."},contactInfo:{title:"Have you tried Upwork Messages?",note:"Stay safe. You’ll get added protection by keeping conversations on Upwork."}}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var o=n(15);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==o(e)?e.split(""):Object(e)}},function(e,t){var n=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?o:n)(e)}},function(e,t,n){var o=n(9),r=n(8);e.exports=function(e){return o(r(e))}},function(e,t,n){n(42),e.exports=n(5).Object.assign},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(6),s=o(u),c=function(){function e(t){var n=this;if(i(this,e),this._mutedCategories={},this._categoriesHash={},!t||!Object.keys(t).length)throw new Error('"rules" parameter must be an object indexed by category name.');this.categories=[],Object.keys(t).forEach(function(e){var o=new s.default(t[e]);n.categories.push(o),n._categoriesHash[o.name]=o})}return a(e,[{key:"detect",value:function(e,t,n){var o=this,i=[],a={},u=[];if(e)if(this.categories.forEach(function(u){if(!o.isMuted(u.name)){var s=u.detect(e,t,n);s&&(a[u.name]=!0,i.push.apply(i,r(s)))}}),i.length){i.sort(function(e,t){return e.index-t.index});var s=0;i.forEach(function(t,n){t.index>s&&u.push({text:e.substring(s,t.index),category:"none",index:s}),u.push({text:t[0],category:t.category.name,index:t.index,detectionIndex:n,allowed:t.allowed}),s=t.index+t[0].length});var c=e.substring(s);c.length&&u.push({text:c,category:"none",index:s})}else u.push({text:e,category:"none",index:0});return{text:e,detections:u,types:a}}},{key:"mute",value:function(e){this._mutedCategories[e]=1}},{key:"unmute",value:function(e){delete this._mutedCategories[e]}},{key:"isMuted",value:function(e){return!!this._mutedCategories[e]}},{key:"getCategory",value:function(e){return this._categoriesHash[e]}},{key:"getCategories",value:function(){return this.categories}}]),e}();t.default=c},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(7),a=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Default",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Default";o(this,e),this._messaging=t||{Default:{Default:i.messagesDefault}},this._appContext=n,this._userContext=r}return r(e,[{key:"setAppContext",value:function(e){return this._appContext=e,this}},{key:"setUserContext",value:function(e){return this._userContext=e,this}},{key:"getMessaging",value:function(e){var t=this._messaging[this._appContext]||this._messaging.Default,n=t[this._userContext]||this._messaging.Default[this._userContext]||this._messaging.Default.Default;return n[e]||(n=this._messaging.Default.Default),n[e]}}]),e}();t.default=a},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var o=n(3),r=n(5),i=n(22),a=n(26),u="prototype",s=function(e,t,n){var c,l,f,d=e&s.F,p=e&s.G,g=e&s.S,y=e&s.P,h=e&s.B,v=e&s.W,m=p?r:r[t]||(r[t]={}),w=m[u],b=p?o:g?o[t]:(o[t]||{})[u];p&&(n=t);for(c in n)(l=!d&&b&&void 0!==b[c])&&c in m||(f=l?b[c]:n[c],m[c]=p&&"function"!=typeof b[c]?n[c]:h&&l?i(f,o):v&&b[c]==f?function(e){var t=function(t,n,o){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,o)}return e.apply(this,arguments)};return t[u]=e[u],t}(f):y&&"function"==typeof f?i(Function.call,f):f,y&&((m.virtual||(m.virtual={}))[c]=f,e&s.R&&w&&!w[c]&&a(w,c,f)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=o(r),a=n(60);t.default=i.default.module("up.disintermediation.core",[]).constant("UP_DISINTERMEDIATION_VERSION",a.VERSION).constant("UP_DISINTERMEDIATION_DETECTION_SERVICE_PROVIDER_CLASS",a.DetectionServiceProvider).constant("UP_DISINTERMEDIATION_MESSAGE_SERVICE_PROVIDER_CLASS",a.MessageServiceProvider).constant("UP_DISINTERMEDIATION_ANALYTICS_SERVICE_PROVIDER_CLASS",a.AnalyticsServiceProvider).name},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=o(r),a=n(44),u=o(a);t.default=i.default.module("up.disintermediation.directive",[u.default]).directive("upDisintermediation",["upDisintermediationDetectionService",function(e){return{restrict:"A",require:"ngModel",scope:{upDisintermediationContext:"="},controller:["$scope","$element",function(t,n){var o=this,r=n.controller("ngModel"),i=function(){o.detectedDisintermediation=e.detect(n.val(),!0)};this.detectDisintermediation=i,n.on("blur keydown",function(){t.$evalAsync(i)}),t.$watch(function(){return r.$viewValue},i),this.getContext=function(){return t.upDisintermediationContext||"global"}}]}}]).name},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var o=n(4);e.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var o=n(11),r=n(38),i=n(37);e.exports=function(e){return function(t,n,a){var u,s=o(t),c=r(s.length),l=i(a,c);if(e&&n!=n){for(;c>l;)if((u=s[l++])!=u)return!0}else for(;c>l;l++)if((e||l in s)&&s[l]===n)return e||l||0;return!e&&-1}}},function(e,t,n){var o=n(19);e.exports=function(e,t,n){if(o(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,o){return e.call(t,n,o)};case 3:return function(n,o,r){return e.call(t,n,o,r)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var o=n(4),r=n(3).document,i=o(r)&&o(r.createElement);e.exports=function(e){return i?r.createElement(e):{}}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var o=n(29),r=n(34);e.exports=n(1)?function(e,t,n){return o.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){e.exports=!n(1)&&!n(2)(function(){return 7!=Object.defineProperty(n(23)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){"use strict";var o=n(32),r=n(30),i=n(33),a=n(39),u=n(9),s=Object.assign;e.exports=!s||n(2)(function(){var e={},t={},n=Symbol(),o="abcdefghijklmnopqrst";return e[n]=7,o.split("").forEach(function(e){t[e]=e}),7!=s({},e)[n]||Object.keys(s({},t)).join("")!=o})?function(e,t){for(var n=a(e),s=arguments.length,c=1,l=r.f,f=i.f;s>c;)for(var d,p=u(arguments[c++]),g=l?o(p).concat(l(p)):o(p),y=g.length,h=0;y>h;)f.call(p,d=g[h++])&&(n[d]=p[d]);return n}:s},function(e,t,n){var o=n(20),r=n(27),i=n(40),a=Object.defineProperty;t.f=n(1)?Object.defineProperty:function(e,t,n){if(o(e),t=i(t,!0),o(n),r)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var o=n(25),r=n(11),i=n(21)(!1),a=n(35)("IE_PROTO");e.exports=function(e,t){var n,u=r(e),s=0,c=[];for(n in u)n!=a&&o(u,n)&&c.push(n);for(;t.length>s;)o(u,n=t[s++])&&(~i(c,n)||c.push(n));return c}},function(e,t,n){var o=n(31),r=n(24);e.exports=Object.keys||function(e){return o(e,r)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var o=n(36)("keys"),r=n(41);e.exports=function(e){return o[e]||(o[e]=r(e))}},function(e,t,n){var o=n(3),r="__core-js_shared__",i=o[r]||(o[r]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t,n){var o=n(10),r=Math.max,i=Math.min;e.exports=function(e,t){return e=o(e),e<0?r(e+t,0):i(e,t)}},function(e,t,n){var o=n(10),r=Math.min;e.exports=function(e){return e>0?r(o(e),9007199254740991):0}},function(e,t,n){var o=n(8);e.exports=function(e){return Object(o(e))}},function(e,t,n){var o=n(4);e.exports=function(e,t){if(!o(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!o(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!o(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!o(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t){var n=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+o).toString(36))}},function(e,t,n){var o=n(16);o(o.S+o.F,"Object",{assign:n(28)})},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=function(){function e(){o(this,e)}return r(e,[{key:"report",value:function(e){console.log("analytics reporting stub:",e)}}]),e}();t.default=i},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=o(r),a=n(17),u=o(a);t.default=i.default.module("up.disintermediation.detection.service",[u.default]).provider("upDisintermediationDetectionService",["UP_DISINTERMEDIATION_DETECTION_SERVICE_PROVIDER_CLASS",function(e){var t=new e;this.configure=function(e){t.configure(e)},this.$get=function(){return t.provide()}}]).name},function(e,t,n){n(56),e.exports=n(5).Array.isArray},function(e,t){e.exports={payment:{title:"Considering making payments outside of Upwork?",note:'Keep your money safe. Only make payments through Upwork. Don’t risk losing sleep or Upwork <a href="https://www.upwork.com/hiring/for-clients/payments-and-productivity-on-upwork/#protection" target="_blank">Payment Protection</a>'},messaging:{title:"Want to have a voice or video chat?",note:"Simplify conversations. Interview freelancers over voice & video chat using Upwork Messages."},contactInfo:{title:"Taking your conversations outside of Upwork?",note:"Stay safe. Get added protection by keeping conversations on Upwork."}}},function(e,t){e.exports={payment:{title:"Considering getting paid outside of Upwork?",note:'If you are – consider this:<br /><ol><li>Upwork provides <a href="https://www.upwork.com/hiring/for-clients/payments-and-productivity-on-upwork/#protection" target="_blank">Payment Protection</a>, which means we will make sure your client pays you for work completed.</li><li>If you get paid outside Upwork, you won\'t get a chance to build up client feedback on your profile.</li><li>It\'s against our <a href="https://www.upwork.com/blog/2016/09/five-things-upwork-terms-service/" target="_blank">Terms of Service</a> to do this, and we reserve the right to close your account.</li></ol>'},messaging:{title:"Want to have a voice or video chat?",note:"Did you know you can have voice and video chats through Upwork Messages?"},contactInfo:{title:"Taking your conversations outside of Upwork?",note:"Stay safe and secure by keeping your conversations on Upwork."}}},function(e,t){e.exports={payment:{title:"Have your heard about Payment Protection?",note:'Keep your money safe. After you hire, only make payments through Upwork. Don’t risk losing sleep or Upwork <a href="https://www.upwork.com/hiring/for-clients/payments-and-productivity-on-upwork/#protection" target="_blank">Payment Protection</a>'},messaging:{title:"Have you tried Upwork Messages?",note:"Simplify conversations. After you post this job, use Upwork Messages to hold voice or video interviews."},contactInfo:{title:"Have you tried Upwork Messages?",note:"Stay safe. Once you post this job, you’ll get added protection by keeping conversations on Upwork."}}},function(e,t){e.exports={payment:{title:"Considering making payments outside of Upwork?",note:'Keep your money safe. Only make payments through Upwork. Don’t risk losing sleep or Upwork <a href="https://www.upwork.com/hiring/for-clients/payments-and-productivity-on-upwork/#protection" target="_blank">Payment Protection</a>'},messaging:{title:"Want to have a voice or video chat?",note:"Simplify conversations. Have voice & video chat through Upwork Messages. It’s built into your workspace."},contactInfo:{title:"Taking your conversations outside of Upwork?",note:"Stay safe. Get added protection by keeping conversations on Upwork."}}},function(e,t){e.exports={payment:{title:"Considering getting paid outside of Upwork?",note:'If you are – consider this:<br /><ol><li>Upwork provides <a href="https://www.upwork.com/hiring/for-clients/payments-and-productivity-on-upwork/#protection" target="_blank">Payment Protection</a>, which means we will make sure your client pays you for work completed.</li><li>If you get paid outside Upwork, you won\'t get a chance to build up client feedback on your profile.</li><li>It\'s against our <a href="https://www.upwork.com/blog/2016/09/five-things-upwork-terms-service/" target="_blank">Terms of Service</a> to do this, and we reserve the right to close your account.</li></ol>'},messaging:{title:"Want to have a voice or video chat?",note:"Simplify conversations. Make voice & video chat through Upwork Messages. It’s built into your workspace."},contactInfo:{title:"Taking your conversations outside of Upwork?",note:"Stay safe. Get added protection by keeping conversations on Upwork."}}},function(e,t){e.exports={payment:{name:"payment",disallow:["\\bVenmo","\\bPayoneer","\\bSkrill","\\bWire\\W?Transfer","\\bWestern\\W?Union","\\bDirect\\W?Deposit","\\bACH\\b","\\b[bB]ank\\W?[aA]ccount","\\bp[@a]y\\W?p[@a]l","\\bMoneybookers","\\bPayza","\\bPerfectmoney","\\bWebmoney","\\bBitcoin","\\bMoney\\W?gram","\\bMoneygram","\\bSique\\W?coinstar","\\bPerfect\\W?Money"]},messaging:{name:"messaging",disallow:["\\bskype","\\bhangouts?","\\bSlack"]},contactInfo:{name:"contactInfo",disallow:["([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z0-9._-]+)","(?:(\\+)?\\d{1,3}[-\\040.]?)?\\(?\\d{3}\\)?[-\\040.]?\\d{3}[-\\040.]?\\d{4}([,;]*[0-9]+#?)*"],allow:["@cloud.upwork.com","@upwork.com"]}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=o(r),a=n(66),u=o(a);t.default=i.default.module("up.disintermediation.highlighter.config.service",[]).provider("upDisintermediationHighlighterConfig",[function(){var e={template:u.default,popoverEnabled:!1};this.configure=function(t){i.default.extend(e,t)},this.$get=function(){return e}}]).name},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(12),u=o(a),s=n(13),c=o(s),l=n(51),f=o(l),d=function(){function e(){r(this,e),this.rules=(0,u.default)({},f.default)}return i(e,[{key:"configure",value:function(e){return e=e||{},this.rules=(0,u.default)(f.default,e),this}},{key:"provide",value:function(){return new c.default(this.rules)}}]),e}();t.default=d},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return e&&"object"===(void 0===e?"undefined":s(e))&&!(0,p.default)(e)}function u(e,t){var n=(0,f.default)({},e);return a(e)&&a(t)&&Object.keys(t).forEach(function(o){a(t[o])&&o in e?n[o]=u(e[o],t[o]):(0,f.default)(n,r({},o,t[o]))}),n}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(12),f=o(l),d=n(45),p=o(d),g=n(14),y=o(g),h=n(7),v=o(h),m=n(47),w=o(m),b=n(46),_=o(b),k=n(50),x=o(k),P=n(49),S=o(P),D=n(48),M=o(D),C={Default:{Default:v.default},JobPost:{Default:M.default},Invite:{Freelancer:w.default,Client:_.default},Offer:{Freelancer:w.default,Client:_.default},Rehire:{Freelancer:w.default,Client:_.default},Productivity:{Freelancer:x.default,Client:S.default}},E=function(){function e(){i(this,e),this._userContext="Default",this._appContext="Default",this._messaging=(0,f.default)({},C)}return c(e,[{key:"configure",value:function(e){e&&(this._userContext=e.userContext||this._userContext,this._appContext=e.appContext||this._appContext,e.messaging&&(this._messaging=u(this._messaging,e.messaging)))}},{key:"provide",value:function(){return new y.default(this._messaging).setAppContext(this._appContext).setUserContext(this._userContext)}}]),e}();t.default=E},function(e,t,n){var o=n(15);e.exports=Array.isArray||function(e){return"Array"==o(e)}},function(e,t,n){var o=n(16);o(o.S,"Array",{isArray:n(55)})},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(43),u=o(a),s=function(){function e(){r(this,e)}return i(e,[{key:"configure",value:function(){}},{key:"provide",value:function(){return new u.default}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="1.7.3"},function(e,t){},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsServiceProvider=t.AnalyticsService=t.MessageServiceProvider=t.MessageService=t.DetectionServiceProvider=t.DetectionService=t.Category=t.VERSION=void 0;var r=n(58),i=o(r),a=n(6),u=o(a),s=n(13),c=o(s),l=n(53),f=o(l),d=n(14),p=o(d),g=n(54),y=o(g),h=n(43),v=o(h),m=n(57),w=o(m);t.VERSION=i.default,t.Category=u.default,t.DetectionService=c.default,t.DetectionServiceProvider=f.default,t.MessageService=p.default,t.MessageServiceProvider=y.default,t.AnalyticsService=v.default,t.AnalyticsServiceProvider=w.default},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=o(r),a=n(18),u=o(a),s=n(59);o(s);t.default=i.default.module("up.disintermediation.analytics.directive",[u.default]).directive("upDisintermediationAnalytics",["upDisintermediationAnalyticsService",function(e){return{restrict:"A",require:"upDisintermediation",controllerAs:"upDisintermediationAnalytics",link:function(t,n,o,r){var i={};t.$watch(function(){return r.detectedDisintermediation},function(t){if(t)for(var n=0;n<t.detections.length;n++){var o=t.detections[n];o.category&&"none"!==o.category&&!i[o.category]&&(e.report({context:r.getContext(),category:o.category,text:"contactInfo"===o.category?"[redacted]":o.text}),i[o.category]=!0)}})}}}]).name},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=o(r),a=n(17),u=o(a);t.default=i.default.module("up.disintermediation.analytics.service",[u.default]).provider("upDisintermediationAnalyticsService",["UP_DISINTERMEDIATION_ANALYTICS_SERVICE_PROVIDER_CLASS",function(e){var t=new e;this.configure=function(e){t.configure(e)},this.$get=function(){return t.provide()}}]).name},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=o(r),a=n(52),u=o(a),s=n(18),c=o(s),l=n(59);o(l);t.default=i.default.module("up.disintermediation.highlighter.directive",[u.default,c.default]).directive("upDisintermediationHighlighter",["$window","$compile","$timeout","upDisintermediationHighlighterConfig","upDisintermediationDetectionService","upDisintermediationMessageService",function(e,t,n,o,r,a){return{restrict:"A",require:["upDisintermediationHighlighter","upDisintermediation"],controllerAs:"upDisintermediationHighlighter",controller:["$scope",function(e){this.updateLayout=function(){e.updateLayout()}}],link:function(u,s,c,l){function f(){v[0].scrollTop=s[0].scrollTop}function d(){var t=e.getComputedStyle(s[0]),n=t.getPropertyValue("position"),o=+t.getPropertyValue("z-index")||1;n="absolute"===n?"absolute":"relative",v.css({"z-index":o-1,"box-sizing":t.getPropertyValue("box-sizing"),position:"absolute","border-width":t.getPropertyValue("border-width"),width:t.getPropertyValue("width"),height:t.getPropertyValue("height"),padding:t.getPropertyValue("padding"),background:t.getPropertyValue("background")}),s.css({position:n,background:"transparent","z-index":o})}var p=l[0],g=l[1],y=t(o.template),h=u.$new(!0),v=y(h),m=!1,w=function(){m||(m=!0,h.renderHighlighterCallout=!1,n(function(){h.renderHighlighterCallout=h.enableHighlighterCallout,f(),m=!1},10))};p.enablePopover=function(e){h.enableHighlighterCallout=!!e,w()},p.enablePopover(!!o.popoverEnabled),"upDisintermediationPopoverEnabled"in c&&c.$observe("upDisintermediationPopoverEnabled",function(e){var t=!!u.$eval(e);p.enablePopover(t)}),s.after(v),v.after(s),u.updateLayout=function(){var t=e.getComputedStyle(s[0]);v.css({"box-sizing":t.getPropertyValue("box-sizing"),"border-width":t.getPropertyValue("border-width"),width:t.getPropertyValue("width"),height:t.getPropertyValue("height"),padding:t.getPropertyValue("padding")}),f()},h.getDisintermediationMessaging=function(e){return a.getMessaging(e)},h.muteCategory=function(e){r.mute(e),g.detectDisintermediation()},u.$on("$destroy",function(){v.remove()}),s.on("$destroy",function(){h.$destroy(),v.remove()}),u.$watch(function(){return g.detectedDisintermediation},function(e){e&&(h.detections=e.detections,f(),h.$broadcast("window:resize"),w())}),s.on("scroll",f),s.on("mouseup",u.updateLayout),i.default.element(e).on("resize",u.updateLayout),u.$on("$destroy",function(){i.default.element(e).off("resize",u.updateLayout)}),n(function(){d(),u.updateLayout(),h.enableHighlighter=!0},200)}}}]).name},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=o(r),a=n(17),u=o(a);t.default=i.default.module("up.disintermediation.message.service",[u.default]).provider("upDisintermediationMessageService",["UP_DISINTERMEDIATION_MESSAGE_SERVICE_PROVIDER_CLASS",function(e){var t=new e;this.configure=function(e){t.configure(e)},this.$get=function(){return t.provide()}}]).name},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=o(r),a=n(44),u=o(a),s=n(18),c=o(s);t.default=i.default.module("up.disintermediation.validator.directive",[u.default,c.default]).directive("upDisintermediationValidator",["$window","upDisintermediationDetectionService",function(e,t){return{restrict:"A",require:["ngModel","upDisintermediation","?upDisintermediationHighlighter"],link:function(e,n,o,r){var i=r[0],a=r[1],u=r[2];t.getCategories().forEach(function(e){i.$validators[e.name]=function(){return!(a.detectedDisintermediation&&a.detectedDisintermediation.types&&a.detectedDisintermediation.types[e.name])}}),e.$watch(function(){return a.detectedDisintermediation},function(){i.$validate(),u&&u.updateLayout()})}}}]).name},function(e,t){e.exports='<div class=up-disintermediation-highlighter ng-show=enableHighlighter><span ng-repeat="detection in detections" ng-switch=detection.category><span ng-switch-when=none>{{detection.text}}</span><mark ng-switch-default class={{detection.category}}>{{detection.text}}</mark></span><br/></div>'},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=o(r),a=n(70),u=o(a),s=n(69),c=o(s),l=n(52),f=o(l);t.default=i.default.module("up.disintermediation.highlighter.upwork.configuration",[f.default]).config(["$provide","upDisintermediationHighlighterConfigProvider",function(e,t){t.configure({template:u.default}),e.decorator("upDisintermediationAnalyticsService",["$delegate","oGaManager",function(e,t){return e.report=function(e){var n={event:"disintermediation_event",category:"Web:Dash:Disintermediation",action:e.category,label:e.text,context:e.context};t.push(n)},e}])}]).run(["$templateCache",function(e){e.put("up-disintermediation-callout-popover.html",c.default)}]).name},function(e,t){},function(e,t){e.exports="<div><h4 ng-bind-html=getDisintermediationMessaging(detection.category).title></h4><p ng-bind-html=getDisintermediationMessaging(detection.category).note></p></div>"},function(e,t){e.exports='<div class=up-disintermediation-highlighter ng-show=enableHighlighter><span ng-repeat="detection in detections track by detection.text + $index" ng-switch=detection.category><span ng-switch-when=none>{{detection.text}}</span><mark ng-switch-default class={{detection.category}}><span ng-switch="(enableHighlighterCallout && detection.detectionIndex === 0).toString()"><span ng-switch-when=true eo-popover=up-disintermediation-callout-popover.html eo-popover-append-to-body=true eo-popover-placement=top-left eo-popover-is-open=renderHighlighterCallout eo-popover-auto-close=false eo-popover-dynamic-position=true eo-popover-watch-content=true eo-popover-size=lg>{{detection.text}}</span><span ng-switch-default>{{detection.text}}</span></span></mark></span><br/></div>'},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=o(r),a=n(17),u=o(a),s=n(62),c=o(s),l=n(44),f=o(l),d=n(64),p=o(d),g=n(18),y=o(g),h=n(61),v=o(h),m=n(65),w=o(m),b=n(52),_=o(b),k=n(63),x=o(k),P=n(67),S=o(P),D=n(68);o(D);t.default=i.default.module("up.disintermediation",[u.default,c.default,f.default,p.default,y.default,v.default,w.default,_.default,x.default,S.default]).name}])});
(function(ng,applet){"use strict";ng.module("interviewInvitation",["components.core.alert","components.core.modal","components.core.log","components.core.popover","components.core.storage","components.core.block","components.core.select","components.core.templates"]).value("INTERVIEW_INVITATION_CLIENT_NAME","").constant("INTERVIEW_INVITATION_STORAGE_KEY_PREFIX","interview-invitation").constant("INTERVIEW_INVITATION_LOG_SUBLOCATION","invite_modal").constant("INTERVIEW_INVITATION_BUTTON_TITLE","Invite to Job").constant("INTERVIEW_INVITATION_ALERT_ERROR_TIMEOUT",3e4).constant("INTERVIEW_INVITATION_STORAGE_TEMPLATE_KEY_PREFIX","interview-invitation:job-template:").constant("INTERVIEW_INVITATION_API_URL_PREFIX",applet.getBasePath()+"/api/")})(angular,Applet);
(function(ng,applet){"use strict";var module=ng.module("interviewInvitation");module.directive("interviewInvitationButton",interviewInvitationButton);interviewInvitationButton.$inject=["interviewInvitationService","INTERVIEW_INVITATION_BUTTON_TITLE","INTERVIEW_INVITATION_LOG_SUBLOCATION"];function interviewInvitationButton(service,INTERVIEW_INVITATION_BUTTON_TITLE,INTERVIEW_INVITATION_LOG_SUBLOCATION){return{controller:controller,link:link,templateUrl:applet.buildInternalAssetPath("@OdeskInterviewInvitationBundle/js/invitation/button.html"),scope:{openingUid:"=?",userUid:"=",userCiphertext:"=",userAvatarUrl:"=",userName:"=",userTitle:"=",userProfileUrl:"@",eventLogLocation:"@",eventLogSublocation:"<?",userAgency:"=?",clientOpenJobs:"=?",isShowCreateJobLink:"=?",callbackOnSuccess:"&?",appendToBody:"@?",buttonTitle:"@?",popoverPlacement:"@?",btnClass:"@?",jobPostKvl:"@?"},require:"?^^logLocation"};function controller($scope){$scope.appendToBody=$scope.appendToBody===undefined?true:$scope.appendToBody;$scope.buttonTitle=$scope.buttonTitle||INTERVIEW_INVITATION_BUTTON_TITLE;$scope.isFreelancerInvited=service.isFreelancerInvited;$scope.eventLogSublocation=$scope.eventLogSublocation||INTERVIEW_INVITATION_LOG_SUBLOCATION;$scope.popoverTemplateUrl=applet.buildInternalAssetPath("@OdeskInterviewInvitationBundle/js/invitation/form.html");$scope.popoverPlacement=ng.isDefined($scope.popoverPlacement)?$scope.popoverPlacement:"left";$scope.btnClass=$scope.btnClass||"btn btn-block btn-primary btn-sm m-0-top m-0-left-right m-sm-bottom"}function link($scope,$element,$attrs,logLocationController){$scope.hasOpeningUid=false;if(ng.isDefined($attrs.openingUid)){$scope.hasOpeningUid=Boolean($scope.openingUid);var unwatchOpeningUid=$scope.$watch("openingUid",function(newValue){$scope.hasOpeningUid=Boolean(newValue);if(ng.isDefined(newValue)){unwatchOpeningUid()}})}$scope.iconSize=$element.hasClass("btn-lg")?"md":"sm";$scope.popoverOpen=function($event){$event.preventDefault()};$scope.$watch("isPopoverOpen",function(newVal){if(newVal===false&&!$scope.isLoading){$scope.logEvent("click","cancel",[])}else if(newVal===true){$scope.logEvent("impression","invite",[])}});$scope.logEvent=function(event,label,data){if(logLocationController){logLocationController.log(event,data,label,$scope.eventLogSublocation)}}}}})(angular,Applet);
(function(ng,applet){"use strict";var module=ng.module("interviewInvitation");module.service("inviteAlertService",inviteAlertService);inviteAlertService.$inject=["$rootScope","$timeout","eoAlert","ALERT_INLINE_DEFAULT_SETTINGS","INTERVIEW_INVITATION_ALERT_ERROR_TIMEOUT"];function inviteAlertService($rootScope,$timeout,eoAlert,ALERT_INLINE_DEFAULT_SETTINGS,INTERVIEW_INVITATION_ALERT_ERROR_TIMEOUT){var alertPool={};return{getInvitationAlert:getInvitationAlert};function getInvitationAlert(freelancerUid,freelancerName,retryFunction){if(alertPool[freelancerUid]){alertPool[freelancerUid].setNewParameters(retryFunction)}else{alertPool[freelancerUid]=new InvitationAlert(freelancerUid,freelancerName,retryFunction)}return alertPool[freelancerUid]}function notifyAlertInstanceDestroyed(freelancerUid){alertPool[freelancerUid]=null}function InvitationAlert(freelancerUid,userName,retryFunction){var instance=null;var alertScope=null;var self=this;var instanceCount=0;setNewParameters(retryFunction);this.setNewParameters=setNewParameters;function setNewParameters(retryFunction){instanceCount++;if(!alertScope){alertScope=$rootScope.$new(true)}alertScope.retry=retryFunction;alertScope.userName=userName}this.removeAlert=function(){if(instance){instance.remove()}};this.showPendingAlert=function(){updateAlert("info","pending",null)};this.showExceptionSent=function(){updateAlert("success","success",null,"exceptionRequested")};this.setSuccessAlert=function(){updateAlert("success","success",null,"invitationSent")};this.setErrorState=function(errorState){var isWarning=errorState.type==="warning";updateAlert(isWarning?"warning":"danger","error",errorState.text);if(isWarning){this.hideAfterDelay()}else{this.hideAfterDelay(INTERVIEW_INVITATION_ALERT_ERROR_TIMEOUT)}};this.hideAfterDelay=function(customTimeout){var index=instanceCount;$timeout(function(){if(index===instanceCount){self.removeAlert()}},customTimeout||ALERT_INLINE_DEFAULT_SETTINGS.duration)};function updateAlert(alertType,state,errorText,messageType){if(!alertScope){return}alertScope.state=state;alertScope.errorText=errorText;alertScope.messageType=messageType;alertScope.isWarning=alertType==="warning";if(instance){instance.update({type:alertType})}else{instance=eoAlert.inline({templateUrl:applet.buildInternalAssetPath("@OdeskInterviewInvitationBundle/js/invitation/alert-progress.html"),scope:alertScope,duration:0,type:alertType});instance.$removed.then(function(){instance=null;if(alertScope){alertScope.$destroy()}alertScope=null;notifyAlertInstanceDestroyed(freelancerUid)})}}}}})(angular,Applet);
(function(ng,applet){"use strict";var module=ng.module("interviewInvitation"),savedSelections={};module.controller("interviewInvitationController",interviewInvitationController);interviewInvitationController.$inject=["$scope","$httpParamSerializer","inviteAlertService","interviewInvitationService","invitationsLimitService","invitationTemplateService"];function interviewInvitationController($scope,$httpParamSerializer,inviteAlertService,interviewInvitationService,invitationsLimitService,invitationTemplateService){var inviteCtrl=this;var defaultMsgTemplate=invitationTemplateService.getDefaultMessage();var orgRid=applet.getOrganization()?applet.getOrganization().getRid():null;inviteCtrl.inProgressError=false;inviteCtrl.selectedJob=null;inviteCtrl.isLoading=false;inviteCtrl.isShowCreateJobLink=false;inviteCtrl.userCiphertext=$scope.userCiphertext;inviteCtrl.onFormSubmit=onFormSubmit;inviteCtrl.getLinkCreateNewJob=getLinkCreateNewJob;inviteCtrl.getInvitationStatus=getInvitationStatus;inviteCtrl.logEvent=logEvent;inviteCtrl.resetMsgIsShown=resetMsgIsShown;inviteCtrl.resetMsg=resetMsg;inviteCtrl.isAgencyContractor=$scope.userAgency?Boolean(Object.getOwnPropertyNames($scope.userAgency).length):false;if($scope.clientOpenJobs&&$scope.clientOpenJobs.length){inviteCtrl.selectedJob=savedSelections[$scope.userUid]||$scope.clientOpenJobs[0];inviteCtrl.getInvitationStatus()}if($scope.isShowCreateJobLink){interviewInvitationService.getProfileState($scope.userUid).then(function(state){inviteCtrl.isShowCreateJobLink=state==="Accepted"})}function getUid(){return inviteCtrl.selectedJob?inviteCtrl.selectedJob.uid:$scope.openingUid}function onFormSubmit(){var openingUid=inviteCtrl.selectedJob?inviteCtrl.selectedJob.uid:$scope.openingUid;sendInvitation(openingUid);inviteCtrl.logEvent("click","send_invite");$scope.$parent.close()}function logEvent(event,label){if($scope.$parent&&ng.isFunction($scope.$parent.logEvent)){var logData={};if($scope.hasOpeningUid||inviteCtrl.selectedJob){logData.opening=$scope.hasOpeningUid?$scope.openingUid:inviteCtrl.selectedJob.uid}$scope.$parent.logEvent(event,label,[logData])}}inviteCtrl.message=invitationTemplateService.getInitMessage(getUid());$scope.$watch("inviteCtrl.selectedJob",function(value){savedSelections[$scope.userUid]=value;inviteCtrl.message=invitationTemplateService.getInitMessage(getUid())});$scope.$watch("inviteCtrl.message",function(value){invitationTemplateService.setInvitationTemplate(getUid(),value)});function getLinkCreateNewJob(ciphertext){var companyRef=orgRid?"/"+orgRid:"";var link="/e"+companyRef+"/jobs/invite/"+ciphertext;var queryParams={new_job:1};if($scope.jobPostKvl){queryParams["dataFrom"]=$scope.jobPostKvl}if(Object.keys(queryParams).length){link+="?"+$httpParamSerializer(queryParams)}return link}function getSendInvitationCallback(openingUid){return function(){return sendInvitation(openingUid)}}function sendInvitation(openingUid){inviteCtrl.isLoading=true;var alertInstance=inviteAlertService.getInvitationAlert($scope.userUid,$scope.userName,getSendInvitationCallback(openingUid));alertInstance.showPendingAlert();if(openingUid){interviewInvitationService.sendInvite(openingUid,$scope.userUid,inviteCtrl.message).then(function(){alertInstance.setSuccessAlert();alertInstance.hideAfterDelay();if($scope.callbackOnSuccess&&ng.isFunction($scope.callbackOnSuccess)){$scope.callbackOnSuccess({data:{openingUid:openingUid,openingTitle:inviteCtrl.selectedJob?inviteCtrl.selectedJob.title:null}})}},function(error){if(error.exceptionName==="exception.verified-invite-quota"){alertInstance.removeAlert();invitationsLimitService.showDialog(alertInstance)}else{alertInstance.setErrorState(error)}}).finally(function(){inviteCtrl.isLoading=false})}else{alertInstance.setErrorState({type:"warning",text:null})}}function getInvitationStatus(isLogEvent){inviteCtrl.error=false;inviteCtrl.inProgressError=false;if(inviteCtrl.selectedJob&&inviteCtrl.selectedJob.uid){inviteCtrl.isSectionLoading=true;interviewInvitationService.getInvitationStatus(inviteCtrl.selectedJob.uid,$scope.userUid).then(function(response){inviteCtrl.inProgressError=response.data&&response.data.type==="exception.interview-in-progress"}).finally(function(){inviteCtrl.isSectionLoading=false})}if(isLogEvent){inviteCtrl.logEvent("change","select_job")}}function resetMsgIsShown(){return inviteCtrl.message!==defaultMsgTemplate}function resetMsg(){invitationTemplateService.resetInvitationTemplate(getUid());inviteCtrl.message=defaultMsgTemplate}}})(angular,Applet);
(function(ng){"use strict";var module=ng.module("interviewInvitation");module.service("invitationTemplateService",invitationTemplateService);invitationTemplateService.$inject=["eoStorage","INTERVIEW_INVITATION_STORAGE_TEMPLATE_KEY_PREFIX","INTERVIEW_INVITATION_CLIENT_NAME"];function invitationTemplateService(eoStorage,INTERVIEW_INVITATION_STORAGE_TEMPLATE_KEY_PREFIX,INTERVIEW_INVITATION_CLIENT_NAME){var defaultMsg="Hello!\n\n"+"I'd like to invite you to apply to my job. Please review the job post and apply if you're available.\n\n"+(INTERVIEW_INVITATION_CLIENT_NAME?INTERVIEW_INVITATION_CLIENT_NAME:"");return{getDefaultMessage:function(){return defaultMsg},getInitMessage:function(jobUid){return this.getInvitationTemplate(jobUid)||defaultMsg},getInvitationTemplate:function(jobUid){return eoStorage.getItem(INTERVIEW_INVITATION_STORAGE_TEMPLATE_KEY_PREFIX+jobUid)},setInvitationTemplate:function(jobUid,msg){if(msg&&msg!==defaultMsg){eoStorage.setItem(INTERVIEW_INVITATION_STORAGE_TEMPLATE_KEY_PREFIX+jobUid,msg)}else if(msg===defaultMsg&&this.getInvitationTemplate(jobUid)){this.resetInvitationTemplate(jobUid)}},resetInvitationTemplate:function(jobUid){eoStorage.removeItem(INTERVIEW_INVITATION_STORAGE_TEMPLATE_KEY_PREFIX+jobUid)}}}})(angular);
(function(ng,applet){"use strict";var module=ng.module("interviewInvitation");module.service("invitationsLimitService",requestExceptionService);requestExceptionService.$inject=["$http","eoModal","oLog","eoModelFactory","INTERVIEW_INVITATION_API_URL_PREFIX","INTERVIEW_INVITATION_LOG_SUBLOCATION"];function requestExceptionService($http,eoModal,oLog,eoModelFactory,INTERVIEW_INVITATION_API_URL_PREFIX,INTERVIEW_INVITATION_LOG_SUBLOCATION){return{showDialog:function(){eoModal.custom({templateUrl:applet.buildInternalAssetPath("@OdeskInterviewInvitationBundle/js/invitation/request-exception-form.html"),controllerAs:"$this",controller:["$modalInstance","inviteAlertService","$scope",function($modalInstance,inviteAlertService,$scope){this.cancel=function(result){$modalInstance.close()};this.success=function(result){var alertInstance=inviteAlertService.getInvitationAlert($scope.userUid,$scope.userName,function(){});alertInstance.showExceptionSent();alertInstance.hideAfterDelay();$modalInstance.close(true)};this.submit=function(){this.dirty=true;if(this.message){this.sending=true;sendLimitEventLog("click","invite_request_exception");sendExceptionRequest(this.message).then(this.success,this.cancel)}}.bind(this)}],keyboard:false,size:"lg"})}};function getEndpointUrl(uri){return INTERVIEW_INVITATION_API_URL_PREFIX+uri}function sendLimitEventLog(event,location){oLog.event(eoModelFactory.get("Event",{event:event,location:location,sublocation:INTERVIEW_INVITATION_LOG_SUBLOCATION,data:[{stack:"modernized"}]}))}function sendExceptionRequest(message){return $http({url:getEndpointUrl("interview-invitation/request-exception"),method:"POST",data:{message:message}}).then(function(response){return response&&response.data?response.data:{}})}}})(angular,Applet);
(function(ng){"use strict";var module=ng.module("interviewInvitation");module.service("interviewInvitationService",interviewInvitationService);interviewInvitationService.$inject=["$q","$window","$http","$httpParamSerializer","eoStorage","INTERVIEW_INVITATION_STORAGE_KEY_PREFIX","INTERVIEW_INVITATION_API_URL_PREFIX"];function interviewInvitationService($q,$window,$http,$httpParamSerializer,eoStorage,INTERVIEW_INVITATION_STORAGE_KEY_PREFIX,INTERVIEW_INVITATION_API_URL_PREFIX){var invitedFreelancers={},freelancerProfileStates={};return{sendInvite:sendInvite,isFreelancerInvited:isFreelancerInvited,getInvitationStatus:getInvitationStatus,getProfileState:getProfileState,clearInvitation:clearInvitation};function sendInvite(openingUid,freelancerUid,message){return $http({url:getEndpointUrl("interview-invitation/opening/"+openingUid+"/invite"),method:"POST",data:$httpParamSerializer({freelancerUid:freelancerUid,message:message,currentUrl:$window.location.href}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(){setFreelancerAsInvited(openingUid,freelancerUid)},function(response){var errorType=response.data.type;var error={text:response.data.text,exceptionName:errorType};if(errorType==="exception.interview-in-progress"||errorType==="exception.dupe-referal"){setFreelancerAsInvited(openingUid,freelancerUid);error.type="warning"}else{error.type="danger"}return $q.reject(error)})}function getInvitationStatus(openingUid,freelancerUid){if(isFreelancerInvited(openingUid,freelancerUid)){return $q.resolve({data:{type:"exception.interview-in-progress"}})}return $http({url:getEndpointUrl("interview-invitation/opening/"+openingUid+"/invite/"+freelancerUid+"/status"),method:"GET"}).then(function(response){if(response&&response.data&&response.data.hasInvite&&response.data.type==="exception.interview-in-progress"){setFreelancerAsInvited(openingUid,freelancerUid)}return response})}function getProfileState(freelancerUid){if(freelancerProfileStates[freelancerUid]){return $q.resolve(freelancerProfileStates[freelancerUid])}return $http({url:getEndpointUrl("interview-invitation/profile/"+freelancerUid+"/state"),method:"GET"}).then(function(data){freelancerProfileStates[freelancerUid]=data.data;return $q.resolve(data.data)},function(){return $q.reject("")})}function isFreelancerInvited(openingUid,freelancerUid){var key=[openingUid,freelancerUid].join("-");if(ng.isDefined(invitedFreelancers[key])){return invitedFreelancers[key]}else{var isInvited=!!eoStorage.getItem(getStorageKey(openingUid,freelancerUid));invitedFreelancers[key]=isInvited;return isInvited}}function setFreelancerAsInvited(openingUid,freelancerUid){invitedFreelancers[[openingUid,freelancerUid].join("-")]=true;eoStorage.setItem(getStorageKey(openingUid,freelancerUid),true)}function clearInvitation(openingUid,freelancerUid){invitedFreelancers[[openingUid,freelancerUid].join("-")]=null;eoStorage.removeItem(getStorageKey(openingUid,freelancerUid))}function getStorageKey(openingUid,freelancerUid){return[INTERVIEW_INVITATION_STORAGE_KEY_PREFIX,openingUid,freelancerUid].join("-")}function getEndpointUrl(uri){return INTERVIEW_INVITATION_API_URL_PREFIX+uri}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile",["freelancer.tile.common","freelancer.tile.filters","freelancer.tile.models"]).constant("FREELANCER_TILE_TRUNCATE_CITY_CHARS",11).value("FREELANCER_TILE_RECENT_EARNINGS_ENABLED",false).value("FREELANCER_TILE_IS_US_AGENCIES_ENABLED",false)})(angular);
(function(ng){var models=ng.module("freelancer.tile.models",["components.core.model"]);models.run(["eoModelRegistry",function(eoModelRegistry){var Base=eoModelRegistry.get("Base");var FreelancerTileProfile=Base.extend({profileUid:null,profileRid:null,ciphertext:null,shortName:null,title:null,description:null,shortNameSanitized:null,titleSanitized:null,descriptionSanitized:null,portrait:null,profileUrl:null,isRecommended:false,recommendedOpeningTitle:null,isInvited:false,invitedJobsList:null,isAgencyContractor:false,location:null,totalPassedTests:null,totalPortfolioItems:null,topRatedStatus:null,jobSuccessScore:null,hideJss:null,totalHours:null,combinedRevenue:null,combinedEarnings:null,hideEarnings:null,hourlyJobs:null,fpJobs:null,hourlyRate:null,fixedAmount:null,rankInfo:null,skills:null,agency:null,latestContract:null,groups:null,jobSummariesRids:null,combinedRecentEarnings:null,combinedAverageRecentEarnings:null,clientIsBlocked:null,init:function(obj){if(typeof obj!=="undefined"){this._super(obj)}this.hideEarnings=normalizedBooleanIsTrue(this.hideEarnings);this.hideJss=normalizedBooleanIsTrue(this.hideJss)}});var FreelancerTileAgency=Base.extend({ciphertext:null,name:null,summary:null,profileUrl:null,description:null,nameSanitized:null,summarySanitized:null,descriptionSanitized:null,portrait:null,location:null,totalHours:null,combinedRevenue:null,hourlyJobs:null,fpJobs:null,topRatedStatus:null,jobSuccessScore:null,minRate:null,maxRate:null,init:function(obj){if(typeof obj!=="undefined"){this._super(obj)}}});var FreelancerTileContract=Base.extend({contractRid:null,hourlyRate:null,totalAmount:null,contractType:null,title:null,feedbackScore:null,feedbackComment:null});eoModelRegistry.put("FreelancerTileProfile",FreelancerTileProfile);eoModelRegistry.put("FreelancerTileAgency",FreelancerTileAgency);eoModelRegistry.put("FreelancerTileContract",FreelancerTileContract);function normalizedBooleanIsTrue(value){if(ng.isString(value)){return value==="true"||value==="1"}return Boolean(value)}}])})(angular);
(function(ng,applet){"use strict";var module=ng.module("freelancer.tile.common",["components.core.jobsuccess","components.core.storage","components.core.popover","components.core.utils","components.core.truncation","ngCookies"]).constant("FREELANCER_TILE_IS_SHOW_PRESENCE",true).value("REPLACE_REVENUE_BY_EARNINGS_ENABLED",false);module.service("freelancerTileConfig",freelancerTileConfig);freelancerTileConfig.$inject=["$window"];function freelancerTileConfig($window){var applet=$window.Applet;var initConfig=applet.getVar("freelancerTileExt")||{};var tileSwitcherCookieName=applet.getVar("freelancerTileSwitcherMode")||null;this.getViewPath=function(path){return applet.buildInternalAssetPath("@OdeskFreelancerTileBundle"+path)};this.getValue=function(name){return ng.isDefined(initConfig[name])?initConfig[name]:null};this.getTileSwitcherCookieName=function(){return ng.isDefined(tileSwitcherCookieName)?tileSwitcherCookieName:"freelancerTileSwitcherMode"}}})(angular,Applet);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerAvatar",freelancerAvatar);freelancerAvatar.$inject=["FREELANCER_TILE_IS_SHOW_PRESENCE"];function freelancerAvatar(FREELANCER_TILE_IS_SHOW_PRESENCE){return{templateUrl:Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/avatar/avatar.html"),scope:{photoUrl:"@",name:"@",isAgencyProfile:"<",detailsUrl:"@",userIndicatorId:"@?",size:"@?",preventNavigation:"<?"},link:link};function link($scope){$scope.isPresenceEnabled=!$scope.isAgencyProfile&&ng.isDefined($scope.userIndicatorId)&&FREELANCER_TILE_IS_SHOW_PRESENCE;var size=["large","medium","small","small-plus"].indexOf($scope.size)===-1?"large":$scope.size;$scope.isLarge=size==="large";$scope.isMedium=size==="medium";$scope.isSmall=size==="small";$scope.isSmallPlus=size==="small-plus"}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerTileContractLine",contractLine);contractLine.$inject=["freelancerTileConfig"];function contractLine(config){return{link:link,templateUrl:config.getViewPath("/js/common/contract-line/contract-line.html"),scope:{contract:"<"}};function link($scope){$scope.isHourly=$scope.contract.contractType==="hourly";$scope.isFixedPrice=$scope.contract.contractType==="fixed"}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerDescription",description);function description(){return{templateUrl:Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/description/description.html"),replace:false,scope:{charsThreshold:"@",profileDescription:"<",useSanitizedUserData:"<?"}}}})(angular);
(function(ng,applet){"use strict";ng.module("freelancer.tile.common").directive("freelancerEarningsV2",earnings);function earnings(){return{templateUrl:applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/earnings-v2/earnings.html"),link:earningsLink,scope:{combinedValue:"<",isRecentEarnings:"<"}};function earningsLink($scope){var isRecentEarnings=$scope.isRecentEarnings===true;$scope.combinedText=isRecentEarnings?"recent earnings":"avg. job earnings";$scope.earningsPopoverTemplate=isRecentEarnings?"Amount earned in the past 6 months.":"Includes completed and ongoing projects from the past 6 months."}}})(angular,Applet);
(function(ng,applet){"use strict";function getPopoverItem(value,label,singleLabel){if(!value){return null}value=Math.round(value);if(isNaN(value)||!value){value="No"}return value+' <span class="text-muted">'+(value===1?singleLabel:label)+"</span>"}ng.module("freelancer.tile.common").directive("freelancerEarnings",earnings);earnings.$inject=["REPLACE_REVENUE_BY_EARNINGS_ENABLED"];function earnings(REPLACE_REVENUE_BY_EARNINGS_ENABLED){return{templateUrl:applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/earnings/earnings.html"),link:earningsLink,scope:{combinedRevenue:"@",combinedEarnings:"@",hourlyJobs:"@",fpJobs:"@",totalHours:"@"}};function earningsLink($scope){$scope.earningsPopoverTemplate=[getPopoverItem($scope.hourlyJobs,"hourly jobs","hourly job"),getPopoverItem($scope.fpJobs,"fixed price jobs","fixed price job"),getPopoverItem($scope.totalHours,"hours worked","hour worked")].filter(Boolean).join("<br />");$scope.earnings=REPLACE_REVENUE_BY_EARNINGS_ENABLED?$scope.combinedEarnings:$scope.combinedRevenue}}})(angular,Applet);
(function(ng){"use strict";var module=ng.module("freelancer.tile.common");module.directive("freelancerTilePlaceholder",tilePlaceholder);tilePlaceholder.$inject=["freelancerTileSwitcherService","freelancerTileConfig"];function tilePlaceholder(switcherService,config){return{restrict:"A",link:link,templateUrl:config.getViewPath("/js/common/freelancer-tile-placeholder/freelancer-tile-placeholder.html"),scope:{index:"@freelancerTilePlaceholder",forceViewMode:"@?"}};function link($scope){if($scope.forceViewMode){$scope.currentMode=$scope.forceViewMode}else{$scope.currentMode=switcherService.getMode();var updatePlaceholderMode=function(mode){$scope.currentMode=mode};switcherService.registerObserverCallback(updatePlaceholderMode)}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerGroupsList",freelancerGroupsList);function freelancerGroupsList(){return{templateUrl:Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/groups-list/groups-list.html"),scope:{freelancerGroupsList:"<",groupsToTruncate:"@",detailsUrl:"@",groupClicked:"&?",preventNavigation:"<?"},link:function(scope){scope.showDots=function(){return scope.freelancerGroupsList&&scope.freelancerGroupsList.length>scope.groupsToTruncate}}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerHours",hours);function hours(){return{templateUrl:Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/hours/hours.html"),scope:{totalHours:"@"}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerInvitationBadge",freelancerInvitationBadge);freelancerInvitationBadge.$inject=["freelancerTileConfig"];function freelancerInvitationBadge(config){return{templateUrl:config.getViewPath("/js/common/invitation-badge/invitation-badge.html"),scope:{showInvitedOpeningList:"<",invitedJobsList:"<",isAgencyProfile:"<?"},link:link};function link($scope){$scope.popoverTemplateUrl=config.getViewPath("/js/common/invitation-badge/popover.html")}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerJobSuccessScoreV2",freelancerJobSuccessScoreV2);freelancerJobSuccessScoreV2.$inject=["freelancerTileConfig"];function freelancerJobSuccessScoreV2(config){return{templateUrl:config.getViewPath("/js/common/job-success-v2/job-success-v2.html"),scope:{freelancerJobSuccessScoreV2:"@",isAgencyProfile:"<?",popoverClose:"@?",hideJss:"<?",popoverPlacement:"@?",topRated:"@"},link:link};function link($scope){$scope.freelancerJobSuccessScorePercentage=getScorePercentage($scope.freelancerJobSuccessScoreV2);$scope.popoverTemplateUrl=config.getViewPath("/js/common/job-success-v2/popover.html");$scope.popoverPlacement=$scope.popoverPlacement||"left";$scope.isJobSuccessVisible=function(){return $scope.topRated!=="hipo"&&!$scope.hideJss&&$scope.freelancerJobSuccessScorePercentage>=90};function getScorePercentage(score){if(typeof score==="string"){score=parseFloat(score);if(isNaN(score)){score=0}}if(score<=1){score=score*100}if(score>100){score=100}return Math.round(score)}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerJobSuccessScore",freelancerJobSuccessScore);function freelancerJobSuccessScore(){return{templateUrl:Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/job-success/job-success.html"),scope:{freelancerJobSuccessScore:"@",isAgencyProfile:"<?",isExpanded:"<?",popoverClose:"@?",hideJss:"<?",popoverPlacement:"@?"},link:link};function link($scope){$scope.freelancerJobSuccessScorePercentage=getScorePercentage($scope.freelancerJobSuccessScore);$scope.popoverTemplateUrl=Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/job-success/popover.html");$scope.popoverPlacement=$scope.popoverPlacement||"left";$scope.isJobSuccessVisible=function(){return $scope.freelancerJobSuccessScorePercentage>0};function getScorePercentage(score){if(typeof score==="string"){score=parseFloat(score);if(isNaN(score)){score=0}}if(score<=1){score=score*100}if(score>100){score=100}return Math.round(score)}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerLocation",location).constant("COMMA_SEPARATOR",", ");location.$inject=["truncateByCharsFilter","capitalizeFilter","FREELANCER_TILE_TRUNCATE_CITY_CHARS","COMMA_SEPARATOR","FREELANCER_TILE_IS_US_AGENCIES_ENABLED"];function location(truncate,capitalize,TRUNCATE_CITY_CHARS,COMMA_SEPARATOR,IS_UNITED_STATES_AGENCIES){var displayTypes={agencyContractor:"agency-contractor",agency:"agency",freelancer:"freelancer"};return{templateUrl:Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/location/location.html"),scope:{location:"<",isUsMarketplaceEnabled:"<",displayType:"@"},link:link};function link($scope){$scope.$watch("isUsMarketplaceEnabled",function(newUsMarketplaceState){$scope.isUsLocation=newUsMarketplaceState===true&&$scope.location.country==="United States";if($scope.displayType&&$scope.displayType!==displayTypes.freelancer){var isUsAgencyLocationDisplay=IS_UNITED_STATES_AGENCIES===true&&$scope.isUsLocation;var isEnabled=$scope.displayType===displayTypes.agencyContractor&&isUsAgencyLocationDisplay||$scope.displayType===displayTypes.agency&&!isUsAgencyLocationDisplay;if(!isEnabled){$scope.fullLocationLabel="";return}}$scope.fullLocationLabel=getFullLocationLabel($scope.location,$scope.isUsLocation);if($scope.isUsLocation){$scope.locationLabel=getUsLocationLabel($scope.location)}else{$scope.locationLabel=$scope.fullLocationLabel}});function getUsLocationLabel(profileLocation){var cityName=getNormalizedCityName(profileLocation);var cityNameLength=cityName.length;var lengthToTruncate=TRUNCATE_CITY_CHARS;if(cityNameLength<=lengthToTruncate+2){lengthToTruncate+=2}var usLocationLabel=capitalize(truncate(cityName,lengthToTruncate).replace(/[ ,]+\.\.\./,"..."));if(profileLocation.state){usLocationLabel+=COMMA_SEPARATOR+profileLocation.state}return usLocationLabel}function getFullLocationLabel(profileLocation,isUsLocation){if(isUsLocation){var cityName=getNormalizedCityName(profileLocation);var location=[capitalize(cityName)];if(profileLocation.state){location.push(profileLocation.state)}return location.join(COMMA_SEPARATOR)}else{return profileLocation.country}}function getNormalizedCityName(profileLocation){var cityName=!!profileLocation.city?profileLocation.city:"";return cityName.length>0?cityName.replace(/ +/g," "):cityName}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerName",name);function name(){return{templateUrl:Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/name/name.html"),scope:{name:"@",shortName:"@",detailsUrl:"@",preventNavigation:"<?",charsThreshold:"@?",isAgencyProfile:"<?",useSanitizedUserData:"<?"},controller:function($scope){$scope.charsThreshold=parseInt($scope.charsThreshold,10)||120}}}})(angular);
(function(ng,Applet){"use strict";ng.module("freelancer.tile.common").directive("freelancerRate",rate);rate.$inject=["numberFilter"];function rate(numberFilter){return{templateUrl:Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/rate/rate.html"),scope:{rate:"@?",rateMin:"@?",rateMax:"@?",isFixed:"<?"},link:rateLink};function rateLink(scope){scope.rateText="";var rate=getAsFloat(scope.rate);if(rate!==null){scope.rateText=amountInUSD(rate)}else{var rateMin=getAsFloat(scope.rateMin);var rateMax=getAsFloat(scope.rateMax);if(rateMin!==null&&rateMax!==null){var rateRange={min:Math.min(rateMin,rateMax),max:Math.max(rateMin,rateMax)};var rateMinTxt=amountInUSD(rateRange.min);if(rateRange.min===rateRange.max){scope.rateText=rateMinTxt}else{var rateMaxTxt=amountInUSD(rateRange.max);scope.rateText=[rateMinTxt,"-",rateMaxTxt].join(" ")}}}scope.showHourLabel=!scope.isFixed&&scope.rateText!=="";function getAsFloat(value){var parsed=parseFloat(value);if(isFinite(parsed)){return parsed}return null}function amountInUSD(num){return"$"+numberFilter(num,2)}}}})(angular,Applet);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerRecommendedBadgeV2",freelancerRecommendedBadgeV2);freelancerRecommendedBadgeV2.$inject=["freelancerTileConfig"];function freelancerRecommendedBadgeV2(config){return{templateUrl:config.getViewPath("/js/common/recommended-badge-v2/recommended-badge-v2.html"),scope:{}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerRecommendedBadge",freelancerRecommendedBadge);function freelancerRecommendedBadge(){return{templateUrl:Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/recommended-badge/recommended-badge.html"),scope:{}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerSkillsList",skills);function skills(){return{templateUrl:Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/skills-list/skills-list.html"),scope:{skills:"<",skillsToTruncate:"@",detailsUrl:"@",linkClickCallback:"&?",useSanitizedUserData:"<?",preventNavigation:"<?",classNames:"@?"},link:function(scope){scope.showMoreButton=function(){return scope.skills&&scope.skills.length>scope.skillsToTruncate};scope.skillLinkClick=function(event,skill){if(ng.isFunction(scope.linkClickCallback)){scope.linkClickCallback({event:event,source:"skill",params:{skillName:skill.skill.name,skillUrl:skill.skillUrl}})}};scope.moreLinkClick=function(event){if(ng.isFunction(scope.linkClickCallback)){scope.linkClickCallback({event:event,source:"skills-more"})}}}}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.tile.common");module.factory("freelancerTileSwitcherService",tileSwitcherService);tileSwitcherService.$inject=["$cookies","freelancerTileConfig"];function tileSwitcherService($cookies,config){var mode=null;var observerCallbacks=[];initService();return{getMode:getMode,setMode:setMode,registerObserverCallback:registerObserverCallback,deleteObserverCallback:deleteObserverCallback};function setMode(newMode){mode=newMode;$cookies.put(getPersistentKey(),newMode,{path:"/"});executeCallbacks()}function getMode(){return mode}function initService(){var initMode=config.getValue("initTileMode");if(initMode!==null){mode=$cookies.get(getPersistentKey());if(!(mode==="compact"||mode==="expanded")){mode=initMode||"compact"}}}function registerObserverCallback(func){if(angular.isFunction(func)&&observerCallbacks.indexOf(func)===-1){observerCallbacks.push(func)}}function executeCallbacks(){observerCallbacks.forEach(function runCallback(func){func(mode)})}function deleteObserverCallback(callback){for(var i=0;i<observerCallbacks.length;i++){if(observerCallbacks[i]===callback){observerCallbacks.splice(i,1)}}}function getPersistentKey(){return config.getTileSwitcherCookieName()}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.tile.common");module.directive("freelancerTileSwitcher",tileSwitcher);tileSwitcher.$inject=["freelancerTileConfig","freelancerTileSwitcherService"];function tileSwitcher(config,service){return{restrict:"A",link:link,templateUrl:config.getViewPath("/js/common/tile-switcher/tile-switcher.html"),scope:{callback:"&?"}};function link($scope){var modeItems={compact:{key:"compact",title:"Compact",icon:"air-icon-view-as-list"},expanded:{key:"expanded",title:"Expanded",icon:"air-icon-view-as-informative"}};$scope.currentMode={};$scope.modeItems=modeItems;$scope.isEnabled=service.getMode()!==null;syncState();$scope.updateMode=function(item){service.setMode(item.key);syncState();if(ng.isFunction($scope.callback)){$scope.callback()}};$scope.isActiveItem=function(item){return item.key===service.getMode()};function syncState(){var stateKey=service.getMode();if(stateKey){$scope.currentMode=modeItems[stateKey]}}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerTitleV2",freelancerTitleV2);freelancerTitleV2.$inject=["freelancerTileConfig"];function freelancerTitleV2(config){return{templateUrl:config.getViewPath("/js/common/title-v2/title-v2.html"),scope:{isExpanded:"<",useSanitizedUserData:"<",title:"@"}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerTitle",title);function title(){return{templateUrl:Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/title/title.html"),scope:{isExpanded:"<",useSanitizedUserData:"<",title:"@"}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerTopRatedBadgeV2",freelancerTopRatedBadgeV2);freelancerTopRatedBadgeV2.$inject=["freelancerTileConfig"];function freelancerTopRatedBadgeV2(config){return{templateUrl:config.getViewPath("/js/common/top-rated-v2/top-rated-v2.html"),scope:{topRated:"@",popoverClose:"@?",popoverPosition:"@?",isAgencyProfile:"<?"},link:link};function link($scope){$scope.popoverPosition=ng.isDefined($scope.popoverPosition)?$scope.popoverPosition:"top";$scope.popoverClose=ng.isDefined($scope.popoverClose)?$scope.popoverClose:true;$scope.showBadge=false;$scope.text="";if($scope.topRated==="top_rated"){$scope.isBadgeShown=true;$scope.badgeClass="badge-top-rated";$scope.iconClass="air-icon-top-rated";$scope.text="Top Rated";$scope.popoverTemplateUrl=config.getViewPath("/js/common/top-rated-v2/topRatedPopover.html")}else if($scope.topRated==="hipo"){$scope.isBadgeShown=true;$scope.badgeClass="badge-talent";$scope.iconClass="air-icon-rising-talent";$scope.text="Rising Talent";$scope.popoverTemplateUrl=config.getViewPath("/js/common/top-rated-v2/hipoPopover.html")}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.common").directive("freelancerTopRatedBadge",freelancerTopRatedBadge);function freelancerTopRatedBadge(){return{templateUrl:Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/top-rated/top-rated.html"),scope:{topRated:"@",popoverClose:"@?",popoverPosition:"@?",isAgencyProfile:"<?",iconOnly:"<?"},link:link};function link($scope){$scope.popoverPosition=ng.isDefined($scope.popoverPosition)?$scope.popoverPosition:"top";$scope.popoverClose=ng.isDefined($scope.popoverClose)?$scope.popoverClose:true;$scope.showBadge=false;$scope.text="";if($scope.topRated==="top_rated"){$scope.isBadgeShown=true;$scope.badgeClass="badge-top-rated";$scope.iconClass="air-icon-top-rated";$scope.text="Top Rated";$scope.popoverTemplateUrl=Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/top-rated/topRatedPopover.html")}else if($scope.topRated==="hipo"){$scope.isBadgeShown=true;$scope.badgeClass="badge-talent";$scope.iconClass="air-icon-rising-talent";$scope.text="Rising Talent";$scope.popoverTemplateUrl=Applet.buildInternalAssetPath("@OdeskFreelancerTileBundle/js/common/top-rated/hipoPopover.html")}}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.filters",[])})(angular);
(function(ng){"use strict";ng.module("freelancer.tile.filters").filter("capitalize",Capitalize);Capitalize.$inject=[];function Capitalize(){return function(text){return text?text.toLowerCase().replace(/(\b\w(?!\s))/g,function(a){return a.toUpperCase()}):""}}})(angular);
(function(ng){"use strict";ng.module("freelancer.tile").directive("freelancerTile",freelancerTile);freelancerTile.$inject=["freelancerTileSwitcherService","freelancerTileConfig","$timeout","FREELANCER_TILE_RECENT_EARNINGS_ENABLED"];function freelancerTile(switcherService,config,$timeout,FREELANCER_TILE_RECENT_EARNINGS_ENABLED){return{template:'<div data-ng-include="templateUrl"></div>',scope:{freelancer:"<",detailsUrl:"@?",addSaveButton:"<?",addRightSlot:"<?",addMiddleSlot:"<?",addBottomSlot:"<?",addStatsSlot:"<?",forceFreelancerRate:"<?",skillsToTruncate:"@?",groupsToTruncate:"@?",preventNavigation:"<?",tileClicked:"&?",tileSharedData:"<?",forceViewMode:"@?",useSanitizedUserData:"<?",showInvitedOpeningList:"<?",isUsMarketplaceEnabled:"<?"},link:tileLink};function tileLink($scope){var preventingDoubleEvent;$scope.skillsToTruncate=parseInt($scope.skillsToTruncate)||4;$scope.groupsToTruncate=parseInt($scope.groupsToTruncate)||2;$scope.useSanitizedUserData=$scope.useSanitizedUserData||false;$scope.showInvitedOpeningList=$scope.showInvitedOpeningList||false;$scope.isHideEarnings=config.getValue("isHideEarningsFF")&&$scope.freelancer.hideEarnings;$scope.relevantFreelancerTruncateChars=65;$scope.mode=switcherService.getMode();if($scope.forceViewMode){$scope.mode=$scope.forceViewMode}$scope.isExpanded=$scope.mode==="expanded";$scope.freelancerUrl=$scope.freelancer.profileUrl?$scope.freelancer.profileUrl:$scope.detailsUrl;$scope.agencyUrl=$scope.freelancer.isAgencyContractor&&$scope.freelancer.agency.profileUrl?$scope.freelancer.agency.profileUrl:$scope.detailsUrl;var urlArray=getTemplatePaths(FREELANCER_TILE_RECENT_EARNINGS_ENABLED);if(!$scope.forceViewMode){initTileViewObserver()}$scope.linkClicked=function(linkEvent,source,params){if(preventingDoubleEvent){return}if(source==="name"||source==="avatar"){preventingDoubleEvent=true;$timeout(function(){preventingDoubleEvent=false},300)}$scope.tileClicked({freelancer:$scope.freelancer,event:linkEvent,source:source,params:params})};$scope.getInvitedOpeningsListUrl=function(){return config.getViewPath("/js/common/invited-list/list.html")};function setTemplateUrl(tileMode){if($scope.freelancer.isAgencyContractor){$scope.templateUrl=urlArray.agency[tileMode]}else{$scope.templateUrl=urlArray.freelancer[tileMode]}}function initTileViewObserver(){var updateTileView=function(newMode){$scope.isExpanded=newMode==="expanded";$scope.mode=newMode;setTemplateUrl(newMode)};switcherService.registerObserverCallback(updateTileView);$scope.$on("$destroy",function(){switcherService.deleteObserverCallback(updateTileView)})}function getTemplatePaths(isRecentEarningFeature){var buildTemplateName=function(isAgency,name){var version=isRecentEarningFeature?"-v2":"";var templatePrefix="/js/tile/"+(isAgency?"agency":"freelancer")+version+"/";var extension=version+".html";return config.getViewPath(templatePrefix+name+extension)};return{agency:{expanded:buildTemplateName(true,"expanded"),compact:buildTemplateName(true,"compact"),contract:buildTemplateName(true,"contract")},freelancer:{expanded:buildTemplateName(false,"expanded"),compact:buildTemplateName(false,"compact"),contract:buildTemplateName(false,"contract")}}}setTemplateUrl($scope.mode)}}})(angular);
(function(ng){"use strict";ng.module("freelancer.search.facet",["freelancer.search.facet.models","components.core.buttons.toggle","components.core.select","components.core.templates","components.core.truncation","components.core.typeahead","components.core.collapse","components.core.dropdown","components.core.dropdownMenu","components.core.storage"]).constant("FREELANCER_SEARCH_FACET_API_URL_PREFIX","api/").constant("FREELANCER_SEARCH_LOCATION_TYPES",{country:"Country",region:"Region",subRegion:"Subregion",timezone:"Timezone",state:"State"}).value("FREELANCER_SEARCH_LOCATION_LIMIT",{maxCountries:5,maxRegions:5,maxSubRegions:5,maxTimezones:5,maxStates:5}).value("FREELANCER_SEARCH_RECENT_EARNINGS_ENABLED",false)})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet.models",["components.core.model"]);module.run(moduleRun);moduleRun.$inject=["eoModelRegistry"];function moduleRun(eoModelRegistry){var Base=eoModelRegistry.get("Base");var FacetValue=Base.extend({value:null,label:null,isSelected:false,counts:null});var CountryFacetValue=FacetValue.extend({locationType:"",relatedRegion:null,relatedSubRegion:null});var UsLocationFacetValue=FacetValue.extend({locationType:null});var CategoryFacetValue=FacetValue.extend({subcategories:null,parentCategoryUid:null});eoModelRegistry.put("FacetValue",FacetValue);eoModelRegistry.put("CountryFacetValue",CountryFacetValue);eoModelRegistry.put("UsLocationFacetValue",UsLocationFacetValue);eoModelRegistry.put("CategoryFacetValue",CategoryFacetValue)}})(angular);
(function(ng,applet){"use strict";var module=ng.module("freelancer.search.facet");module.service("flConfig",flConfig);flConfig.$inject=[];function flConfig(){var appletConfig=applet.getVar("flFacetSearchConf");return{getTemplateUrl:getTemplateUrl,getComponentTemplateUrl:getComponentTemplateUrl,getVersion:getConfigOptionFn("version"),getPredefinedListNames:getConfigOptionFn("predefinedListNames"),getApiJsonUrl:getApiJsonUrl};function getTemplateUrl(path){return applet.buildInternalAssetPath("@UpworkFreelancerSearchFacetBundle/js/"+path)}function getApiJsonUrl(path){return applet.buildInternalAssetPath("@UpworkFreelancerSearchFacetBundle/api-json/"+path)}function getComponentTemplateUrl(componentName){var path=componentName.replace(/([A-Z])/g,"-$1").toLowerCase();return getTemplateUrl("components/"+path+"/"+path+".html")}function getConfigOptionFn(name){var option=ng.isDefined(appletConfig[name])?appletConfig[name]:null;return function(){return option}}}})(angular,Applet);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.service("flEventBus",eventBus);eventBus.$inject=[];function eventBus(){var service=this;var commonBus=new EventBus;service.listen=commonBus.listen;service.publish=commonBus.publish;service.createEventBus=function(){return new EventBus};function EventBus(){var self=this;var listeners={};this.listen=function(eventName,callback){if(!listeners[eventName]){listeners[eventName]=[]}var listener={fn:callback};listeners[eventName].push(listener);return function(){return removeListener(listeners[eventName],listener)}};this.publish=function(eventName,parameters){if(listeners[eventName]){for(var i=0;i<listeners[eventName].length;i++){listeners[eventName][i].fn.apply(self,ng.isArray(parameters)?parameters:[parameters])}}}}function removeListener(array,value){var index=array.indexOf(value);if(index>=0){array.splice(index,1)}return index>=0}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.factory("flFacetConfig",facetConfig);facetConfig.$inject=["flSearchApiService"];function facetConfig(flSearchApiService){return{getConfigExtension:function(facetName){return flSearchApiService.getFacetConfigExtension().then(function(response){return ng.isDefined(response.data[facetName])&&response.data[facetName]})},dependencies:{loc:[{type:"visible",master:"user_pref",method:function(masterFacet){return[null,"1"].indexOf(masterFacet.getFirstValue())>-1}}],us_loc:[{type:"visible",master:"user_pref",method:function(masterFacet){return masterFacet.getFirstValue()==="2"}}],rhrs:[{type:"visible",master:"hrs",method:"hasFacetValues"}],top_rated:[{type:"visible",master:"nss",method:"hasFacetValues"}],tests_10:[{type:"visible",master:"tests",method:"hasShortlisted"},{type:"enable",master:"tests",method:"hasFacetValues"}]},filterPanel:{exclude:{tests_10:true,q:true,opening_uid:true,user_pref:true},omitFromClear:{q:true,or_terms:true,and_terms:true,exact_terms:true,exclude_terms:true,title:true,user_pref:true},facetLabel:{nss:"Job success",rate:"Hourly rate",english:"English level",last:"Last activity",loc:"Location",us_loc:"Location",tests:"Test",lang:"Language",c:"Category",ptc:"Talent Cloud"}},isOmitFromClear:function(facetName){return ng.isDefined(this.filterPanel.omitFromClear[facetName])},getFilterLabel:function(facetName){return ng.isDefined(this.filterPanel.facetLabel[facetName])?this.filterPanel.facetLabel[facetName]:""}}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.service("flFacetListService",facetListService);facetListService.$inject=["flSearchApiService","$q","eoModelRegistry","flConfig","FREELANCER_SEARCH_LOCATION_TYPES"];function facetListService(flSearchApiService,$q,eoModelRegistry,flConfig,locationTypes){var service=this;var predefinedBulkListsPromise=null;service.getFacetValuesList=function(listConfig){return new FacetValuesList(listConfig)};service.createFacetValueList=function(values){return new FacetValueList(values)};function loadRemoteList(name){if(flConfig.getPredefinedListNames().indexOf(name)!==-1){if(predefinedBulkListsPromise===null){predefinedBulkListsPromise=flSearchApiService.getBulkPredefinedListValues()}return predefinedBulkListsPromise.then(function(response){if(response&&response.data&&ng.isObject(response.data[name])){return response.data[name]}else{return $q.reject("List ["+name+"] not in response")}})}else{return flSearchApiService.getListValues(name)}}function FacetValuesList(config){var self=this;var listLoadDefer=$q.defer();self.listName=config.name;self.isRemote=ng.isDefined(config.remote)&&config.remote;self.listValues=null;this.getListPromise=function(){return listLoadDefer.promise};initValues();function initValues(){if(self.isRemote){loadRemoteList(self.listName).then(function(listValues){listLoadDefer.resolve(buildFacetListValues(listValues))},function(){listLoadDefer.reject(buildFacetListValues([]))})}else{listLoadDefer.resolve(buildFacetListValues(config.values))}}function buildFacetListValues(values){var listTypes={location:LocationFacetValueList,us_location:UsLocationFacetValueList,category:CategoryFacetValueList};var ListType=listTypes[self.listName]?listTypes[self.listName]:FacetValueList;return new ListType(values)}}function FacetValueList(initialValues){this.sourceList=null;this.flatList=null;this.shortList=null;this.init(initialValues)}FacetValueList.prototype={init:function(obj){this.sourceList=this.fromArray(obj);this.flatList=this.getFlatList();this.shortList=[]},createFacetValue:function(srcItem){var FacetValue=eoModelRegistry.get("FacetValue");var facetValue=new FacetValue({label:srcItem.label});facetValue.value=srcItem.value;return facetValue},fromArray:function(srcList){var self=this;var list=[];if(ng.isDefined(srcList)){ng.forEach(srcList,function(value){list.push(self.createFacetValue(value))})}return list},getFlatList:function(){var list=[];ng.forEach(this.sourceList,function(value){list.push(value)});return list},filterByValues:function(values){var self=this;if(ng.isArray(values)&&values.length>0&&ng.isArray(this.flatList)){return self.flatList.filter(function(facetValue){var index=values.indexOf(facetValue.value);var isFound=index>-1;if(isFound){delete values[index]}return isFound})}return[]},addToShortList:function(facetValue){if(this.shortList.indexOf(facetValue)===-1){facetValue.isSelected=true;this.shortList.unshift(facetValue);return true}return false},addOptionToShortList:function(facetValue){if(this.shortList.indexOf(facetValue)===-1){this.shortList.push(facetValue);return true}return false},hasShortListSelected:function(){return this.shortList.filter(function(item){return item.isSelected}).length>0},hasShortListed:function(){return this.shortList.length>0},unselectFacetValue:function(facetValue){facetValue.isSelected=false},filterShortlist:function(callback){this.shortList=this.shortList.filter(callback)},clearShortlisted:function(){ng.forEach(this.shortList,this.unselectFacetValue);this.shortList=[]}};function LocationFacetValueList(values){FacetValueList.apply(this,[values])}LocationFacetValueList.prototype=Object.create(FacetValueList.prototype);LocationFacetValueList.prototype.constructor=FacetValueList;LocationFacetValueList.prototype.createFacetValue=function(srcItem,locationType,relatedRegion,relatedSubRegion){var CountryFacetValue=eoModelRegistry.get("CountryFacetValue");return new CountryFacetValue({value:srcItem.code,label:srcItem.title,locationType:locationType,relatedRegion:relatedRegion,relatedSubRegion:relatedSubRegion})};LocationFacetValueList.prototype.fromArray=function(srcList){var self=this;var list={regions:[],countries:[],subregions:[]};var regions={};var subregions={};ng.forEach(srcList.regions,function(value){if(ng.isDefined(value.regionId)&&value.regionId){var facetValue=self.createFacetValue(value,locationTypes.region,null,null);regions[value.regionId]=facetValue;list.regions.push(facetValue)}});ng.forEach(srcList.subregions,function(value){if(ng.isDefined(value.subRegionId)&&value.subRegionId){var relatedRegion=ng.isDefined(regions[value.regionId])?regions[value.regionId]:null;var facetValue=self.createFacetValue(value,locationTypes.subRegion,relatedRegion,null);subregions[value.subRegionId]=facetValue;list.subregions.push(facetValue)}});ng.forEach(srcList.countries,function(value){var relRegionId=ng.isDefined(value.relRegId)?value.relRegId:null;var relatedRegion=ng.isDefined(regions[relRegionId])?regions[relRegionId]:null;var relatedSubRegion=ng.isDefined(subregions[value.relSubRegId])?subregions[value.relSubRegId]:null;list.countries.push(self.createFacetValue(value,locationTypes.country,relatedRegion,relatedSubRegion))});return list};LocationFacetValueList.prototype.getFlatList=function(){var list=[];ng.forEach(this.sourceList,function(listValue){ng.forEach(listValue,function(value){list.push(value)})});return list};function UsLocationFacetValueList(values){FacetValueList.apply(this,[values])}UsLocationFacetValueList.prototype=Object.create(FacetValueList.prototype);UsLocationFacetValueList.prototype.constructor=FacetValueList;UsLocationFacetValueList.prototype.createFacetValue=function(srcItem,locationType){var UsLocationFacetValue=eoModelRegistry.get("UsLocationFacetValue");return new UsLocationFacetValue({value:srcItem.code,label:srcItem.title,locationType:locationType})};UsLocationFacetValueList.prototype.fromArray=function(srcList){var self=this;var list={timezones:[],states:[]};ng.forEach(srcList.timezones,function(value){var facetValue=self.createFacetValue(value,locationTypes.timezone);list.timezones.push(facetValue)});ng.forEach(srcList.states,function(value){list.states.push(self.createFacetValue(value,locationTypes.state))});return list};UsLocationFacetValueList.prototype.getFlatList=function(){var list=[];ng.forEach(this.sourceList,function(listValue){ng.forEach(listValue,function(value){list.push(value)})});return list};function CategoryFacetValueList(values){FacetValueList.apply(this,[values])}CategoryFacetValueList.prototype=Object.create(FacetValueList.prototype);CategoryFacetValueList.prototype.constructor=FacetValueList;CategoryFacetValueList.prototype.createFacetValue=function(uid,categoryName,subcategories,categoryUid){var CategoryFacetValue=eoModelRegistry.get("CategoryFacetValue");return new CategoryFacetValue({label:categoryName,parentCategoryUid:categoryUid,value:uid,subcategories:subcategories,counts:null})};CategoryFacetValueList.prototype.fromArray=function(srcList){var self=this;var list=[];ng.forEach(srcList,function(category,uid){var subcategories=[];ng.forEach(category.subcategories,function(subcategory,sUid){subcategories.push(self.createFacetValue(sUid,subcategory.name,null,uid))});list.push(self.createFacetValue(uid,category.name,subcategories,null))});return list};CategoryFacetValueList.prototype.getFlatList=function(){var list=[];ng.forEach(this.sourceList,function(listValue){list.push(listValue);ng.forEach(listValue.subcategories,function(value){list.push(value)})});return list}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.service("flFacetService",facetService);facetService.$inject=["flEventBus","flFacetListService","$log","$q","eoModelRegistry","flFacetConfig"];function facetService(flEventBus,flFacetListService,$log,$q,eoModelRegistry,facetConfig){var service=this;service.createFacet=function(name,config){if(config.isAnyValue){return new FacetAny(name,config)}else{return new Facet(name,config,flFacetListService.getFacetValuesList(config.list))}};function isFacetExcludedFromFilterPanel(facetName){return ng.isDefined(facetConfig.filterPanel.exclude[facetName])}function Facet(name,config,facetList){this.listener=flEventBus.createEventBus();this.facetList=facetList;this.config=config;this.name=name;this.values=[];this.allowMany=ng.isDefined(config.allowMany)?config.allowMany:false;this.defaultValues=config.default||[];this.defaultEmptyValue=ng.isDefined(config.defaultEmpty)?config.defaultEmpty:null;this.valueList=null;this.isInitFailed=false;this.isAnyValue=ng.isDefined(config.isAnyValue)?config.isAnyValue:false;this.dependencyList=null;this.isSilentMode=false;this.hasConfigExtension=ng.isDefined(config.hasConfigExtension)?config.hasConfigExtension:false;this.isEnabled=!this.hasConfigExtension;this.isVisible=!this.hasConfigExtension;this.isEnabledByConfig=!this.hasConfigExtension}Facet.prototype={isReadyPromise:function(){var self=this;var promises=[this.facetList.getListPromise().then(function(facetList){self.valueList=facetList;self.setInitValues(self.defaultValues)},function(emptyFacetList){self.valueList=emptyFacetList;return $q.reject()})];if(this.hasConfigExtension){promises.push(facetConfig.getConfigExtension(this.name).then(function(isEnabled){self.isEnabled=isEnabled;self.isVisible=isEnabled;self.isEnabledByConfig=isEnabled}))}return $q.all(promises).catch(function(){self.isEnabled=false;self.isVisible=false;self.isInitFailed=true;return $q.reject()})},setValueList:function(valueList){this.valueList=valueList},initDependency:function(facetList){this.dependencyList=new FacetDependencyList(this,facetList)},_initValues:function(values){var self=this;values=this.valueList.filterByValues(values);if(this.allowMany){if(ng.isArray(values)){if(this.hasList()){this.valueList.clearShortlisted()}values.map(function(facetValue){if(ng.isObject(facetValue)){self.addToShortlist(facetValue)}});this.values=values;this.listener.publish("value:change",{facet:this,silent:this.isSilentMode})}}else if(values){if(ng.isArray(values)&&values.length>0){this.values=[values[0]];this.values.map(function(facetValue){if(ng.isObject(facetValue)){self.addToShortlist(facetValue)}})}else{this.values=[]}this.listener.publish("value:change",{facet:this,silent:this.isSilentMode})}},setInitValues:function(values){if(!ng.isArray(values)){values=[values]}this._initValues(values)},setEmptyDefaultValues:function(){this._initValues([this.defaultEmptyValue])},getFirstFacetValue:function(){return this.values.length>0?this.values[0]:null},getFirstValue:function(){var firstItem=this.getFirstFacetValue();return firstItem?firstItem.value:null},registerCallback:function(eventName,callbackFn){return this.listener.listen(eventName,callbackFn)},hasList:function(){return this.valueList&&ng.isArray(this.valueList.flatList)&&this.valueList.flatList.length>0},changeFacetValue:function(facetValue){if(this.allowMany){if(this.hasList()){var valueIndex=this.values.indexOf(facetValue);if(facetValue.isSelected){if(valueIndex===-1){this.values.push(facetValue)}}else if(!facetValue.isSelected){if(valueIndex!==-1){this.values.splice(valueIndex,1)}}}else{if(this.values.indexOf(facetValue)===-1){this.values.push(facetValue)}}}else{if(this.hasList()){if(this.valueList.flatList.indexOf(facetValue)>-1){this.values=[facetValue]}else{this.values=[]}}else{this.values=[facetValue]}}this.listener.publish("value:change",{facet:this,silent:this.isSilentMode});if(!this.isSilentMode){this.listener.publish("ui:facet:change",{facet:this})}},addToShortlist:function(facetValue){if(this.hasList()){this.valueList.addToShortList(facetValue)}this.changeFacetValue(facetValue)},filterShortlist:function(callback){if(this.hasList()){this.valueList.filterShortlist(callback)}},addOptionsToShortlistFromValues:function(values){if(this.hasList()){var list=this.valueList;this.valueList.filterByValues(values).map(function(facetValue){list.addOptionToShortList(facetValue)})}},clearFacetValues:function(){var previousLength=this.values.length+1;while(this.values.length>0&&previousLength>this.values.length){previousLength=this.values.length;this.clearByValue(this.values[0])}},hasFacetValues:function(){return this.values.length>0&&this.values[0].value!==null},hasPanelFilter:function(){if(isFacetExcludedFromFilterPanel(this.name)||!this.isEnabled||!this.isVisible){return false}if(this.values.length>0){for(var key in this.values){if(this.values.hasOwnProperty(key)){var item=this.values[key];if(item.value!==null&&item.label){return true}}}}return false},clearByValue:function(value){var index=this.values.indexOf(value);if(index>-1){var item=this.values[index];if(this.hasList()){this.valueList.unselectFacetValue(item)}this.values.splice(index,1)}if(this.values.length===0){this.setEmptyDefaultValues()}this.listener.publish("value:change",{facet:this,silent:this.isSilentMode})},getDataValues:function(){return this.values.map(function(facetValue){return facetValue.value})},isAvailable:function(){return!this.isInitFailed&&this.isEnabled&&this.isVisible},hasShortlisted:function(){return this.hasList()&&this.valueList.hasShortListed()},setVisible:function(value){if(!this.isInitFailed){this.isVisible=value}},setEnabled:function(value){if(!this.isInitFailed){this.isEnabled=value}},updateCounts:function(counts,isZeroAsDefault){if(this.hasList()){this.valueList.flatList.map(function(facetValue){if(ng.isDefined(counts[facetValue.value])){facetValue.counts=counts[facetValue.value]}else{facetValue.counts=isZeroAsDefault?0:null}})}},getPanelLabel:function(label){var panelLabel=facetConfig.getFilterLabel(this.name);return(panelLabel?panelLabel+": ":"")+label},setSilentMode:function(mode){this.isSilentMode=mode},isDefaultDataValues:function(values){if(ng.isArray(values)&&values.length===1){return values[0]===this.defaultEmptyValue}return false}};function FacetAny(name,config){Facet.apply(this,[name,config,null]);var FacetValueModel=eoModelRegistry.get("FacetValue");this.facetValue=new FacetValueModel({});this.facetValue.value=null;this.values=[this.facetValue];this.setInitValues(this.defaultValues)}FacetAny.prototype=Object.create(Facet.prototype);FacetAny.prototype.constructor=FacetAny;FacetAny.prototype.isReadyPromise=function(){var self=this;if(this.hasConfigExtension){return facetConfig.getConfigExtension(this.name).then(function(isEnabled){self.isEnabled=isEnabled;self.isVisible=isEnabled},function(){self.isEnabled=false;self.isVisible=false;self.isInitFailed=true})}return $q.resolve({})};FacetAny.prototype.setValueList=function(valueList){Facet.prototype.setValueList.call(this,valueList);this.applyListLabel()};FacetAny.prototype._initValues=function(values){if(values&&values.length>0){this.facetValue.value=values[0];this.applyListLabel()}else{this.facetValue.value=null}this.listener.publish("value:change",{facet:this,silent:this.isSilentMode})};FacetAny.prototype.getFirstFacetValue=function(){return this.facetValue};FacetAny.prototype.clearFacetValues=function(){this.facetValue.value=null};FacetAny.prototype.hasFacetValues=function(){return this.facetValue.value!==null&&this.facetValue.value!==""};FacetAny.prototype.hasPanelFilter=function(){if(isFacetExcludedFromFilterPanel(this.name)||!this.isEnabled||!this.isVisible){return false}return this.hasFacetValues()&&this.facetValue.label};FacetAny.prototype.clearByValue=function(){this.setEmptyDefaultValues();this.listener.publish("value:change",{facet:this,silent:this.isSilentMode})};FacetAny.prototype.publishEvent=function(eventName,params){this.listener.publish(eventName,{facet:this,params:params})};FacetAny.prototype.changeFacetValue=function(facetValue){this.values=[facetValue];this.listener.publish("value:change",{facet:this,silent:this.isSilentMode});if(!this.isSilentMode){this.listener.publish("ui:facet:change",{facet:this})}};FacetAny.prototype.setValue=function(value){this.facetValue.value=value;this.applyListLabel()};FacetAny.prototype.applyListLabel=function(){if(this.valueList){if(this.facetValue.value===null){this.facetValue.label=null}else{var findList=this.valueList.filterByValues([this.facetValue.value]);if(findList.length>0){this.facetValue.label=findList[0].label}else{this.facetValue.label=" "}}}};FacetAny.prototype.hasShortlisted=function(){return false};function FacetDependencyList(facet,facets){var self=this;var config=ng.isDefined(facetConfig.dependencies[facet.name])?facetConfig.dependencies[facet.name]:null;this.depsList=[];if(ng.isObject(config)){ng.forEach(config,function(dependencyConfig){if(facet.isEnabledByConfig){if(ng.isDefined(facets[dependencyConfig.master])){var masterFacet=facets[dependencyConfig.master];var dependency=new FacetDependency(facet,masterFacet,dependencyConfig.type,dependencyConfig.method);masterFacet.registerCallback("value:change",function(){dependency.onEvent()})}dependency.onEvent();self.depsList.push(dependency)}})}}function FacetDependency(facet,masterFacet,type,method){var self=this;this.onEvent=function(){var value=self.getValue();if(ng.isDefined(value)){switch(type){case"visible":facet.setVisible(value);break;case"enable":facet.setEnabled(value);break;default:$log.error("Unknown dependency type ["+type+"]")}}};this.getValue=function(){if(ng.isFunction(method)){return method(masterFacet)}else{if(ng.isFunction(masterFacet[method])){return masterFacet[method]()}$log.error("Method ["+method+"] not found in facet ["+masterFacet.name+"]")}}}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.service("flQueryBuilderService",queryBuilderService);queryBuilderService.$inject=["flConfig","$http","$q","eoStorage","numberFilter"];function queryBuilderService(flConfig,$http,$q,eoStorage,numberFilter){var serviceDefer=$q.defer();var isInitStarted=false;return{getServiceAsPromise:function(){return serviceDefer.promise},init:function(){if(!isInitStarted){isInitStarted=true;loadQueryBuilderConfigAsPromise().then(function(config){serviceDefer.resolve(getService(config))})}}};function getService(config){var queryMap=null;var service={};service.getSuggestionList=function(query){var queryAsArray=new CachedArray(query);var qMap=getQueryMap();var maxLen=-1;var match=false;var foundChild=false;if(Object.keys(qMap).length>0&&query){ng.forEach(qMap,function(parentSuggestion){if(parentSuggestion.keyArray.isSubSetOf(queryAsArray)){if(parentSuggestion.keyArray.getLength()>maxLen){match=parentSuggestion.keyArray.text;maxLen=parentSuggestion.keyArray.getLength()}}ng.forEach(parentSuggestion.children,function(child){if(!qMap[child.query]){foundChild=foundChild||child.queryArray.isSubSetOf(queryAsArray)}})})}var isFound=match&&!foundChild;return{suggestions:isFound?qMap[match].children:[],parentKey:isFound?match:null,isFound:isFound}};service.buildQuery=function(childSuggestion,query){if(!ng.isObject(childSuggestion)){return}var qMap=getQueryMap();var queryAsArray=new CachedArray(query);if(ng.isDefined(qMap[childSuggestion.query])){ng.forEach(qMap[childSuggestion.query].children,function(sugg){if(sugg.labelArray.isSubSetOf(queryAsArray)){childSuggestion=sugg}})}var parentSuggestion=qMap[childSuggestion.parentKey];var suggestedWords=parentSuggestion.keyArray.array.concat(childSuggestion.queryArray.array);suggestedWords.map(function(word){var wordRe=new RegExp("(^|\\s)"+regExpEscape(word)+"($|\\s)","ig");query=query.replace(wordRe,"$1$2")});query=query.trim();return childSuggestion.query+(query?" "+query.replace(/\s+/g," "):"")};function getQueryMap(){if(queryMap===null){queryMap={};ng.forEach(config,function(subList,key){var lists=[];var parent={keyArray:new CachedArray(key)};ng.forEach(subList,function(subListItem){var item=ng.extend({},subListItem);if(ng.isDefined(item.count)){item.count=numberFilter(item.count,0)}item.queryArray=new CachedArray(item.query);item.labelArray=new CachedArray(item.label);item.parentKey=key;lists.push(item)});parent.children=lists;queryMap[key]=parent})}return queryMap}return service}function CachedArray(text){this.text=text===null?"":text;this.array=normalizeText(this.text).split(/\s+/).filter(function(elem,index,self){return index===self.indexOf(elem)});this.isSubSetOf=function(cachedArrayObj){return this.array.reduce(function(accItem,element){return accItem+(cachedArrayObj.array.indexOf(element)===-1?0:1)},0)===this.array.length};this.getLength=function(){return this.array.length}}function normalizeText(text){return text.toLowerCase().trim()}function regExpEscape(text){return text.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}function loadQueryBuilderConfigAsPromise(){var appVersion=flConfig.getVersion();var cache=eoStorage.getItem("query-builder-dictionary");if(cache&&cache.version===appVersion&&cache.content){return $q.when(ng.fromJson(cache.content))}return $http.get(flConfig.getApiJsonUrl("query-builder.json")).then(function(response){eoStorage.setItem("query-builder-dictionary",{version:appVersion,content:ng.toJson(response.data)});return response.data})}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.service("flQueryParserService",flQueryParser);flQueryParser.$inject=[];function flQueryParser(){var reSplitWords=/[$^.?+\-*\/\\,#!%&;{}=_`~ ]+/;var reSplitSpaces=/ +/;return{parseQuery:parseQuery,buildQuery:buildQuery};function parseQuery(query){var queryParser=new QueryParser(query);return queryParser.getParsed()}function buildQuery(allWords,anyWords,exactPhrase,excludeWords,titlePhrase){var allWordsClause=buildExpression(splitByWords(allWords),"",true);var anyWordsClause=buildExpression(splitByWords(anyWords),"OR",true);var exactPhraseClause=ng.isString(exactPhrase)&&exactPhrase.length>0?['"',exactPhrase,'"'].join(""):"";excludeWords=splitByWords(excludeWords);var excludePhraseClause=excludeWords.length>0?"NOT "+buildExpression(excludeWords,"OR",true):"";var titleWords=splitByWhitespaces(titlePhrase);var titleClause=titleWords.length>0?"title:"+buildExpression(titleWords,"",true):"";return buildExpression([allWordsClause,anyWordsClause,exactPhraseClause,excludePhraseClause,titleClause],"AND",false)}function buildExpression(words,operator,isGroupingBrackets){words=words.filter(function(word){return ng.isString(word)&&word.length>0});if(words.length===0){return""}else if(words.length===1){return words.join("")}var operatorExpr=operator.length>1?[" ",operator," "].join(""):" ";var expression=words.join(operatorExpr);return isGroupingBrackets?["(",expression,")"].join(""):expression}function splitByWords(sentence){var words=[];if(ng.isString(sentence)&&sentence.length>0){words=sentence.split(reSplitWords).filter(function(word){return word.length>0})}return words}function splitByWhitespaces(sentence){var words=[];if(ng.isString(sentence)&&sentence.length>0){words=sentence.split(reSplitSpaces)}return words}function trimString(str){return str.replace(/^ +| +$/g,"")}function QueryParser(query){var tType={allWords:0,anyWords:1,exactPhrase:2,excludeWords:3,titlePhrase:4,unknown:5};this.query=trimString(query);this.splitSentence=function(sentence){return sentence.split(/(?![ )"])AND(?=[ ("])/)};this.getParsed=function(){var self=this;var allWords=[];var anyWords=[];var exactPhrase=[];var excludeWords=[];var titlePhrase=[];var phrases=this.splitSentence(this.query);ng.forEach(phrases,function(phrase){var pInfo=self.getPhraseInfo(phrase);if(pInfo.type===tType.titlePhrase){titlePhrase.push(pInfo.text)}else if(pInfo.type===tType.exactPhrase){exactPhrase.push(pInfo.text)}else if(pInfo.type===tType.excludeWords){excludeWords.push(pInfo.text)}else if(pInfo.type===tType.anyWords){anyWords.push(pInfo.text)}else if(pInfo.type===tType.allWords){allWords.push(pInfo.text)}});return{allWords:allWords.join(" "),anyWords:anyWords.join(" "),exactPhrase:exactPhrase.join(" "),excludeWords:excludeWords.join(" "),titlePhrase:titlePhrase.join(" ")}};this.getPhraseInfo=function(phrase){phrase=trimString(phrase);phrase=phrase.replace(/\)/g,") ").replace(/\(/g," (").replace(/ +/g," ");phrase=trimString(phrase);var title=this.getTitle(phrase);if(title!==null){return{type:tType.titlePhrase,text:title}}var exactPhrase=this.getExactPhrase(phrase);if(exactPhrase!==null){return{type:tType.exactPhrase,text:exactPhrase}}var excludeWords=this.getExcludeWords(phrase);if(excludeWords!==null){return{type:tType.excludeWords,text:excludeWords}}var anyWords=this.getAnyWords(phrase);if(anyWords!==null){return{type:tType.anyWords,text:anyWords}}var allWords=this.getAllWords(phrase);if(allWords!=null){return{type:tType.allWords,text:allWords}}return{type:tType.unknown,text:phrase}};this.trimBrackets=function(phrase){var matchInsideBrackets=phrase.match(/^\((.*)\)$/);if(matchInsideBrackets&&matchInsideBrackets.length>0){return matchInsideBrackets[1]}return phrase};this.getTitle=function(phrase){var match=phrase.match(/^title *: *([^ ]+|\(([^(]+)\))$/);if(match&&match.length>0){return ng.isDefined(match[2])?match[2]:match[1]}return null};this.getExactPhrase=function(phrase){var match=phrase.match(/^ *"([^"]+)"$/);if(match&&match.length>0){return match[1]}return null};this.getExcludeWords=function(phrase){if(phrase.match(/^NOT[ (]+/)){phrase=trimString(phrase.substring(3));phrase=this.trimBrackets(phrase);phrase=phrase.replace(/ *OR */g," ");if(phrase.length>0){return phrase}}return null};this.getAnyWords=function(phrase){var firstAndIndex=this.query.indexOf("AND")===-1?-2:this.query.indexOf("AND");var orIndexBefore=this.query.indexOf("OR")===-1?false:this.query.indexOf("OR")<firstAndIndex;if(phrase.match(/ OR /)||this.query.indexOf("AND "+phrase)===firstAndIndex&&!orIndexBefore){phrase=this.trimBrackets(phrase.replace(/ *OR */g," "));return phrase}return null};this.getAllWords=function(phrase){phrase.replace(/ AND /g," ");phrase=this.trimBrackets(phrase);if(phrase.length>0){return phrase}return null}}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.service("flRuntimeConfig",flRuntimeConfig);flRuntimeConfig.$inject=[];function flRuntimeConfig(){return{getFacetConfig:function(){return{q:{default:[""],isAnyValue:true},opening_uid:{isAnyValue:true,hasConfigExtension:true,logSubLocation:"facets_job_based_search_selector"},revenue:{listName:"revenue",list:{values:[{value:null,label:"Any amount earned"},{value:"1",label:"$1+ earned"},{value:"100",label:"$100+ earned"},{value:"1000",label:"$1k+ earned"},{value:"10000",label:"$10k+ earned"},{value:"0",label:"No earnings yet"}]},default:[null],logSubLocation:"facets_revenue"},nss:{listName:"nss",list:{values:[{value:null,label:"Any job success"},{value:"80",label:"80% & up"},{value:"90",label:"90% & up"}]},default:[null],logSubLocation:"facets_nss"},top_rated:{listName:"top_rated",list:{values:[{value:"no",label:""},{value:"yes",label:"Rising talent"}]},defaultEmpty:"no",default:["no"],hasConfigExtension:true,logSubLocation:"facets_top_rated"},rate:{listName:"rate",list:{values:[{value:null,label:"Any hourly rate"},{value:"0-10",label:"$10 and below"},{value:"10-30",label:"$10 - $30"},{value:"30-60",label:"$30 - $60"},{value:"60",label:"$60 & above"}]},default:[null],logSubLocation:"facets_rate"},pt:{listName:"pt",list:{values:[{value:null,label:"Any freelancer type"},{value:"independent",label:"Independent freelancers"},{value:"agency",label:"Agency freelancers"}]},default:[null],logSubLocation:"facets_contractor_type"},hrs:{listName:"hrs",list:{values:[{value:null,label:"Any hours"},{value:"1",label:"1+ hours billed"},{value:"100",label:"100+ hours billed"},{value:"1000",label:"1,000+ hours billed"}]},default:[null],logSubLocation:"facets_hours"},rhrs:{listName:"rhrs",list:{values:[{value:"no",label:""},{value:"yes",label:"Hours billed within the last 6 months"}]},defaultEmpty:"no",default:["no"],logSubLocation:"facets_recent_hours"},english:{listName:"english",list:{values:[{value:null,label:"Any level"},{value:"1",label:"Basic"},{value:"2",label:"Conversational"},{value:"3",label:"Fluent"},{value:"4",label:"Native or bilingual"}]},default:[null],logSubLocation:"facets_english"},last:{listName:"last",list:{values:[{value:null,label:"Any time"},{value:"15",label:"Within 2 weeks"},{value:"30",label:"Within 1 month"},{value:"60",label:"Within 2 months"}]},default:[null],logSubLocation:"facets_last_activity"},c:{listName:"category",list:{name:"category",remote:true},default:[null],logSubLocation:"facets_category"},loc:{listName:"location",list:{name:"location",remote:true},allowMany:true,default:[null],logSubLocation:"facets_location"},us_loc:{listName:"us_location",list:{name:"us_location",remote:true},allowMany:true,default:[null],logSubLocation:"facets_us_location"},lang:{listName:"language",list:{name:"language",remote:true},allowMany:true,default:[null],logSubLocation:"facets_language"},tests:{listName:"test",list:{name:"test",remote:true},allowMany:true,default:[null],logSubLocation:"facets_tests"},tests_10:{listName:"tests_10",list:{values:[{value:"no",label:"Scored in the Top 30%"},{value:"yes",label:"Scored in the Top 10%"}]},defaultEmpty:"no",default:["no"]},ptc:{listName:"ptcCloud",list:{name:"ptcCloud",remote:true},allowMany:true,default:[null],hasConfigExtension:true,logSubLocation:"facets_ptc"},exp:{listName:"exp",list:{values:[1,2,3]}},user_pref:{listName:"user_pref",list:{values:[{value:null,label:""},{value:"1",label:"Global"},{value:"2",label:"U.S. only"}]},default:[null],logSubLocation:"facets_user_pref"}}}}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.service("flSearchApiService",flSearchApiService);flSearchApiService.$inject=["$http","FREELANCER_SEARCH_FACET_API_URL_PREFIX","flConfig"];function flSearchApiService($http,FREELANCER_SEARCH_FACET_API_URL_PREFIX,flConfig){return{getFacetConfigExtension:getFacetConfigExtension,getListValues:getListValues,getBulkPredefinedListValues:getBulkPredefinedListValues,getKeywordSuggestions:getKeywordSuggestions,getSuggestedCategories:getSuggestedCategories};function getEndpointUrl(url){return FREELANCER_SEARCH_FACET_API_URL_PREFIX+"freelancer-search-facet/"+url}function getFacetConfigExtension(){return $http.get(getEndpointUrl("config-ext.json"),{cache:true})}function getListValues(listName){return $http.get(getEndpointUrl("list/"+listName+".json"),{cache:true}).then(function(response){return response.data})}function getBulkPredefinedListValues(){return $http.get(getEndpointUrl("lists/bulk-predefined.json")+"?v="+flConfig.getVersion(),{cache:true})}function getKeywordSuggestions(query){return $http.get(getEndpointUrl("suggestions/keywords"),{params:{query:query},cache:true})}function getSuggestedCategories(query){return $http.get(getEndpointUrl("suggestions/categories"),{params:{query:query},cache:true}).then(function(response){if(response.data&&response.data.categories){return response.data.categories}return[]})}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.service("flSearchService",flSearchService);flSearchService.$inject=["$q","flSearchApiService","flFacetService","flEventBus","flRuntimeConfig"];function flSearchService($q,flSearchApiService,flFacetService,flEventBus,flRuntimeConfig){var services={};return{getService:getService,objectHasFacetNames:objectHasFacetNames};function getService(serviceName){if(ng.isUndefined(services[serviceName])){services[serviceName]=new SearchService(serviceName)}return services[serviceName]}function objectHasFacetNames(object,ignoreKeyNames){if(!ng.isObject(object)){return false}var keys=Object.keys(object);if(ng.isArray(ignoreKeyNames)){ignoreKeyNames.map(function(ignoreName){var index=keys.indexOf(ignoreName);if(index>-1){keys.splice(index,1)}})}if(keys.length>0){var facetNames=Object.keys(flRuntimeConfig.getFacetConfig());for(var i=0;i<keys.length;i++){if(facetNames.indexOf(keys[i])>-1){return true}}}return false}function SearchService(name){var configDeferred=$q.defer();var configDeferredAsUntrusted=$q.defer();var isConfigurationStarted=false;var isConfigurationCompleted=false;var isInitSuggestedCategories=true;var facets={};var previousSuggestedCategories=[];var eventBus=flEventBus.createEventBus();var self=this;this.name=name;this.facets=facets;this.isFiltersOpened=false;this.getConfig=getConfig;this.getConfigAsUntrusted=getConfigAsUntrusted;this.getFacet=getFacet;this.getFacetValues=getFacetValues;this.getFacetValuesPromise=getFacetValuesPromise;this.updateFacetCounts=updateFacetCounts;this.setFacetDefaultValues=setFacetDefaultValues;this.updateRecommendedCategories=updateRecommendedCategories;this.isConfigurationCompleted=function(){return isConfigurationCompleted};this.getEventBus=function(){return eventBus};this.warmup=warmup;this.updateCountsFromResponse=updateCountsFromResponse;this.setDefaultFacetFromResponse=setDefaultFacetFromResponse;this.internalClearFacetValue=internalClearFacetValue;return this;function getConfig(){if(!isConfigurationStarted){isConfigurationStarted=true;var promises=[];ng.forEach(flRuntimeConfig.getFacetConfig(),function(facetConfig,name){var facet=flFacetService.createFacet(name,facetConfig);self.facets[name]=facet;promises.push(facet.isReadyPromise())});configDeferredAsUntrusted.resolve(self.facets);waitForAll(promises).finally(function(){ng.forEach(self.facets,function(facet){if(!facet.isInitFailed){facet.initDependency(self.facets)}});configDeferred.resolve(self.facets);isConfigurationCompleted=true})}return configDeferred.promise}function getConfigAsUntrusted(){getConfig();return configDeferredAsUntrusted.promise}function getFacet(facetName){return getConfig().then(function(){if(self.facets[facetName]){return self.facets[facetName]}else{return $q.reject({error:"Facet "+facetName+" not exists."})}})}function internalClearFacetValue(facetName,isSilentMode){if(ng.isDefined(self.facets[facetName])){var facet=self.facets[facetName];try{if(isSilentMode){facet.setSilentMode(true)}facet.clearByValue()}finally{if(isSilentMode){facet.setSilentMode(false)}}return true}return false}function getFacets(){return getConfig().then(function(){return self.facets})}function getFacetValues(){var facetParams=null;if(self.facets){facetParams={};ng.forEach(self.facets,function(facet){if(facet.hasFacetValues()&&facet.isAvailable()){var dataValues=facet.getDataValues();if(!facet.isDefaultDataValues(dataValues)){facetParams[facet.name]=facetValueToParam(dataValues)}}})}return facetParams}function getFacetValuesPromise(){return getFacets().then(function(){return getFacetValues()})}function facetValueToParam(values){if(!values||values.length===0){return null}return values.join(",")}function updateFacetCounts(countsArray){getFacets().then(function(facets){var isCountsSet=ng.isObject(countsArray);ng.forEach(facets,function(facet){facet.updateCounts(isCountsSet&&ng.isDefined(countsArray[facet.name])?twoDimensionArrayToObject(countsArray[facet.name]):{},isCountsSet)})})}function setFacetDefaultValues(facetValues){var isInitFromQuery=isInitSuggestedCategories;isInitSuggestedCategories=false;getFacets().then(function(facets){ng.forEach(facets,function(facet,facetName){var hasSetValue=ng.isDefined(facetValues[facetName]);if(hasSetValue||facet.hasFacetValues()){try{facet.setSilentMode(true);if(hasSetValue){facet.setInitValues(facetValues[facetName])}else{facet.setEmptyDefaultValues()}}finally{facet.setSilentMode(false)}}});eventBus.publish("filters:changed",{facets:facets});if(isInitFromQuery){updateRecommendedCategories()}})}function twoDimensionArrayToObject(jsonArray){var object={};jsonArray.map(function(item){object[item[0]]=item[1]});return object}function warmup(){getConfig();flSearchApiService.getBulkPredefinedListValues()}function getResultsFromResponse(response){return response&&ng.isObject(response.data)&&ng.isObject(response.data.results)?response.data.results:{}}function updateCountsFromResponse(response){var results=getResultsFromResponse(response);updateFacetCounts(results.counts)}function updateRecommendedCategories(){getFacets().then(function(facets){loadSuggestedCategories(facets["q"]?facets["q"].getFirstValue():"")})}function setDefaultFacetFromResponse(response){var results=getResultsFromResponse(response);setFacetDefaultValues(ng.isObject(results.facets)?results.facets:{})}function loadSuggestedCategories(query){flSearchApiService.getSuggestedCategories(query).then(function(categories){getFacet("c").then(function(categoryFacet){var dataValues=categoryFacet.getDataValues();categoryFacet.filterShortlist(function(category){return previousSuggestedCategories.indexOf(category.value)===-1||dataValues.indexOf(category.value)>-1});previousSuggestedCategories=categories.slice(0);categoryFacet.addOptionsToShortlistFromValues(categories)})})}function waitForAll(promises){var deferred=$q.defer();var waitForCount=promises.length;promises.map(function(promise){promise.finally(function(){waitForCount--;if(waitForCount===0){deferred.resolve({})}})});return deferred.promise}}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.service("flSuggestionService",flSuggestionService);flSuggestionService.$inject=["$q","flSearchApiService"];function flSuggestionService($q,flSearchApiService){var jobListDeferred=$q.defer();this.getJobListAsPromise=function(){return jobListDeferred.promise};this.setJobList=function(jobList){$q.when(jobList).then(function(responseList){jobListDeferred.resolve(responseList)},function(response){jobListDeferred.reject(response)})};this.getKeywordSuggestions=function(query){return flSearchApiService.getKeywordSuggestions(query).then(function(response){if(response&&response.data&&ng.isArray(response.data.suggestions)){return response.data.suggestions}return[]})}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.service("flUrlService",flUrlService);flUrlService.$inject=[];function flUrlService(){return{buildUrl:buildUrl,buildQueryParams:buildQueryParams};function buildUrl(urlParams,urlPattern){var url=urlPattern;var urlValues=ng.extend({},urlParams);if(urlPattern){var re=/{([^}]+)}/g;var matches;while((matches=re.exec(urlPattern))!==null){var paramName=matches[1];var paramPattern=matches[0];if(ng.isDefined(urlValues[paramName])){url=url.replace(paramPattern,paramName+"/"+urlValues[paramName]);delete urlValues[paramName]}else{url=url.replace(paramPattern,"")}}url=url.replace(/\/+/g,"/")}var queryParams=buildQueryParams(urlValues);if(queryParams){url+=(url&&url.indexOf("?")>-1?"&":"?")+queryParams}return url}}function buildQueryParams(urlParams){var urlValues=ng.extend({},urlParams);if(ng.isObject(urlValues)){var queryParams=[];ng.forEach(urlValues,function(value,name){queryParams.push(name+"="+encodeURIComponent(value))});return queryParams.join("&")}return""}})(angular);
(function(ng){"use strict";try{ng.module("freelancer.search.facet.templates")}catch(e){ng.module("freelancer.search.facet.templates",[])}})(angular);
(function(ng){var module=ng.module("freelancer.search.facet");module.component("advancedTextSearchOptions",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("advancedTextSearchOptions")}],controller:textOptionsController,bindings:{isApplicantsBucket:"<?"},require:{parentCtrl:"^freelancerSearch"}});textOptionsController.$inject=["flQueryParserService"];function textOptionsController(flQueryParserService){var ctrl=this;var queryFacet=null;ctrl.isOptionsOpened=false;ctrl.fields={or_terms:"",and_terms:"",exact_terms:"",exclude_terms:"",title:""};ctrl.logSubLocation="keyword_search_advanced";this.$onInit=function(){ctrl.parentCtrl.getFacet("q").then(function(facet){queryFacet=facet})};ctrl.closeOptions=function(){ctrl.isOptionsOpened=false;ctrl.parentCtrl.logEvent("click",[{facet_value:getFieldLogValues()}],"advanced_query_close",ctrl.logSubLocation)};ctrl.queryUpdate=function(){var fields=ctrl.fields;var query=flQueryParserService.buildQuery(fields.and_terms,fields.or_terms,fields.exact_terms,fields.exclude_terms,fields.title);ctrl.queryTooLarge=query.length>200};ctrl.applyOptions=function(){var fields=ctrl.fields;if(ng.equals(ctrl.oldFields,getNormalizedCopy(fields))){ctrl.closeOptions();return}queryFacet.setValue(flQueryParserService.buildQuery(fields.and_terms,fields.or_terms,fields.exact_terms,fields.exclude_terms,fields.title));ctrl.parentCtrl.applyComponentChanges([queryFacet.name]);ctrl.parentCtrl.logEvent("click",[{facet_value:getFieldLogValues()}],"advanced_query_apply",ctrl.logSubLocation);ctrl.closeOptions()};ctrl.toggleClicked=function(){if(!ctrl.isOptionsOpened&&queryFacet!==null){var queryTokens=flQueryParserService.parseQuery(queryFacet.getFirstValue());ctrl.fields.and_terms=queryTokens.allWords;ctrl.fields.or_terms=queryTokens.anyWords;ctrl.fields.exact_terms=queryTokens.exactPhrase;ctrl.fields.exclude_terms=queryTokens.excludeWords;ctrl.fields.title=queryTokens.titlePhrase;ctrl.oldFields=getNormalizedCopy(ctrl.fields)}ctrl.parentCtrl.logEvent("click",[{facet_value:getFieldLogValues()}],ctrl.isOptionsOpened?"advanced_query_close":"advanced_query_open",ctrl.logSubLocation);ctrl.queryUpdate()};function getFieldLogValues(){var values={};ng.forEach(ctrl.fields,function(value,name){values[name]=value});return values}function getNormalizedCopy(fields){var newFields=ng.copy(fields);ng.forEach(newFields,function(value,key){newFields[key]=value.trim()});return newFields}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("facetInputCategory",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("facetInputCategory")}],require:{parentCtrl:"^freelancerSearch"},controller:facetInputCategory,bindings:{facetName:"@",label:"@",labelAny:"@"}});function facetInputCategory(){var ctrl=this;var callbacksUnwatch=[];ctrl.value=null;ctrl.parentCategoryUid=null;ctrl.$onInit=function(){ctrl.parentCtrl.getFacet(ctrl.facetName).then(function(facet){ctrl.facet=facet;callbacksUnwatch.push(ctrl.facet.registerCallback("value:change",function(){setModelValue()}));setModelValue()})};ctrl.$onDestroy=function(){ctrl.parentCtrl.unwatchListeners(callbacksUnwatch)};function setModelValue(){var model=ctrl.facet.getFirstFacetValue();if(model===null){ctrl.value=null;ctrl.parentCategoryUid=null}else if(model){ctrl.value=model.value;ctrl.parentCategoryUid=model.parentCategoryUid}}ctrl.onSelectItem=function(facetListItem){if(facetListItem!==null){ctrl.facet.addToShortlist(facetListItem);ctrl.parentCtrl.logEvent("click",[{facet_value:facetListItem.value}],"facets_category_select_value",ctrl.facet.config.logSubLocation)}};ctrl.changeFacetValue=function(facetListItem){ctrl.facet.changeFacetValue(facetListItem);ctrl.parentCtrl.logEvent("change",[{facet_value:facetListItem?facetListItem.value:"any"}],"facets_category_select_value",ctrl.facet.config.logSubLocation)};ctrl.isActive=function(category,subcategory){return category===ctrl.value&&subcategory===null||(category===ctrl.parentCategoryUid||category===ctrl.value)&&ng.isUndefined(subcategory)||subcategory===ctrl.value&&category===ctrl.parentCategoryUid}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("facetInputCheckbox",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("facetInputCheckbox")}],transclude:true,require:{parentCtrl:"^freelancerSearch"},controller:facetInputCheckbox,bindings:{facetName:"@",label:"@?"}});function facetInputCheckbox(){var ctrl=this;var trueValue=null;var falseValue=null;var callbacksUnwatch=[];ctrl.value=null;ctrl.$onInit=function(){var initCtrlValue=function(){ctrl.value=ctrl.facet.getFirstValue()===trueValue.value};ctrl.parentCtrl.getFacet(ctrl.facetName).then(function(facet){ctrl.facet=facet;ng.forEach(ctrl.facet.valueList.flatList,function(item){if(item.value===false||item.value==="no"){falseValue=item}if(item.value===true||item.value==="yes"){trueValue=item}});initCtrlValue();callbacksUnwatch.push(ctrl.facet.registerCallback("value:change",function(){initCtrlValue()}))})};ctrl.$onDestroy=function(){ctrl.parentCtrl.unwatchListeners(callbacksUnwatch)};ctrl.changeFacetValue=function(){ctrl.facet.changeFacetValue(ctrl.value?trueValue:falseValue);ctrl.parentCtrl.logEvent("change",[{facet_value:ctrl.value}],["facets",ctrl.facetName,ctrl.value?"select":"deselect","value"].join("_"),ctrl.facet.config.logSubLocation)}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("facetInputLocationList",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("facetInputLocationList")}],require:{parentCtrl:"^freelancerSearch"},controller:facetInputLocationList,bindings:{facetName:"@",label:"@",labelSearch:"@",labelAny:"@",labelListEmpty:"@?"}});facetInputLocationList.$inject=["$scope","flConfig","FREELANCER_SEARCH_LOCATION_LIMIT","FREELANCER_SEARCH_LOCATION_TYPES","EO_TYPEAHEAD_ITEM_TYPE_HEADER"];function facetInputLocationList($scope,flConfig,locationLimit,locationTypes,EO_TYPEAHEAD_ITEM_TYPE_HEADER){var ctrl=this;ctrl.searchList=[];var callbacksUnwatch=[];var fullList=[];var lastFilteredPath=null;var regionsHeader={isHeader:true,label:"Regions",isEnabled:true,type:EO_TYPEAHEAD_ITEM_TYPE_HEADER};var subRegionsHeader={isHeader:true,label:"Subregions",isEnabled:true,type:EO_TYPEAHEAD_ITEM_TYPE_HEADER};var countriesHeader={isHeader:true,label:"Countries",isEnabled:true,type:EO_TYPEAHEAD_ITEM_TYPE_HEADER};ctrl.isEmptySelected=false;ctrl.noMatchingFound=false;ctrl.labelListEmpty=ctrl.labelListEmpty||"No matching locations found";ctrl.getItemTemplateUrl=function(){return flConfig.getTemplateUrl("components/facet-input-location-list/list-item.html")};ctrl.getList=function(filterString){if(filterString){return getFilteredList(filterString)}else{return fullList}};ctrl.$onInit=function(){ctrl.parentCtrl.getFacet(ctrl.facetName).then(function(facet){ctrl.facet=facet;initLists();callbacksUnwatch.push(ctrl.facet.registerCallback("value:change",function(){trackShortlistChanged();filterLists()}))})};ctrl.$onDestroy=function(){ctrl.parentCtrl.unwatchListeners(callbacksUnwatch)};function trackShortlistChanged(){if(ctrl.facet.valueList.hasShortListSelected()&&ctrl.isEmptySelected){ctrl.isEmptySelected=false}else if(!ctrl.facet.valueList.hasShortListSelected()&&!ctrl.isEmptySelected){ctrl.isEmptySelected=true}}function initLists(){var srcList=ctrl.facet.valueList.sourceList;fullList.push(regionsHeader);ng.forEach(srcList.regions,function(item){fullList.push(item)});fullList.push(subRegionsHeader);ng.forEach(srcList.subregions,function(item){fullList.push(item)});fullList.push(countriesHeader);ng.forEach(srcList.countries,function(item){fullList.push(item)});ctrl.searchList=fullList.filter(function(item){return!item.isHeader});filterLists()}function locationSortComparator(a,b){if(a.label===b.label){return 0}return a.label>b.label?1:-1}function filterLists(){var shortListValues=ctrl.facet.valueList.shortList.map(function(item){return item.value});var currentPath=shortListValues.join(",");if(lastFilteredPath!==currentPath){var isRegionsHeader=false;var isCountriesHeader=false;var isSubRegionsHeader=false;lastFilteredPath=currentPath;fullList=fullList.filter(function(item){var isOn=item.isHeader||shortListValues.indexOf(item.value)===-1;if(isOn&&!item.isHeader){if(item.locationType===locationTypes.country){isCountriesHeader=true}else if(item.locationType===locationTypes.region){isRegionsHeader=true}else if(item.locationType===locationTypes.subRegion){isSubRegionsHeader=true}}return isOn});ctrl.searchList=ctrl.searchList.filter(function(item){return shortListValues.indexOf(item.value)===-1});ctrl.noMatchingFound=ctrl.searchList.length===0;regionsHeader.isEnabled=isRegionsHeader;countriesHeader.isEnabled=isCountriesHeader;subRegionsHeader.isEnabled=isSubRegionsHeader}}ctrl.emptyValueChanged=function(){ctrl.facet.clearFacetValues();if(ctrl.isEmptySelected){ctrl.parentCtrl.logEvent("click",[{facet_value:"any"}],"facets_location_select_value",ctrl.facet.config.logSubLocation)}};ctrl.onSuggestionSelect=function(facetListItem){if(!facetListItem.isHeader){ctrl.facet.valueList.addToShortList(facetListItem);ctrl.facet.changeFacetValue(facetListItem);ctrl.parentCtrl.logEvent("click",[{facet_value:facetListItem.value}],"facets_location_"+(facetListItem.isSelected?"select":"deselect")+"_value",ctrl.facet.config.logSubLocation)}$scope.typeAheadSelected=null;filterLists()};ctrl.changeFacetValue=function(facetListItem){ctrl.facet.changeFacetValue(facetListItem);ctrl.parentCtrl.logEvent("change",[{facet_value:facetListItem.value}],"facets_location_"+(facetListItem.isSelected?"select":"deselect")+"_value",ctrl.facet.config.logSubLocation)};function startsWith(str,search){return str.slice(0,search.length)===search}function getFilteredList(filterString){filterString=filterString.toLowerCase();var countryList=[];var regionList=[];var subRegionList=[];var relatedRegions=[];var relatedSubRegions=[];var countCountries=0;var countRegions=0;var countSubRegions=0;var maxItems=locationLimit.maxCountries+locationLimit.maxRegions+locationLimit.maxSubRegions;var filterStringInside=" "+filterString;var shortList=ctrl.facet.valueList.shortList;ctrl.searchList.filter(function(item){if(countCountries===maxItems&&countRegions===maxItems&&countSubRegions===maxItems||item.locationType==="Country"&&countCountries===maxItems){return false}var name=item.label.toLowerCase();if(startsWith(name,filterString)||name.indexOf(filterStringInside)!==-1){if(item.locationType==="Country"){if(item.relatedRegion&&shortList.indexOf(item.relatedRegion)===-1&&relatedRegions.indexOf(item.relatedRegion)===-1){relatedRegions.push(item.relatedRegion)}if(item.relatedSubRegion&&shortList.indexOf(item.relatedSubRegion)===-1&&relatedSubRegions.indexOf(item.relatedSubRegion)===-1){relatedSubRegions.push(item.relatedSubRegion)}countryList.push(item);countCountries++}else if(item.locationType==="Region"){regionList.push(item);countRegions++}else if(item.locationType==="Subregion"){subRegionList.push(item);countSubRegions++;if(item.relatedRegion&&shortList.indexOf(item.relatedRegion)===-1&&relatedRegions.indexOf(item.relatedRegion)===-1){relatedRegions.push(item.relatedRegion)}}}});if(countCountries>locationLimit.maxCountries){countryList=countryList.slice(0,locationLimit.maxCountries);countCountries=locationLimit.maxCountries}if(countSubRegions<locationLimit.maxSubRegions){ng.forEach(relatedSubRegions,function(subRegion){if(countSubRegions<locationLimit.maxSubRegions&&subRegionList.indexOf(subRegion)===-1){subRegionList.push(subRegion);countSubRegions++}})}else if(countSubRegions>locationLimit.maxSubRegions){subRegionList=subRegionList.slice(0,locationLimit.maxSubRegions);countSubRegions=locationLimit.maxSubRegions}var maxRegionCount=maxItems-countSubRegions-countCountries;if(countRegions<maxRegionCount){ng.forEach(relatedRegions,function(region){if(countRegions<maxRegionCount&&regionList.indexOf(region)===-1){regionList.push(region);countRegions++}})}else if(countRegions>maxRegionCount){regionList=regionList.slice(0,maxRegionCount)}return countryList.concat(subRegionList.sort(locationSortComparator)).concat(regionList.sort(locationSortComparator))}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("facetInputRadioList",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("facetInputRadioList")}],require:{parentCtrl:"^freelancerSearch"},controller:facetInputRadioList,bindings:{facetName:"@",label:"@",hasCounts:"@?"}});function facetInputRadioList(){var ctrl=this;var callbacksUnwatch=[];ctrl.value=null;ctrl.$onInit=function(){ctrl.isShowFacetCounts=ng.isUndefined(ctrl.hasCounts)||ctrl.hasCounts==="true";ctrl.parentCtrl.getFacet(ctrl.facetName).then(function(facet){ctrl.facet=facet;ctrl.value=facet.getFirstValue();callbacksUnwatch.push(ctrl.facet.registerCallback("value:change",function(){ctrl.value=facet.getFirstValue()}))})};ctrl.$onDestroy=function(){ctrl.parentCtrl.unwatchListeners(callbacksUnwatch)};ctrl.changeFacetValue=function(facetListItem){ctrl.facet.changeFacetValue(facetListItem);ctrl.parentCtrl.logEvent("change",[{facet_value:facetListItem.value||"any"}],"facets_"+ctrl.facetName+"_select_value",ctrl.facet.config.logSubLocation)}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("facetInputSearch",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("facetInputSearch")}],require:{parentCtrl:"^freelancerSearch"},controller:facetInputSearch,bindings:{facetName:"@",class:"@?",placeholder:"@?",onInputTextKeyEnter:"&?",onInputTextKeyup:"&?",onInputTextFocus:"&?",onInputTextChange:"&?",suggestionTypes:"@?"}});facetInputSearch.$inject=["filterFilter","flSuggestionService","EO_TYPEAHEAD_ITEM_TYPE_HEADER","flFacetListService","flConfig","$q"];function facetInputSearch(filterFilter,flSuggestionService,EO_TYPEAHEAD_ITEM_TYPE_HEADER,flFacetListService,flConfig,$q){var ctrl=this;var callbacksUnwatch=[];var prevQueryText=null;var suggestionJobList=[];var openingUidFacet=null;var queryBuilderHasSuggestions=false;ctrl.enabledSuggestionTypes={jobs:false,queryBuilder:false,keywordSuggestions:false};initSuggestionTypes(ctrl.suggestionTypes,ctrl.enabledSuggestionTypes);ctrl.facetValue=null;ctrl.hintQuery="";ctrl.suggestionList={filterText:"",queryBuilderHasSuggestions:false,promiseOfListValues:$q.resolve([])};ctrl.$onInit=function(){if(ctrl.enabledSuggestionTypes.jobs){initJobSuggestionList()}var initCompleted=false;var initFacet=function(facet){if(!initCompleted){initCompleted=true;ctrl.facet=facet;ctrl.facetValue=ctrl.facet.getFirstFacetValue();prevQueryText=ctrl.facetValue.value}};ctrl.parentCtrl.getFacetAsUntrusted(ctrl.facetName).then(function(facet){initFacet(facet)});ctrl.parentCtrl.getFacet(ctrl.facetName).then(function(facet){initFacet(facet);ctrl.getList(prevQueryText,true);callbacksUnwatch.push(ctrl.facet.registerCallback("component:apply",function(){ctrl.facet.changeFacetValue(ctrl.facetValue);clearOpeningFacetUidIfNotEmpty()}));callbacksUnwatch.push(ctrl.facet.registerCallback("value:change",function(){prevQueryText=ctrl.facetValue.value;ctrl.getList(prevQueryText,false)}))})};ctrl.$onDestroy=function(){ctrl.parentCtrl.unwatchListeners(callbacksUnwatch)};ctrl.getItemTemplateUrl=function(){return flConfig.getTemplateUrl("components/facet-input-search/list-item.html")};ctrl.onChooseSuggestion=function(newQuery){ctrl.facetValue.value=newQuery;ctrl.facet.changeFacetValue(ctrl.facetValue)};ctrl.afterQueryBuilderSearchEvent=function(suggestions){queryBuilderHasSuggestions=suggestions&&suggestions.length>0};ctrl.setHintQuery=function(hint){ctrl.hintQuery=hint};ctrl.suggestedValueModel=function(newValue){if(ctrl.facetValue===null){return""}if(ng.isDefined(newValue)){if(ng.isString(newValue)){ctrl.facetValue.value=newValue}else{if(newValue instanceof SuggestionOpening){prevQueryText=null;ctrl.facetValue.value=null}else if(newValue instanceof KeywordSuggestion){prevQueryText=newValue.title;ctrl.facetValue.value=newValue.title}}}return ctrl.facetValue.value};ctrl.onSuggestionSelect=function(model){if(model instanceof SuggestionOpening){openingUidFacet.setValue(model.uid);openingUidFacet.changeFacetValue(openingUidFacet.getFirstFacetValue());ctrl.parentCtrl.logEvent("click",[{facet_value:model.uid}],"facets_"+openingUidFacet.name+"_select_value",openingUidFacet.config.logSubLocation)}else if(model instanceof KeywordSuggestion){ctrl.parentCtrl.logEvent("click",[{facet_value:ctrl.facetValue.value}],"facets_"+ctrl.facetName+"_change_value","suggestion_keyword");ctrl.facet.changeFacetValue(ctrl.facetValue)}};ctrl.onKeydown=function($event){if($event.keyCode===13){$event.preventDefault();ctrl.facet.changeFacetValue(ctrl.facetValue);if(openingUidFacet){ctrl.parentCtrl.logEvent("keypress",[{facet_value:ctrl.facetValue.value}],"facets_"+ctrl.facetName+"_change_value",openingUidFacet.config.logSubLocation)}ctrl.onInputTextKeyEnter($event)}};function onInputTextChange(){if(ng.isFunction(ctrl.onInputTextChange)){ctrl.onInputTextChange({text:ctrl.facetValue.value})}clearOpeningFacetUidIfNotEmpty()}ctrl.onKeyup=function($event){if(prevQueryText!==null&&prevQueryText!==ctrl.facetValue.value){onInputTextChange();prevQueryText=ctrl.facetValue.value;ctrl.getList(prevQueryText,false)}if(ng.isFunction(ctrl.onInputTextKeyup)){ctrl.onInputTextKeyup({text:ctrl.facetValue.value,$event:$event})}};ctrl.onFocus=function($event){if(ng.isFunction(ctrl.onInputTextFocus)){ctrl.onInputTextFocus({text:ctrl.facetValue.value,$event:$event})}};function initJobSuggestionList(){var jobListPromise=flSuggestionService.getJobListAsPromise();var openingFacetPromise=ctrl.parentCtrl.getFacet("opening_uid");$q.all([jobListPromise,openingFacetPromise]).then(function(responses){var jobList=responses[0];openingUidFacet=responses[1];var facetListValues=[];ng.forEach(jobList,function(job){suggestionJobList.push(new SuggestionOpening(job.uid,job.title));facetListValues.push({value:job.uid,label:job.title})});openingUidFacet.setValueList(flFacetListService.createFacetValueList(facetListValues));ctrl.getList(prevQueryText,true)},function(){ctrl.enabledSuggestionTypes.jobs=false})}ctrl.getList=function(filterString,isForceUpdate){var isUpdate=ctrl.suggestionList.filterText!==filterString||queryBuilderHasSuggestions!==ctrl.suggestionList.queryBuilderHasSuggestions||isForceUpdate;if(isUpdate){ctrl.suggestionList.filterText=filterString;ctrl.suggestionList.queryBuilderHasSuggestions=queryBuilderHasSuggestions;ctrl.suggestionList.promiseOfListValues=getSuggestionListPromise(filterString)}return ctrl.suggestionList.promiseOfListValues};function getSuggestionListPromise(filterText){if(queryBuilderHasSuggestions||filterText===null){return $q.resolve([])}filterText=filterText.replace(/^ +| +$/g,"");var jobsDefer=$q.defer();var keywordsDefer=$q.defer();var jobs=[];if(ctrl.enabledSuggestionTypes.jobs){if(filterText.length>0){jobs=filterFilter(suggestionJobList,{title:filterText})}if(jobs.length>0){jobs=[{title:"Open jobs",type:EO_TYPEAHEAD_ITEM_TYPE_HEADER}].concat(jobs)}}jobsDefer.resolve(jobs);var isEmptyKeywords=true;if(ctrl.enabledSuggestionTypes.keywordSuggestions){if(filterText.length>0){isEmptyKeywords=false;flSuggestionService.getKeywordSuggestions(filterText).then(function(keywords){if(ng.isArray(keywords)&&keywords.length>0){keywordsDefer.resolve([{title:"Search suggestions",type:EO_TYPEAHEAD_ITEM_TYPE_HEADER}].concat(keywords.map(function(keyword){return new KeywordSuggestion(keyword)})))}else{keywordsDefer.resolve([])}},function(){keywordsDefer.resolve([])})}}if(isEmptyKeywords){keywordsDefer.resolve([])}return $q.all([jobsDefer.promise,keywordsDefer.promise]).then(function(suggestions){return Array.prototype.concat.apply([],suggestions)})}function initSuggestionTypes(fromString,suggestionTypes){if(fromString){var types=fromString.replace(/ /g,"").split(",");Object.keys(suggestionTypes).map(function(typeKey){suggestionTypes[typeKey]=types.indexOf(typeKey)!==-1})}}function clearOpeningFacetUidIfNotEmpty(){if(ctrl.enabledSuggestionTypes.jobs&&openingUidFacet&&openingUidFacet.hasFacetValues()){openingUidFacet.clearFacetValues()}}function SuggestionOpening(uid,title){this.uid=uid;this.title=title}function KeywordSuggestion(title){this.title=title}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("facetInputSelect",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("facetInputSelect")}],require:{parentCtrl:"^freelancerSearch"},controller:facetInputSelect,bindings:{facetName:"@",label:"@",isDisabled:"<"}});function facetInputSelect(){var ctrl=this;ctrl.selected=null;var callbacksUnwatch=[];ctrl.$onInit=function(){ctrl.parentCtrl.getFacet(ctrl.facetName).then(function(facet){ctrl.facet=facet;ctrl.selected=facet.getFirstFacetValue();callbacksUnwatch.push(ctrl.facet.registerCallback("value:change",function(){ctrl.selected=facet.getFirstFacetValue()}))})};ctrl.$onDestroy=function(){ctrl.parentCtrl.unwatchListeners(callbacksUnwatch)};ctrl.changeFacetValue=function(facetListItem){ctrl.facet.changeFacetValue(facetListItem);if(ctrl.facet.name==="tests_10"){ctrl.parentCtrl.getFacet("tests").then(function(facet){var logInfo=[{facet_value:facet.getDataValues()}];var percentileValue=facetListItem.value==="yes"?"10":"30";logInfo[0].percentile=percentileValue;ctrl.parentCtrl.logEvent("click",logInfo,["facets_tests",percentileValue,"select_value"].join("_"),facet.config.logSubLocation)})}else{ctrl.parentCtrl.logEvent("click",[{facet_value:facetListItem.value}],"facets_"+ctrl.facetName+"_select_value",ctrl.facet.config.logSubLocation)}}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("facetInputSuggestionList",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("facetInputSuggestionList")}],require:{parentCtrl:"^freelancerSearch"},controller:facetInputSuggestionList,transclude:true,bindings:{facetName:"@",label:"@",labelSearch:"@",labelAny:"@",labelMatchingNotFound:"@",shortListLabelMaxLen:"@?",labelListEmpty:"@?"}});facetInputSuggestionList.$inject=["flConfig","eoTruncateHelper"];function facetInputSuggestionList(flConfig,eoTruncateHelper){var ctrl=this;var callbacksUnwatch=[];ctrl.searchList=[];ctrl.isEmptySelected=false;ctrl.noMatchingFound=false;ctrl.textMatchingNotFound="No matching "+ctrl.labelMatchingNotFound+" found";ctrl.labelListEmpty=ctrl.labelListEmpty||"List is empty";ctrl.$onInit=function(){ctrl.parentCtrl.getFacet(ctrl.facetName).then(function(facet){ctrl.facet=facet;initLists();callbacksUnwatch.push(ctrl.facet.registerCallback("value:change",function(){trackShortlistChanged()}))})};ctrl.$onDestroy=function(){ctrl.parentCtrl.unwatchListeners(callbacksUnwatch)};function trackShortlistChanged(){if(ctrl.facet.valueList.hasShortListSelected()&&ctrl.isEmptySelected){ctrl.isEmptySelected=false}else if(!ctrl.facet.valueList.hasShortListSelected()&&!ctrl.isEmptySelected){ctrl.isEmptySelected=true}filterList()}function initLists(){ng.forEach(ctrl.facet.valueList.flatList,function(item){ctrl.searchList.push(item)});filterList()}function filterList(){ctrl.searchList=ctrl.searchList.filter(function(item){return ctrl.facet.valueList.shortList.indexOf(item)===-1});ctrl.noMatchingFound=ctrl.searchList.length===0}ctrl.getItemTemplateUrl=function(){return flConfig.getTemplateUrl("components/facet-input-suggestion-list/list-item.html")};ctrl.emptyValueChanged=function(){ctrl.facet.clearFacetValues();if(ctrl.isEmptySelected){ctrl.parentCtrl.logEvent("click",[{facet_value:"any"}],"facets_"+ctrl.facetName+"_select_value",ctrl.facet.config.logSubLocation)}};ctrl.onSuggestionSelect=function(facetListItem){ctrl.facet.addToShortlist(facetListItem);ctrl.typeAheadSelected=null;filterList();logEvent("click",facetListItem)};ctrl.changeFacetValue=function(facetListItem){ctrl.facet.changeFacetValue(facetListItem);logEvent("change",facetListItem)};ctrl.getItemTitle=function(label){if(ctrl.shortListLabelMaxLen&&label.length>ctrl.shortListLabelMaxLen){return label}return""};ctrl.getItemLabel=function(label){if(ctrl.shortListLabelMaxLen&&label.length>ctrl.shortListLabelMaxLen){return eoTruncateHelper.truncateByChars(label,ctrl.shortListLabelMaxLen)}return label};function logEvent(event,facetListItem){var logInfo=[{facet_value:facetListItem.value}];if(ctrl.facet.name==="tests"){ctrl.parentCtrl.getFacet("tests_10").then(function(facet){logInfo[0].percentile=facet.getFirstValue()==="yes"?"10":"30";ctrl.parentCtrl.logEvent(event,logInfo,["facets",ctrl.facetName,facetListItem.isSelected?"select":"deselect","value"].join("_"),ctrl.facet.config.logSubLocation)})}else{ctrl.parentCtrl.logEvent(event,logInfo,["facets",ctrl.facetName,facetListItem.isSelected?"select":"deselect","value"].join("_"),ctrl.facet.config.logSubLocation)}}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("facetInputUsLocationList",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("facetInputUsLocationList")}],require:{parentCtrl:"^freelancerSearch"},controller:facetInputUsLocationList,bindings:{facetName:"@",label:"@",labelSearch:"@",labelAny:"@",labelListEmpty:"@?"}});facetInputUsLocationList.$inject=["$scope","flConfig","FREELANCER_SEARCH_LOCATION_TYPES","FREELANCER_SEARCH_LOCATION_LIMIT","EO_TYPEAHEAD_ITEM_TYPE_HEADER"];function facetInputUsLocationList($scope,flConfig,locationTypes,locationLimit,EO_TYPEAHEAD_ITEM_TYPE_HEADER){var ctrl=this;ctrl.searchList=[];var callbacksUnwatch=[];var fullList=[];var lastFilteredPath=null;var timezonesHeader={isHeader:true,label:"Timezones",isVisible:true,type:EO_TYPEAHEAD_ITEM_TYPE_HEADER};var statesHeader={isHeader:true,label:"States",isVisible:true,type:EO_TYPEAHEAD_ITEM_TYPE_HEADER};ctrl.isEmptySelected=false;ctrl.noMatchingFound=false;ctrl.labelListEmpty=ctrl.labelListEmpty||"No matching locations found";ctrl.getItemTemplateUrl=function(){return flConfig.getTemplateUrl("components/facet-input-us-location-list/list-item.html")};ctrl.getList=function(filterString){if(filterString){return getFilteredList(filterString)}else{return fullList}};ctrl.$onInit=function(){ctrl.parentCtrl.getFacet(ctrl.facetName).then(function(facet){ctrl.facet=facet;initLists();callbacksUnwatch.push(ctrl.facet.registerCallback("value:change",function(){trackShortlistChanged();filterLists()}))})};ctrl.$onDestroy=function(){ctrl.parentCtrl.unwatchListeners(callbacksUnwatch)};function trackShortlistChanged(){if(ctrl.facet.valueList.hasShortListSelected()&&ctrl.isEmptySelected){ctrl.isEmptySelected=false}else if(!ctrl.facet.valueList.hasShortListSelected()&&!ctrl.isEmptySelected){ctrl.isEmptySelected=true}}function initLists(){var srcList=ctrl.facet.valueList.sourceList;fullList.push(timezonesHeader);ng.forEach(srcList.timezones,function(item){fullList.push(item)});fullList.push(statesHeader);ng.forEach(srcList.states,function(item){fullList.push(item)});var searchList=fullList.filter(function(item){return!item.isHeader});searchList.sort(locationSortComparator);ctrl.searchList=searchList;filterLists()}function locationSortComparator(a,b){if(a.locationType!==b.locationType){return a.locationType===locationTypes.timezone?-1:1}if(a.label===b.label){return 0}return a.label>b.label?1:-1}function filterLists(){var shortListValues=ctrl.facet.valueList.shortList.map(function(item){return item.value});var currentPath=shortListValues.join(",");if(lastFilteredPath!==currentPath){var isTimezonesHeader=false;var isStatesHeader=false;lastFilteredPath=currentPath;fullList=fullList.filter(function(item){var isOn=item.isHeader||shortListValues.indexOf(item.value)===-1;if(isOn&&!item.isHeader){if(item.locationType===locationTypes.timezone){isTimezonesHeader=true}else{isStatesHeader=true}}return isOn});ctrl.searchList=ctrl.searchList.filter(function(item){return shortListValues.indexOf(item.value)===-1});ctrl.noMatchingFound=ctrl.searchList.length===0;timezonesHeader.isVisible=isTimezonesHeader;statesHeader.isVisible=isStatesHeader}}ctrl.emptyValueChanged=function(){ctrl.facet.clearFacetValues();if(ctrl.isEmptySelected){ctrl.parentCtrl.logEvent("click",[{facet_value:"any"}],"facets_location_select_value",ctrl.facet.config.logSubLocation)}};ctrl.onSuggestionSelect=function(facetListItem){if(!facetListItem.isHeader){ctrl.facet.valueList.addToShortList(facetListItem);ctrl.facet.changeFacetValue(facetListItem);ctrl.parentCtrl.logEvent("click",[{facet_value:facetListItem.value}],"facets_us_location_"+(facetListItem.isSelected?"select":"deselect")+"_value",ctrl.facet.config.logSubLocation)}$scope.typeAheadSelected=null;filterLists()};ctrl.changeFacetValue=function(facetListItem){ctrl.facet.changeFacetValue(facetListItem);ctrl.parentCtrl.logEvent("change",[{facet_value:facetListItem.value}],"facets_us_location_"+(facetListItem.isSelected?"select":"deselect")+"_value",ctrl.facet.config.logSubLocation)};function getFilteredList(filterString){filterString=filterString.toLowerCase();var timezoneList=[];var stateList=[];var countTimezones=0;var countStates=0;var maxItems=locationLimit.maxTimezones+locationLimit.maxStates;ctrl.searchList.filter(function(item){if(countTimezones===maxItems&&countStates===maxItems||item.locationType===locationTypes.state&&countStates===maxItems){return false}if(item.label.toLowerCase().indexOf(filterString)!==-1){if(item.locationType===locationTypes.state){stateList.push(item);countStates++}else{timezoneList.push(item);countTimezones++}}});if(countStates>locationLimit.maxStates){stateList=stateList.slice(0,locationLimit.maxStates);countStates=locationLimit.maxStates}var maxTimezoneCount=maxItems-countStates;if(countTimezones>maxTimezoneCount){timezoneList=timezoneList.slice(0,maxTimezoneCount)}return stateList.concat(timezoneList)}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("facetInputUsMarketplace",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("facetInputUsMarketplace")}],transclude:true,require:{parentCtrl:"^freelancerSearch"},controller:facetInputUsMarketplace,bindings:{facetName:"@",label:"@"}});function facetInputUsMarketplace(){var ctrl=this;var callbacksUnwatch=[];var marketplace={global:"1",usOnly:"2"};var trueValueUsOnly;var falseValueGlobal;ctrl.value=null;ctrl.facet=null;ctrl.$onInit=function(){var initCtrlValue=function(){ctrl.value=ctrl.facet.getFirstValue()===trueValueUsOnly.value};var initCompleted=false;var initFacet=function(facet){if(!initCompleted){initCompleted=true;ctrl.facet=facet;initTrueFalseValues(ctrl.facet)}};ctrl.parentCtrl.getFacetAsUntrusted(ctrl.facetName).then(function(facet){initFacet(facet)});ctrl.parentCtrl.getFacet(ctrl.facetName).then(function(facet){initFacet(facet);initCtrlValue();callbacksUnwatch.push(ctrl.facet.registerCallback("value:change",function(){initCtrlValue()}))})};ctrl.$onDestroy=function(){ctrl.parentCtrl.unwatchListeners(callbacksUnwatch)};ctrl.changeFacetValue=function(value){ctrl.facet.changeFacetValue(value?trueValueUsOnly:falseValueGlobal);ctrl.parentCtrl.logEvent("change",[{facet_value:ctrl.value}],["facets",ctrl.facetName,ctrl.value?"on":"off"].join("_"),ctrl.facet.config.logSubLocation)};function initTrueFalseValues(facet){ng.forEach(facet.valueList.flatList,function(item){if(item.value===marketplace.global){falseValueGlobal=item}else if(item.value===marketplace.usOnly){trueValueUsOnly=item}})}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.directive("facetPanelTemplate",facetPanelTemplate);facetPanelTemplate.$inject=["flConfig","$templateRequest","$compile","FREELANCER_SEARCH_RECENT_EARNINGS_ENABLED"];function facetPanelTemplate(flConfig,$templateRequest,$compile,FREELANCER_SEARCH_RECENT_EARNINGS_ENABLED){return{template:"<div></div>",restrict:"E",require:"^freelancerSearch",link:link,scope:false};function link($scope,$element,$attrs,freelancerSearchController){var templateUrl=null;if($scope.templateName.indexOf("/")!==-1&&$scope.templateName.indexOf(".html")!==-1){templateUrl=$scope.templateName}else{templateUrl=flConfig.getTemplateUrl("components/facet-panel-template/templates/"+$scope.templateName+".html")}var isSearch=freelancerSearchController.serviceName==="freelancerSearch";$scope.earnedAmountLabel=FREELANCER_SEARCH_RECENT_EARNINGS_ENABLED&&isSearch?"Recent Earnings":"Earned Amount";if(templateUrl){$templateRequest(templateUrl,true).then(function(templateContent){$element.replaceWith($compile(templateContent)($scope))})}}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.directive("facetPanel",facetPanel);facetPanel.$inject=["flConfig"];function facetPanel(flConfig){return{templateUrl:flConfig.getComponentTemplateUrl("facetPanel"),restrict:"E",require:"^freelancerSearch",link:link,scope:false};function link($scope,$element,$attrs,searchController){$scope.$ctrl=this;$scope.$ctrl.parentCtrl=searchController;$scope.closeFilters=function(){searchController.closeFilters();searchController.logEvent("click",[],"collapse_filters","collapse_facets_advanced")}}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("facetValueCounter",{template:' <small data-ng-bind="$ctrl.textCount" class="text-muted"></small>',bindings:{counts:"<"},controller:facetValueCounter});facetValueCounter.$inject=["numberFilter"];function facetValueCounter(numberFilter){var ctrl=this;ctrl.textCount=null;ctrl.$onChanges=function(changesObj){var counts=changesObj.counts.currentValue;if(ng.isDefined(counts)&&counts!==null){ctrl.textCount="("+numberFilter(counts)+")"}else{ctrl.textCount=null}}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("filterPanel",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("filterPanel")}],require:{parentCtrl:"^freelancerSearch"},controller:filterPanel,bindings:{}});function filterPanel(){var ctrl=this;var callbacksUnwatch=[];ctrl.facetFilters=[];ctrl.clearFacetValue=function(facet,value){facet.clearByValue(value)};this.$onInit=function(){callbacksUnwatch.push(ctrl.parentCtrl.eventBus.listen("filters:changed",updateFilters));if(ctrl.parentCtrl.hasPanelFilters()){updateFilters()}};ctrl.$onDestroy=function(){ctrl.parentCtrl.unwatchListeners(callbacksUnwatch)};ctrl.clearFilters=function(){ctrl.parentCtrl.clearFilters();ctrl.parentCtrl.logEvent("click",[],"clear_filters","facets_clear_all")};function updateFilters(){var facetFilters=[];ng.forEach(ctrl.parentCtrl.facets,function(facet){if(facet.hasPanelFilter()){facet.values.map(function(filterValue){if(filterValue.label){facetFilters.push({label:facet.getPanelLabel(filterValue.label),clearFilter:clearFacetValue(facet,filterValue)})}})}});ctrl.facetFilters=facetFilters}function clearFacetValue(facet,value){return function(){facet.clearByValue(value);ctrl.parentCtrl.logEvent("remove",[{facet_value:value.value}],"facets_"+facet.name+"_deselect_value",facet.config.logSubLocation)}}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.directive("freelancerFacetSearch",freelancerFacetSearch);freelancerFacetSearch.$inject=["flConfig"];function freelancerFacetSearch(flConfig){return{templateUrl:flConfig.getComponentTemplateUrl("freelancerFacetSearch"),transclude:{facetFormRightSlot:"?facetFormRightSlot",facetFormUsToUsToggleSlot:"?facetFormUsToUsToggleSlot"},scope:{serviceName:"@",templateName:"@",callbackSearch:"&",suggestionTypes:"@",placeholderLabel:"@?",isCompactFormView:"<",isUsMarketplace:"@?"},link:link};function link($scope){}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("freelancerSearchForm",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("freelancerSearchForm")}],transclude:{facetFormRightSlot:"?facetFormRightSlot",facetFormUsToUsToggleSlot:"?facetFormUsToUsToggleSlot"},require:{parentCtrl:"^freelancerSearch"},controller:freelancerSearchForm,bindings:{isFiltersOpened:"=",suggestionTypes:"@",isCompactFormView:"<",isUsMarketplace:"@",isApplicantsBucket:"<?"}});freelancerSearchForm.$inject=[];function freelancerSearchForm(){var ctrl=this;ctrl.$onInit=function(){ctrl.searchColWidthClass=ctrl.isCompactFormView?"col-md-5":"col-md-8";ctrl.filterColWidthClass=ctrl.isCompactFormView?"col-md-1":"col-md-2";ctrl.transcludeColWidthClass=ctrl.isCompactFormView?"col-md-6":"col-md-2";if(ctrl.isUsMarketplace==="true"){ctrl.searchColWidthClass="col-md-6";ctrl.filterColWidthClass="col-md-4";ctrl.transcludeColWidthClass="col-md-2"}};ctrl.toggleFilters=function(){ctrl.parentCtrl.toggleFilters();ctrl.parentCtrl.logEvent("click",[],ctrl.parentCtrl.isFiltersOpened?"expand_filters":"collapse_filters","collapse_facets_advanced")};ctrl.search=function(){ctrl.parentCtrl.applyComponentChanges(["query"]);ctrl.parentCtrl.logEvent("click",[],"search_click","keyword_search")};ctrl.keypressEnterInSearchInput=function(){ctrl.parentCtrl.logEvent("keypress",[],"search_text_press_enter","keyword_search_text")}}})(angular);
(function(ng){"use strict";var module=ng.module("freelancer.search.facet");module.component("freelancerSearch",{controller:freelancerSearch,controllerAs:"$freelancerSearchCtrl",bindings:{serviceName:"@",callbackSearch:"&",placeholderLabel:"@?"},require:{logCtrl:"?^^logLocation"}});freelancerSearch.$inject=["$scope","flSearchService","$log","$q","flFacetConfig","$timeout"];function freelancerSearch($scope,flSearchService,$log,$q,flFacetConfig,$timeout){var ctrl=this;var searchService=null;var isSilentMode=false;var promiseConfig=null;var facetDeferrerList=[];var callbacksUnwatch=[];var isInSearch=false;ctrl.searchService=null;ctrl.eventBus=null;ctrl.isFiltersOpened=false;ctrl.isSearchInProgress=false;ctrl.isLoaded=null;ctrl.$onInit=function(){searchService=flSearchService.getService(ctrl.serviceName);promiseConfig=searchService.getConfig();initConfig(promiseConfig);ctrl.searchService=searchService;ctrl.eventBus=searchService.getEventBus();ctrl.isFiltersOpened=searchService.isFiltersOpened;callbacksUnwatch.push(ctrl.eventBus.listen("ui:filters:open",function(){ctrl.toggleFilters()}))};ctrl.$onDestroy=function(){ctrl.unwatchListeners(callbacksUnwatch)};ctrl.closeFilters=function(){ctrl.isFiltersOpened=false;syncFilterOpenState()};ctrl.toggleFilters=function(){ctrl.isFiltersOpened=!ctrl.isFiltersOpened;syncFilterOpenState()};function syncFilterOpenState(){searchService.isFiltersOpened=ctrl.isFiltersOpened}function onFacetValueChange(eventParams){var eventSilent=false;if(ng.isObject(eventParams)&&ng.isDefined(eventParams.silent)){eventSilent=eventParams.silent}if(!isSilentMode&&!eventSilent){if(!isInSearch){isInSearch=true;$timeout(function(){onFiltersChanged();ctrl.search();isInSearch=false},10)}}}function onFiltersChanged(){ctrl.eventBus.publish("filters:changed",{facets:ctrl.facets})}function initConfig(promise){promise.then(function(facets){ctrl.facets=facets;ng.forEach(ctrl.facets,function(facet){callbacksUnwatch.push(facet.registerCallback("value:change",onFacetValueChange))});onFiltersChanged();ctrl.isLoaded=true},function(){ctrl.isLoaded=false;if(ng.isObject(facetDeferrerList)){ng.forEach(facetDeferrerList,function(defer){defer.reject()})}})}ctrl.getFacet=function(name){if(!ng.isDefined(facetDeferrerList[name])){facetDeferrerList[name]=$q.defer();promiseConfig.then(function(facets){if(ng.isDefined(facets[name])&&facets[name]){facetDeferrerList[name].resolve(facets[name])}else{facetDeferrerList[name].reject()}})}return facetDeferrerList[name].promise};ctrl.getFacetAsUntrusted=function(name){return searchService.getConfigAsUntrusted().then(function(facets){if(ng.isDefined(facets[name])&&facets[name]){return facets[name]}return $q.reject()})};ctrl.hasPanelFilters=function(){var hasFilter=false;if(ctrl.facets){ng.forEach(ctrl.facets,function(facet,name){hasFilter=hasFilter||ctrl.facets[name].hasPanelFilter()})}return hasFilter};ctrl.clearFilters=function(){try{if(ctrl.facets){ng.forEach(ctrl.facets,function(facet){if(!flFacetConfig.isOmitFromClear(facet.name)&&facet.hasFacetValues()){try{facet.setSilentMode(true);facet.clearFacetValues()}finally{facet.setSilentMode(false)}}})}}catch(e){$log.error(e)}onFacetValueChange({})};ctrl.applyComponentChanges=function(facetNames){if(ctrl.facets){isSilentMode=true;var promises=[];facetNames.map(function(facetName){promises.push(ctrl.getFacet(facetName).then(function(facet){facet.publishEvent("component:apply",{})}))});onFiltersChanged();$q.all(promises).finally(function(){isSilentMode=false;onFacetValueChange({})})}};function onSearchComplete(){ctrl.isSearchInProgress=false;$scope.$applyAsync()}ctrl.search=function(){if(ng.isFunction(ctrl.callbackSearch)){ctrl.isSearchInProgress=true;ctrl.callbackSearch().finally(function(){onSearchComplete();searchService.updateRecommendedCategories()})}else{onSearchComplete();$log.error("Callback is not defined for search.")}};ctrl.unwatchListeners=function(listenerList){while(listenerList.length>0){var cb=listenerList.pop();if(ng.isFunction(cb)){cb()}else{$log.error("Unwatch listener is not a function: "+cb.toString())}}};ctrl.logEvent=function(){if(ng.isObject(ctrl.logCtrl)){ctrl.logCtrl.log.apply(ctrl.logCtrl,arguments)}}}})(angular);
(function(ng,applet){"use strict";var module=ng.module("freelancer.search.facet");module.component("queryBuilder",{templateUrl:["flConfig",function(flConfig){return flConfig.getComponentTemplateUrl("queryBuilder")}],controller:queryBuilderController,require:{parentCtrl:"^freelancerSearch"},bindings:{queryInput:"<",onQueryHintCallback:"&",onSelectCallback:"&",afterSearchEventCallback:"&"}});queryBuilderController.$inject=["flQueryBuilderService"];function queryBuilderController(flQueryBuilderService){var ctrl=this;var suggestionParentKey=false;var unlistenEventBus=null;var isCountQtEnabled=applet.getVar("isRoleBuilderResultsNumberEnabled")===true;ctrl.isCountEnabled=isCountQtEnabled;flQueryBuilderService.init();ctrl.$onChanges=function(changeObj){if(changeObj.queryInput&&ng.isDefined(changeObj.queryInput.currentValue)){setSuggestionsList(changeObj.queryInput.currentValue);setHintQuery("")}};ctrl.$onInit=function(){ctrl.suggestions=[];if(isCountQtEnabled){unlistenEventBus=ctrl.parentCtrl.eventBus.listen("filters:changed",function(){detectCountAvailability()});detectCountAvailability()}};ctrl.$onDestroy=function(){if(ng.isFunction(unlistenEventBus)){unlistenEventBus()}};ctrl.setHint=function(suggestionLabel){var hint="";if(suggestionLabel&&ctrl.queryInput){hint=ctrl.queryInput.replace(/ +$/,"")+" "+suggestionLabel}setHintQuery(hint)};ctrl.setQuery=function(suggestion){if(!ng.isObject(suggestion)){return}getServiceAsPromise().then(function(service){var newQuery=service.buildQuery(suggestion,ctrl.queryInput);ctrl.onSelectCallback({query:newQuery});logEvent(suggestion.query);setSuggestionsList(newQuery);setHintQuery("")})};function detectCountAvailability(){ctrl.isCountEnabled=isCountQtEnabled&&!ctrl.parentCtrl.hasPanelFilters()}function setHintQuery(hint){ctrl.onQueryHintCallback({hint:hint})}function fireSearchEvent(suggestions){ctrl.afterSearchEventCallback({suggestions:suggestions})}function setSuggestionsList(query){getServiceAsPromise().then(function(service){var result=service.getSuggestionList(query);var isLogImpression=result.isFound&&result.parentKey!==suggestionParentKey;suggestionParentKey=result.parentKey;ctrl.suggestions=result.suggestions;fireSearchEvent(result.suggestions);if(isLogImpression&&ctrl.suggestions.length){logEvent(false)}})}function logEvent(clickValue){var data={facet_value:clickValue||suggestionParentKey,query:ctrl.queryInput};if(clickValue){data.type="query"}else{data.roles=[];ng.forEach(ctrl.suggestions,function(suggestion){data.roles.push({label:suggestion.label,query:suggestion.query})})}ctrl.parentCtrl.logEvent(clickValue?"click":"impression",[data],clickValue?"select_role":"view_roles","facets_role_builder")}function getServiceAsPromise(){return flQueryBuilderService.getServiceAsPromise()}}})(angular,Applet);
(function(ng,applet){"use strict";var module=ng.module("atsUsMarket",["components.core.modal","components.core.log"]);module.constant("ATS_US_MARKET_API_URL_PREFIX",applet.getBasePath()+"/api").constant("ATS_US_MARKET_PREFERENCE_TYPES",{world:1,usOnly:2})})(angular,Applet);
(function(ng,applet){"use strict";var module=ng.module("atsUsMarket");module.controller("usPreferenceModalCtrl",usPreferenceModalCtrl);usPreferenceModalCtrl.$inject=["$modalInstance","_preferenceTypes","oLog","eoModelFactory","ATS_US_MARKET_EVENT_LOG_LOCATION"];function usPreferenceModalCtrl($modalInstance,_preferenceTypes,oLog,eoModelFactory,ATS_US_MARKET_EVENT_LOG_LOCATION){var vm=this;vm.close=close;vm.preferenceTypes=_preferenceTypes;vm.imageGlobeUrl=applet.buildInternalAssetPath("@UpworkAtsUsMarketBundle/images/globe.svg");logEvent({event:"impression"});$modalInstance.result.catch(function(){logEvent({event:"us_modal_close"})});function close(preferenceType,eventName){logEvent({event:eventName});$modalInstance.close({preferenceType:preferenceType})}function logEvent(eventData){var logData={location:ATS_US_MARKET_EVENT_LOG_LOCATION,sublocation:"us_modal",timestamp:Date.now()};ng.extend(logData,eventData);oLog.event(eoModelFactory.get("Event",logData))}}})(angular,Applet);
(function(ng,applet){"use strict";var module=ng.module("atsUsMarket");module.service("usPreferenceService",usPreferenceService);usPreferenceService.$inject=["$http","$httpParamSerializerJQLike","eoModal","ATS_US_MARKET_API_URL_PREFIX","ATS_US_MARKET_PREFERENCE_TYPES"];function usPreferenceService($http,$httpParamSerializerJQLike,eoModal,ATS_US_MARKET_API_URL_PREFIX,ATS_US_MARKET_PREFERENCE_TYPES){return{showModal:showModal,updateUserPreference:function(preferenceType){return storePreference(preferenceType)}};function showModal(){return eoModal.custom({locals:{_customInjectable:"injected",_preferenceTypes:ATS_US_MARKET_PREFERENCE_TYPES},keyboard:false,size:"sm",windowClass:"us-preference-modal",controller:"usPreferenceModalCtrl",controllerAs:"vm",templateUrl:applet.buildInternalAssetPath("@UpworkAtsUsMarketBundle/js/us-preference/us-preference-modal.html")}).result.then(function(result){return handleModalResult(result)},function(){return handleModalResult({preferenceType:ATS_US_MARKET_PREFERENCE_TYPES.world})})}function handleModalResult(result){storePreference(result.preferenceType);return result.preferenceType}function storePreference(preferenceType){var roleName=ng.isObject(applet.getUser())?"user":"visitor";var endpointUrl=ATS_US_MARKET_API_URL_PREFIX+"/us-marketplace/"+roleName+"/preferences/save";return dataRequest("POST",endpointUrl,{data:{preferenceType:preferenceType}})}function dataRequest(method,url,config){if(ng.isUndefined(config)){config={}}var httpConfig=ng.extend({method:method,url:url,transformRequest:function(data){return $httpParamSerializerJQLike(data)}},config,{headers:ng.extend({"Content-Type":"application/x-www-form-urlencoded"},ng.isDefined(config.headers)?config.headers:{})});return $http(httpConfig)}}})(angular,Applet);